<?php


require_once dirname( __FILE__ ) . '/includes/lib/mo-options-enum.php';
add_action("\141\144\x6d\151\x6e\x5f\151\x6e\x69\164", "\155\x69\156\x69\157\x72\x61\156\x67\145\137\x69\155\x70\157\162\164\137\x65\170\160\157\x72\x74");
define("\x54\141\142\x5f\x43\x6c\141\163\163\137\116\141\155\145\163", serialize(array("\x53\x53\117\137\x4c\x6f\147\x69\x6e" => "\x6d\157\x5f\157\160\164\x69\x6f\156\x73\x5f\x65\156\x75\155\x5f\163\x73\157\x5f\x6c\157\x67\151\156", "\111\144\x65\156\164\x69\164\171\x5f\120\x72\x6f\166\x69\144\x65\x72" => "\155\x6f\137\157\160\164\151\x6f\156\163\x5f\x65\156\165\x6d\137\151\x64\x65\156\x74\151\x74\x79\137\x70\162\157\166\151\144\x65\162", "\123\x65\x72\166\x69\143\145\x5f\120\x72\157\166\x69\x64\x65\162" => "\x6d\157\137\x6f\160\x74\x69\157\x6e\x73\x5f\x65\x6e\x75\x6d\x5f\163\145\x72\x76\151\x63\145\x5f\x70\x72\157\166\151\144\145\162", "\x41\164\164\x72\x69\x62\x75\164\x65\x5f\115\x61\x70\160\x69\x6e\147" => "\x6d\157\137\157\160\x74\151\157\156\x73\x5f\x65\156\165\155\137\141\x74\164\x72\151\142\x75\164\145\137\x6d\x61\160\160\x69\156\147", "\x44\x6f\155\141\151\156\x5f\x52\x65\163\x74\162\x69\x63\164\151\x6f\156" => "\155\157\x5f\157\x70\164\151\157\156\163\x5f\x65\156\165\155\137\144\x6f\x6d\141\151\x6e\x5f\162\145\x73\x74\162\x69\143\164\151\157\x6e", "\122\157\x6c\145\x5f\115\141\x70\x70\151\156\x67" => "\x6d\x6f\137\x6f\160\x74\x69\157\x6e\x73\x5f\145\156\x75\155\x5f\162\x6f\x6c\145\x5f\155\141\160\160\x69\156\x67", "\124\145\x73\164\x5f\103\x6f\x6e\146\151\147\165\162\x61\164\151\x6f\156" => "\x6d\x6f\x5f\x6f\x70\x74\151\x6f\156\163\137\x65\156\165\x6d\x5f\x74\145\x73\164\x5f\143\157\x6e\146\151\147\x75\162\141\x74\151\x6f\156", "\103\165\x73\164\x6f\x6d\137\103\145\162\164\x69\x66\151\143\x61\x74\x65" => "\x6d\x6f\137\157\160\164\151\157\x6e\x73\x5f\145\x6e\165\x6d\137\x63\165\163\164\157\x6d\x5f\x63\145\162\x74\151\x66\x69\x63\x61\x74\145", "\103\165\x73\164\x6f\155\x5f\115\145\163\163\x61\x67\x65" => "\155\x6f\x5f\x6f\160\164\x69\157\156\163\x5f\x65\x6e\165\x6d\137\143\165\163\x74\157\x6d\x5f\155\x65\163\x73\x61\x67\x65\x73", "\105\x6e\166\151\162\x6f\x6e\x6d\145\156\164\x73" => "\x6d\157\137\x6f\x70\164\151\157\156\x73\137\145\x6e\x76\x69\162\157\x6e\155\145\x6e\164\163")));
function miniorange_keep_configuration_saml()
{
    $K4 = get_option("\163\141\155\154\x5f\x73\141\166\145\x5f\x63\x6f\x6e\x66\151\147\137\164\x6f\x5f\146\151\154\x65") ? get_option("\163\x61\155\154\137\163\x61\166\145\137\143\157\156\x66\151\x67\x5f\164\157\137\146\x69\154\145") : "\165\x6e\143\x68\x65\143\153\145\x64";
    $mI = get_option("\163\x61\155\x6c\137\143\157\x6e\x66\x69\x67\137\146\x6f\154\144\x65\x72\x5f\x6e\141\155\x65") ? get_option("\x73\x61\x6d\154\137\143\157\x6e\x66\151\147\137\x66\157\154\144\145\x72\x5f\x6e\x61\x6d\x65") : $_SERVER["\104\x4f\x43\x55\x4d\105\116\124\137\122\x4f\x4f\124"];
    echo "\74\x64\151\166\x20\143\x6c\141\x73\x73\75\42\x6d\x6f\x5f\x73\x61\155\154\x5f\x73\x75\160\x70\x6f\162\164\x5f\154\141\x79\157\165\164\x22\x20\151\144\75\42\x6d\157\137\x73\141\155\x6c\137\x6b\x65\x65\160\x5f\143\157\156\146\x69\x67\x75\x72\141\164\x69\x6f\156\x5f\151\x6e\164\x61\143\164\x22\76\xd\xa\x20\x20\x20\40\40\40\x20\40\x3c\x64\x69\166\x20\163\x74\171\154\x65\x3d\42\x70\141\x64\x64\x69\156\x67\55\162\151\x67\x68\164\x3a\61\60\x70\170\73\160\141\144\x64\x69\x6e\147\55\142\x6f\x74\x74\x6f\155\72\x32\64\x70\170\42\x3e\15\xa\x20\40\40\40\x20\x20\40\x20\x3c\x68\x33\x3e\120\x6c\x75\x67\x69\x6e\x20\x43\157\156\x66\151\x67\x75\162\141\x74\x69\x6f\156\x73\74\x2f\x68\63\76\x3c\150\x72\x3e\x3c\142\x72\x2f\x3e\xd\xa\x9\11\74\x66\157\x72\x6d\40\156\141\155\x65\75\x22\146\x22\40\x6d\x65\164\150\157\144\75\x22\x70\x6f\x73\x74\x22\x20\x61\x63\x74\151\157\156\75\42\42\40\x69\x64\75\x22\163\145\164\164\x69\156\x67\x73\x5f\x69\156\164\141\x63\164\42\x3e";
    wp_nonce_field("\155\x6f\x5f\x73\x61\155\154\137\153\x65\x65\x70\137\x73\x65\164\164\x69\x6e\147\163\137\x6f\156\137\x64\145\x6c\145\x74\151\157\156");
    echo "\x3c\151\156\x70\x75\x74\x20\164\x79\160\x65\x3d\42\150\x69\144\144\145\156\42\40\x6e\141\x6d\145\x3d\42\x6f\x70\164\151\x6f\x6e\x22\40\x76\x61\x6c\165\145\75\42\155\157\137\163\x61\x6d\154\137\x6b\145\145\160\137\163\x65\x74\x74\x69\156\x67\x73\137\x6f\x6e\137\x64\x65\154\145\164\151\x6f\156\42\57\x3e\15\12\11\x9\74\154\x61\x62\145\154\x20\x63\154\x61\x73\163\x3d\x22\x73\167\x69\164\143\150\x22\76\xd\xa\11\x9\74\x69\156\160\165\x74\40\x74\x79\x70\145\x3d\x22\143\150\x65\x63\x6b\x62\157\170\x22\40\x6e\x61\x6d\x65\75\42\155\x6f\137\163\x61\155\154\x5f\x6b\x65\145\160\137\163\x65\164\x74\151\156\147\x73\137\x69\156\164\141\143\164\x22\40";
    checked(get_option("\155\x6f\137\x73\141\x6d\x6c\137\x6b\145\145\160\137\x73\x65\164\164\151\x6e\147\163\x5f\157\156\x5f\144\x65\x6c\x65\x74\151\x6f\x6e") == "\x74\162\165\145");
    echo "\x6f\x6e\x63\150\x61\156\147\145\x3d\42\x64\x6f\x63\165\x6d\145\156\x74\56\x67\x65\164\x45\154\145\x6d\x65\x6e\164\102\171\x49\144\50\x27\163\145\x74\164\x69\156\147\x73\137\151\x6e\x74\x61\x63\x74\47\x29\56\x73\x75\x62\155\x69\x74\50\x29\73\x22\x2f\76\xd\xa\x9\11\x3c\163\x70\141\156\40\x63\x6c\x61\x73\163\x3d\x22\163\x6c\x69\144\145\x72\x20\162\157\165\x6e\x64\x22\x3e\x3c\57\x73\x70\141\x6e\76\xd\12\x9\x9\74\x2f\154\x61\x62\x65\x6c\x3e\15\12\x9\11\x3c\x73\160\x61\156\40\163\164\x79\x6c\145\x3d\42\x70\141\x64\144\x69\156\x67\x2d\x6c\145\x66\x74\72\x35\160\x78\x3b\146\157\x6e\164\x2d\x73\151\172\145\x3a\61\66\160\170\42\x3e\x3c\x62\x3e\113\145\145\x70\40\x53\x65\x74\x74\151\x6e\147\x73\40\111\156\164\141\x63\164\74\57\142\x3e\74\x2f\x73\160\x61\x6e\x3e\74\142\x72\x2f\76\74\x62\x72\57\x3e\15\12\11\x9\x45\x6e\x61\142\154\x69\156\x67\x20\x74\x68\151\x73\40\167\x6f\165\154\144\x20\153\x65\145\x70\x20\x79\157\x75\x72\x20\x63\x6f\x6e\146\x69\x67\165\162\x61\x74\x69\157\x6e\x73\40\x69\x6e\164\x61\143\x74\40\145\166\x65\156\40\x77\150\145\x6e\40\x74\150\x65\x20\x70\x6c\x75\147\151\156\40\x69\x73\x20\165\x6e\x69\156\163\164\x61\x6c\x6c\x65\x64\x2e\15\xa\x20\x20\x20\40\40\x20\x20\x20\x3c\x2f\146\157\x72\x6d\76\15\12\x20\x20\x20\x20\40\x20\x20\x20\15\xa\x20\40\40\x20\x20\x20\x20\x20\74\142\162\40\57\x3e\x3c\x62\x72\x20\57\x3e\15\12\11";
    echo "\xd\12\x9\x3c\146\x6f\x72\x6d\40\155\145\164\150\x6f\144\75\x22\160\x6f\x73\164\42\x20\x69\144\75\x22\x69\x6d\160\x6f\x72\164\x5f\x63\x6f\156\x66\151\147\x22\x20\141\143\164\151\x6f\156\x3d\x22" . admin_url() . "\141\144\x6d\x69\156\56\160\150\160\77\x70\x61\x67\x65\x3d\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x73\145\164\164\x69\x6e\x67\x73\x26\164\x61\x62\x3d\x73\x61\x76\145" . "\x22\40\x65\x6e\x63\164\x79\160\x65\75\x22\x6d\165\x6c\x74\151\160\141\162\164\x2f\x66\x6f\162\155\55\x64\141\164\x61\x22\x3e";
    wp_nonce_field("\155\x6f\137\x73\x61\x6d\x6c\137\x69\155\160\x6f\162\164");
    echo "\x3c\151\x6e\160\x75\x74\40\x74\171\160\x65\x3d\42\x68\151\x64\x64\145\x6e\x22\x20\x6e\x61\x6d\145\75\x22\157\160\x74\x69\157\156\x22\40\166\141\154\165\145\x3d\x22\155\x6f\137\x73\x61\x6d\x6c\137\151\x6d\160\x6f\162\164\x22\x20\x2f\x3e\15\12\x9\x3c\164\x61\x62\154\145\x3e\xd\xa\x9\x3c\x74\162\76\x3c\164\x64\x3e\x3c\x73\160\141\156\40\163\164\171\154\145\x3d\42\146\157\156\164\x2d\x73\x69\172\145\x3a\x31\x36\x70\170\42\76\x3c\142\x3e\x49\x6d\x70\157\x72\x74\x20\x43\157\x6e\146\x69\x67\x75\x72\x61\164\x69\x6f\156\x73\x3c\57\142\x3e\x3c\57\x73\160\141\156\76\74\x2f\164\x64\76\x3c\57\164\162\76\15\12\x9\x3c\x74\x72\x3e\74\x74\144\x3e\74\142\x72\x2f\76\74\x2f\x74\144\76\74\57\x74\x72\x3e\15\xa\x9\x3c\164\x72\76\74\x74\144\76\74\151\156\x70\x75\164\x20\x74\x79\160\145\x3d\x22\x66\151\154\145\42\40\x6e\x61\x6d\x65\x3d\42\x63\x6f\156\x66\x69\x67\x75\162\141\x74\151\157\156\x5f\146\151\154\145\x22\40\151\x64\x3d\42\x63\x6f\x6e\x66\x69\147\165\x72\x61\164\151\157\x6e\x5f\x66\151\x6c\145\x22\x3e\x3c\x2f\164\144\x3e\15\xa\x9\x3c\x74\x64\76\x3c\x69\x6e\160\x75\164\x20\x74\x79\160\x65\75\42\x73\x75\142\x6d\151\x74\42\x20\156\141\155\145\x3d\42\x73\165\x62\x6d\151\164\x22\40\163\x74\171\154\x65\75\x22\x77\151\x64\x74\x68\72\x20\x61\x75\164\157\x22\x20\x63\154\141\163\163\x3d\42\142\165\164\164\x6f\156\x20\142\165\164\x74\x6f\156\x2d\160\x72\151\x6d\141\x72\171\x20\142\165\x74\x74\x6f\x6e\55\154\141\162\147\x65\42\x20\166\141\154\165\145\75\x22\x49\x6d\160\157\162\x74\x22\57\76\x3c\57\x74\x64\x3e\x3c\x2f\x74\162\76\15\xa\x9\15\xa\x9\x3c\57\164\x61\142\154\145\76\xd\12\11\x3c\142\x72\x3e\x3c\x62\162\x3e\15\xa\11\x3c\57\146\x6f\x72\x6d\x3e\15\xa\11\15\12\15\xa\xd\12\11\x3c\57\x64\151\x76\x3e\xd\xa\74\57\144\151\166\x3e\15\12";
}
function miniorange_import_export($xN = false, $A7 = false)
{
    if (!$xN) {
        goto JO;
    }
    $_POST["\x6f\x70\x74\151\x6f\x6e"] = "\x6d\157\x5f\163\x61\x6d\154\137\x65\170\160\x6f\x72\x74";
    JO:
    if (empty($_POST["\x6f\x70\164\151\157\x6e"])) {
        goto fH;
    }
    if ($_POST["\157\160\x74\151\157\156"] == "\155\x6f\137\163\141\155\x6c\x5f\x65\170\160\x6f\x72\x74") {
        goto Xa;
    }
    if ($_POST["\157\160\x74\151\x6f\x6e"] == "\x6d\157\x5f\163\x61\x6d\x6c\137\x69\155\160\157\x72\164" && check_admin_referer("\155\157\x5f\x73\141\x6d\x6c\137\x69\155\160\157\x72\164")) {
        goto XV;
    }
    if (!($_POST["\157\x70\164\151\x6f\x6e"] == "\155\157\x5f\163\141\155\154\x5f\153\x65\x65\160\x5f\x73\145\x74\x74\151\156\147\x73\137\x6f\156\x5f\x64\145\154\x65\x74\151\x6f\156" && check_admin_referer("\x6d\157\137\x73\141\x6d\x6c\137\153\x65\x65\160\x5f\x73\145\x74\164\x69\x6e\147\x73\x5f\157\x6e\x5f\x64\145\x6c\145\164\151\x6f\x6e"))) {
        goto f6;
    }
    if (isset($_POST["\155\157\x5f\x73\x61\155\x6c\x5f\153\145\145\x70\x5f\163\x65\x74\x74\x69\156\147\163\x5f\151\156\x74\x61\143\164"])) {
        goto rk;
    }
    update_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\x6b\145\145\x70\137\163\x65\164\x74\x69\156\x67\x73\137\157\x6e\x5f\x64\145\154\x65\164\x69\157\x6e", '');
    goto ER;
    rk:
    update_option("\155\x6f\137\x73\x61\155\x6c\137\153\145\145\x70\137\x73\x65\x74\x74\151\x6e\147\x73\x5f\x6f\156\x5f\144\x65\x6c\145\164\x69\x6f\x6e", "\164\x72\x75\145");
    ER:
    f6:
    goto ZH;
    XV:
    if (!function_exists("\167\x70\x5f\150\x61\x6e\x64\x6c\145\x5f\x75\160\154\x6f\x61\x64")) {
        require_once ABSPATH . "\x77\x70\x2d\x61\144\x6d\151\x6e\x2f\x69\x6e\x63\154\165\144\x65\x73\57\x66\x69\x6c\x65\x2e\160\x68\160";
    }
    $G7 = $_FILES["\143\157\x6e\146\x69\147\165\162\x61\x74\151\157\x6e\137\146\151\x6c\145"]["\164\171\x70\x65"];
    $o5 = substr($G7, strpos($G7, "\57") + 1);
    if (!($o5 != "\x6a\163\x6f\156")) {
        goto z9;
    }
    update_option("\155\x6f\x5f\x73\x61\155\x6c\137\155\145\x73\x73\141\147\x65", "\x50\154\x65\141\163\x65\x20\165\x70\x6c\x6f\x61\x64\40\x61\40\x76\x61\154\151\144\40\143\x6f\x6e\x66\151\x67\x75\x72\x61\x74\x69\157\156\40\x66\151\x6c\x65\x20\x69\156\x20\56\152\x73\157\x6e\40\146\x6f\x72\155\141\x74");
    SAMLSPUtilities::mo_saml_show_error_message();
    return;
    z9:
    if (empty($_FILES["\143\157\x6e\146\151\147\x75\162\141\x74\x69\x6f\x6e\x5f\x66\x69\154\x65"]["\x74\x6d\x70\137\x6e\141\155\x65"])) {
        goto f_;
    }
    $ZD = @file_get_contents($_FILES["\x63\157\156\146\x69\x67\165\x72\141\164\x69\157\156\137\x66\151\154\145"]["\164\155\x70\137\x6e\141\155\145"]);
    $bz = json_decode($ZD, true);
    mo_update_configuration_array($bz);
    f_:
    ZH:
    goto o5;
    Xa:
    if ($xN && $A7) {
        goto vU;
    }
    $Mi = check_admin_referer("\155\x6f\x5f\163\141\x6d\x6c\x5f\x65\x78\160\x6f\162\x74");
    goto Wh;
    vU:
    $Mi = check_admin_referer("\155\157\x5f\x73\141\155\x6c\x5f\143\157\156\164\141\143\164\x5f\x75\x73\137\x71\165\145\x72\x79\x5f\x6f\160\x74\x69\x6f\156");
    Wh:
    if (!$Mi) {
        goto uB;
    }
    $Za = maybe_unserialize(Tab_Class_Names);
    $bz = array();
    foreach ($Za as $WO => $cK) {
        $bz[$WO] = mo_get_configuration_array($cK);
        km:
    }
    Mq:
    $bz["\x56\145\162\x73\x69\x6f\x6e\137\x64\145\160\x65\x6e\144\145\156\x63\151\145\x73"] = mo_get_version_informations();
    $T7 = phpversion();
    if (substr($T7, 0, 3) === "\65\x2e\63") {
        goto zu;
    }
    $jA = json_encode($bz, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES);
    goto P7;
    zu:
    $jA = json_encode($bz, JSON_PRETTY_PRINT);
    P7:
    if (!$A7) {
        goto IQ;
    }
    return $jA;
    IQ:
    header("\x43\157\156\x74\x65\x6e\164\x2d\x44\151\x73\x70\x6f\163\x69\164\151\157\x6e\72\x20\141\164\x74\x61\x63\x68\155\145\x6e\164\x3b\x20\x66\151\x6c\x65\156\141\155\145\75\155\151\156\x69\x6f\x72\x61\156\147\145\55\163\141\155\x6c\55\143\157\156\x66\x69\x67\x2e\x6a\x73\157\156");
    echo $jA;
    exit;
    uB:
    o5:
    fH:
}
function mo_get_configuration_array($PC, $bW = false)
{
    $cY = call_user_func($PC . "\x3a\x3a\x67\x65\x74\x43\x6f\x6e\163\164\141\x6e\164\163");
    if (!$bW) {
        goto t5;
    }
    return $cY;
    t5:
    $nY = array();
    foreach ($cY as $WO => $cK) {
        $J_ = get_option($cK);
        $J_ = maybe_unserialize($J_);
        if (!($WO == "\105\156\166\x69\162\157\156\x6d\145\156\164\x5f\x4f\142\152\145\143\x74\163" && is_array($J_))) {
            goto Ur;
        }
        foreach ($J_ as $Dl => $ng) {
            $J_[$Dl] = $ng->convertEnvironmentObjectToArray();
            M1:
        }
        Gn:
        Ur:
        $nY[$WO] = $J_;
        oy:
    }
    ju:
    return $nY;
}
function mo_update_configuration_array($bz)
{
    $Za = maybe_unserialize(Tab_Class_Names);
    foreach ($Za as $J6 => $PC) {
        if (!empty($bz[$J6])) {
            goto Xf;
        }
        goto Mn;
        Xf:
        if (!($J6 == "\x45\x6e\166\151\x72\x6f\156\x6d\145\x6e\164\163")) {
            goto Rx;
        }
        goto Mn;
        Rx:
        foreach ($bz[$J6] as $WO => $cK) {
            $uq = constant("{$PC}\72\x3a{$WO}");
            if (!is_array($cK)) {
                goto yh;
            }
            $cK = serialize($cK);
            yh:
            if (!($WO == "\x49\x64\145\x6e\164\151\164\x79\137\156\141\155\x65" || $WO == "\x4c\157\x67\151\156\137\125\x52\114" || $WO == "\x49\x73\x73\x75\x65\x72")) {
                goto RY;
            }
            if (!empty($cK)) {
                goto Vv;
            }
            update_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\155\x65\x73\163\x61\x67\x65", "\120\x6c\x65\x61\163\145\40\x69\155\x70\x6f\x72\164\40\x61\40\166\x61\x6c\x69\144\x20\146\151\154\x65\x2e\40\x52\145\161\165\151\x72\x65\x64\x20\146\151\145\x6c\x64\x73\40\141\x72\145\40\145\155\x70\x74\171\x2e");
            SAMLSPUtilities::mo_saml_show_error_message();
            return;
            Vv:
            RY:
            update_option($uq, $cK);
            Ia:
        }
        lv:
        Mn:
    }
    Ot:
    update_option("\155\x6f\x5f\x73\x61\155\154\137\155\145\x73\x73\x61\147\x65", "\111\x6d\160\x6f\x72\164\40\123\x75\x63\143\145\163\x73\x66\165\x6c\41");
    SAMLSPUtilities::mo_saml_show_success_message();
}
function mo_get_version_informations()
{
    $FX = array();
    $FX["\120\x6c\x75\147\x69\x6e\137\x76\145\162\163\x69\x6f\156"] = mo_options_plugin_constants::Version;
    $FX["\x50\110\x50\x5f\x76\x65\162\163\x69\157\156"] = phpversion();
    $FX["\x57\157\162\144\160\162\x65\163\163\137\166\145\162\163\151\x6f\x6e"] = get_bloginfo("\x76\x65\x72\x73\x69\x6f\156");
    $FX["\117\x50\105\116\137\123\123\114"] = mo_saml_is_extension_installed("\x6f\x70\145\156\x73\x73\154");
    $FX["\103\125\x52\114"] = mo_saml_is_extension_installed("\143\x75\162\x6c");
    $FX["\x49\103\x4f\x4e\x56"] = mo_saml_is_extension_installed("\x69\x63\157\156\166");
    $FX["\x44\117\115"] = mo_saml_is_extension_installed("\x64\157\x6d");
    return $FX;
}
