<?php
/*
Plugin Name: miniOrange SSO using SAML 2.0
Plugin URI: http://miniorange.com/
Description: (Premium Single-Site)miniOrange SAML 2.0 SSO enables user to perform Single Sign On with any SAML 2.0 enabled Identity Provider.
Version: 11.4.2
Author: miniOrange
Author URI: http://miniorange.com/
*/


include_once dirname(__FILE__) . "\57\155\157\137\x6c\x6f\147\x69\x6e\x5f\x73\141\155\x6c\x5f\163\163\x6f\x5f\x77\151\x64\x67\145\x74\x2e\160\x68\x70";
include_once "\170\x6d\154\163\x65\143\154\x69\x62\x73\x2e\160\x68\x70";
use RobRichards\XMLSecLibs\XMLSecurityKey;
use RobRichards\XMLSecLibs\XMLSecurityDSig;
use RobRichards\XMLSecLibs\XMLSecEnc;
require "\155\x6f\55\163\141\155\154\55\143\x6c\141\163\x73\55\143\165\x73\x74\x6f\155\145\x72\56\160\x68\x70";
require "\x6d\157\137\x73\x61\155\x6c\137\163\145\x74\x74\x69\x6e\147\163\x5f\x70\x61\x67\x65\x2e\160\x68\160";
require "\x4d\145\164\141\144\x61\x74\141\x52\x65\141\144\x65\x72\x2e\160\x68\x70";
require "\x63\145\x72\164\x69\x66\151\x63\x61\x74\145\x5f\x75\164\x69\x6c\x69\x74\x79\x2e\x70\x68\x70";
class saml_mo_login
{
    function __construct()
    {
        add_action("\x61\144\x6d\x69\156\x5f\x6d\x65\x6e\x75", array($this, "\155\x69\x6e\x69\157\x72\141\x6e\147\x65\137\x73\163\157\x5f\155\145\x6e\x75"));
        add_action("\x61\x64\155\x69\156\137\151\x6e\151\164", array($this, "\x6d\x69\x6e\x69\157\x72\x61\x6e\x67\x65\x5f\x6c\x6f\x67\x69\x6e\137\167\x69\144\x67\145\x74\x5f\163\141\155\154\137\163\x61\x76\x65\x5f\x73\x65\x74\164\151\156\x67\163"));
        add_action("\x61\144\155\151\156\137\145\x6e\x71\x75\x65\165\145\x5f\x73\143\162\x69\160\164\x73", array($this, "\160\x6c\x75\147\x69\x6e\137\x73\145\x74\164\151\156\x67\163\x5f\163\164\171\x6c\145"));
        register_deactivation_hook(__FILE__, array($this, "\155\x6f\x5f\x73\x73\x6f\137\163\x61\155\154\137\x64\x65\x61\143\x74\151\x76\141\x74\x65"));
        add_action("\141\x64\155\x69\156\x5f\145\x6e\161\165\x65\x75\x65\x5f\x73\x63\162\151\x70\x74\163", array($this, "\160\x6c\165\x67\151\156\137\163\x65\x74\164\x69\156\x67\x73\137\x73\143\162\x69\160\x74"));
        remove_action("\141\144\x6d\x69\x6e\x5f\x6e\157\164\x69\143\145\x73", array($this, "\x6d\157\137\163\x61\x6d\154\137\x73\x75\x63\x63\145\163\163\137\x6d\x65\x73\163\141\147\x65"));
        remove_action("\x61\144\x6d\x69\156\137\x6e\157\x74\151\143\x65\163", array($this, "\x6d\157\x5f\x73\141\155\x6c\137\145\x72\162\x6f\162\x5f\155\x65\x73\x73\x61\147\x65"));
        add_action("\167\160\137\x61\165\x74\x68\145\x6e\x74\x69\x63\141\x74\145", array($this, "\x6d\x6f\137\163\x61\x6d\x6c\137\141\x75\164\150\x65\x6e\164\x69\x63\141\164\145"));
        add_action("\167\160", array($this, "\155\157\137\163\x61\155\x6c\x5f\x61\x75\164\x6f\x5f\x72\145\144\x69\162\145\143\164"));
        $BI = new mo_login_wid();
        add_action("\x77\160\137\x6c\x6f\147\157\x75\x74", array($BI, "\x6d\157\137\163\141\x6d\x6c\x5f\154\157\x67\157\x75\x74"));
        add_action("\x61\144\155\x69\x6e\x5f\151\156\x69\x74", "\155\157\137\163\141\155\x6c\137\144\x6f\167\x6e\x6c\x6f\x61\x64");
        add_action("\x6c\x6f\147\x69\156\x5f\x65\156\161\x75\x65\x75\x65\x5f\x73\143\162\151\160\164\163", array($this, "\x6d\x6f\x5f\x73\141\x6d\x6c\137\154\157\x67\151\156\x5f\x65\156\x71\x75\x65\165\x65\x5f\163\143\x72\151\160\164\163"));
        add_action("\154\157\x67\x69\x6e\137\146\157\x72\155", array($this, "\155\x6f\137\x73\141\x6d\154\x5f\155\x6f\144\x69\146\171\137\154\157\x67\x69\x6e\x5f\146\157\x72\155"));
        add_shortcode("\x4d\117\137\x53\101\115\x4c\x5f\x46\117\122\x4d", array($this, "\x6d\x6f\137\147\145\x74\137\163\141\x6d\154\137\163\150\x6f\x72\x74\x63\157\x64\x65"));
        add_filter("\143\x72\x6f\x6e\x5f\x73\x63\x68\145\x64\x75\x6c\x65\x73", array($this, "\155\x79\160\x72\x65\146\151\170\137\141\x64\x64\x5f\143\x72\x6f\x6e\x5f\x73\x63\150\145\144\x75\154\145"));
        add_action("\155\145\164\x61\144\141\x74\141\x5f\163\171\156\x63\x5f\143\162\157\x6e\x5f\141\143\164\x69\x6f\x6e", array($this, "\x6d\145\164\x61\144\x61\x74\x61\137\163\171\x6e\143\137\143\162\157\x6e\137\x61\143\x74\151\x6f\x6e"));
        register_activation_hook(__FILE__, array($this, "\155\157\x5f\x73\x61\x6d\x6c\x5f\143\150\x65\143\153\137\x6f\x70\x65\x6e\x73\163\154"));
        add_action("\160\154\165\x67\151\x6e\x5f\141\143\164\151\x6f\x6e\x5f\x6c\151\156\x6b\x73\x5f" . plugin_basename(__FILE__), array($this, "\x6d\157\137\163\x61\x6d\154\x5f\x70\x6c\165\147\151\x6e\137\141\x63\164\151\x6f\x6e\x5f\x6c\x69\x6e\153\x73"));
        add_action("\141\144\155\x69\156\137\151\x6e\x69\x74", array($this, "\x64\145\146\x61\165\154\x74\x5f\x63\145\162\x74\x69\146\x69\143\x61\164\145"));
        add_option("\154\143\144\x6a\x6b\141\x73\x6a\x64\153\x73\141\x63\154", "\x64\x65\x66\x61\x75\154\164\x2d\x63\145\162\164\151\x66\x69\143\141\164\x65");
        add_filter("\x6d\141\156\141\x67\145\137\165\x73\145\x72\x73\x5f\143\x6f\154\165\x6d\x6e\x73", array($this, "\155\x6f\137\x73\x61\x6d\x6c\137\x63\x75\x73\164\x6f\155\137\x61\x74\164\x72\137\x63\x6f\x6c\x75\x6d\156"));
        add_action("\x6d\141\156\141\x67\145\137\x75\x73\x65\162\163\x5f\x63\x75\x73\x74\x6f\x6d\x5f\x63\157\154\165\x6d\x6e", array($this, "\x6d\157\137\x73\141\x6d\x6c\137\x61\x74\x74\162\x5f\x63\x6f\x6c\165\155\x6e\137\x63\x6f\156\x74\145\156\x74"), 10, 3);
    }
    function default_certificate()
    {
        $dJ = file_get_contents(plugin_dir_path(__FILE__) . "\162\x65\x73\157\x75\x72\143\145\163" . DIRECTORY_SEPARATOR . "\163\160\55\x63\145\162\x74\151\x66\151\x63\x61\164\145\56\x63\162\x74");
        $Oz = file_get_contents(plugin_dir_path(__FILE__) . "\x72\x65\x73\x6f\165\162\x63\x65\x73" . DIRECTORY_SEPARATOR . "\x73\160\x2d\153\145\x79\x2e\x6b\x65\x79");
        add_option("\x6d\x6f\137\163\x61\155\154\x5f\143\x65\162\164", $dJ);
        add_option("\155\x6f\x5f\x73\x61\155\x6c\x5f\143\x65\x72\164\137\x70\x72\151\x76\141\164\145\x5f\x6b\x65\x79", $Oz);
        if (!(!get_option("\x6d\157\137\x73\141\x6d\154\137\143\x75\x72\x72\145\156\164\137\143\145\162\164") && !get_option("\x6d\x6f\137\x73\x61\x6d\154\x5f\143\165\x72\x72\145\x6e\x74\137\x63\x65\x72\x74\137\x70\162\x69\166\141\164\145\137\153\145\171"))) {
            goto QJ;
        }
        update_option("\x6d\x6f\x5f\163\x61\155\154\137\x63\x75\x72\162\x65\156\x74\x5f\x63\x65\x72\x74", $dJ);
        update_option("\x6d\157\x5f\163\x61\155\154\137\143\x75\x72\162\x65\156\x74\x5f\x63\x65\x72\164\137\x70\162\151\x76\141\164\x65\x5f\x6b\x65\171", $Oz);
        QJ:
    }
    function mo_saml_check_openssl()
    {
        if (mo_saml_is_extension_installed("\x6f\x70\x65\x6e\163\163\154")) {
            goto Xy;
        }
        wp_die("\x50\x48\x50\40\x6f\160\x65\156\x73\163\x6c\40\x65\x78\164\145\x6e\163\x69\157\156\40\x69\x73\x20\x6e\x6f\x74\x20\151\x6e\163\x74\x61\154\154\x65\144\x20\157\162\x20\144\151\163\x61\x62\x6c\145\144\x2c\160\x6c\145\x61\x73\145\40\x65\156\x61\x62\154\145\40\x69\x74\x20\x74\x6f\x20\x61\x63\x74\151\x76\x61\164\x65\40\164\x68\145\40\160\154\x75\147\x69\x6e\x2e");
        Xy:
        add_option("\x41\x63\x74\151\x76\141\164\145\x64\x5f\120\154\165\x67\x69\156", "\x50\154\165\x67\x69\156\55\x53\154\x75\147");
    }
    function myprefix_add_cron_schedule($iT)
    {
        $iT["\167\145\145\153\x6c\171"] = array("\x69\156\164\145\x72\166\x61\x6c" => 604800, "\x64\x69\163\160\x6c\x61\x79" => __("\117\156\143\x65\40\127\x65\145\x6b\x6c\171"));
        $iT["\x6d\157\156\x74\150\154\x79"] = array("\x69\156\164\x65\x72\x76\x61\x6c" => 2635200, "\x64\x69\x73\160\x6c\141\x79" => __("\x4f\156\x63\145\x20\x4d\x6f\156\164\x68\154\x79"));
        return $iT;
    }
    function metadata_sync_cron_action()
    {
        error_log("\155\x69\x6e\x69\157\x72\141\156\147\x65\x20\72\40\x52\x41\116\x20\x53\131\x4e\103\x20\55\x20" . time());
        $qi = get_option("\x73\141\x6d\x6c\137\151\x64\x65\x6e\x74\x69\x74\171\x5f\156\141\x6d\145");
        $this->upload_metadata(@file_get_contents(get_option("\163\141\x6d\154\137\x6d\x65\164\141\144\141\x74\141\x5f\x75\x72\x6c\137\146\157\x72\137\x73\171\x6e\143")));
        update_option("\x73\x61\155\x6c\137\151\x64\145\x6e\164\151\164\171\x5f\156\141\x6d\145", $qi);
    }
    function mo_login_widget_saml_options()
    {
        global $wpdb;
        update_option("\x6d\157\137\x73\141\x6d\x6c\137\x68\x6f\x73\164\x5f\x6e\141\155\145", "\x68\x74\x74\160\x73\72\57\x2f\154\x6f\x67\151\156\56\170\x65\143\165\162\151\x66\x79\56\143\x6f\155");
        $u9 = get_option("\155\x6f\x5f\163\141\155\x6c\x5f\x68\x6f\x73\164\x5f\156\x61\155\145");
        mo_register_saml_sso();
    }
    function mo_saml_success_message()
    {
        $AS = "\x65\x72\162\157\x72";
        $Nr = get_option("\155\157\x5f\163\x61\155\154\x5f\155\x65\163\163\x61\147\145");
        echo "\x3c\x64\x69\x76\40\x63\154\141\163\x73\x3d\47" . $AS . "\x27\x3e\x20\x3c\x70\x3e" . $Nr . "\x3c\57\160\x3e\x3c\57\144\x69\x76\x3e";
    }
    function mo_saml_error_message()
    {
        $AS = "\165\160\x64\x61\x74\145\144";
        $Nr = get_option("\155\157\x5f\163\x61\155\x6c\137\x6d\x65\163\x73\141\147\145");
        echo "\x3c\x64\151\x76\x20\143\154\x61\163\x73\x3d\47" . $AS . "\x27\76\x20\x3c\160\x3e" . $Nr . "\x3c\57\x70\x3e\x3c\x2f\x64\x69\166\x3e";
    }
    public function mo_sso_saml_deactivate()
    {
        if (!is_multisite()) {
            goto Cg;
        }
        global $wpdb;
        $xg = $wpdb->get_col("\x53\105\114\105\103\x54\40\142\154\x6f\x67\x5f\x69\144\x20\106\x52\x4f\x4d\40{$wpdb->blogs}");
        $t1 = get_current_blog_id();
        do_action("\155\x6f\x5f\163\141\x6d\154\x5f\x66\154\x75\x73\x68\137\143\141\143\150\145");
        foreach ($xg as $blog_id) {
            switch_to_blog($blog_id);
            delete_option("\155\157\x5f\x73\x61\155\154\137\150\157\x73\x74\x5f\156\x61\155\x65");
            delete_option("\x6d\157\x5f\x73\x61\x6d\154\137\156\145\x77\x5f\162\x65\147\151\163\164\x72\x61\x74\151\x6f\x6e");
            delete_option("\x6d\157\137\x73\x61\x6d\154\x5f\x61\144\x6d\x69\156\137\160\150\157\x6e\x65");
            delete_option("\155\157\x5f\163\x61\x6d\154\137\x61\x64\x6d\151\x6e\x5f\160\141\163\163\x77\x6f\162\144");
            delete_option("\155\x6f\x5f\163\x61\x6d\x6c\137\x76\x65\x72\x69\146\x79\137\x63\165\x73\x74\157\x6d\x65\162");
            delete_option("\x6d\x6f\x5f\x73\141\x6d\154\137\x61\144\155\x69\x6e\x5f\143\165\x73\164\x6f\x6d\145\162\x5f\x6b\145\171");
            delete_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\x61\144\x6d\x69\x6e\137\141\160\151\137\153\145\171");
            delete_option("\155\x6f\137\x73\x61\155\x6c\x5f\143\x75\x73\x74\157\155\x65\162\x5f\164\x6f\x6b\145\x6e");
            delete_option("\155\157\137\x73\x61\x6d\154\x5f\x6d\145\163\163\x61\147\145");
            delete_option("\x6d\x6f\137\163\141\155\x6c\x5f\x72\145\147\151\163\x74\162\x61\x74\x69\x6f\156\x5f\x73\x74\141\x74\x75\163");
            delete_option("\155\x6f\x5f\163\141\155\154\137\151\x64\x70\137\x63\x6f\x6e\146\151\147\137\143\157\155\x70\x6c\x65\164\145");
            delete_option("\155\157\137\x73\141\155\x6c\137\x74\x72\x61\156\x73\x61\x63\x74\x69\x6f\156\111\x64");
            delete_option("\166\x6c\x5f\143\x68\145\x63\153\x5f\x74");
            delete_option("\x76\x6c\x5f\x63\150\145\143\153\x5f\163");
            be:
        }
        ao:
        switch_to_blog($t1);
        goto mN;
        Cg:
        do_action("\155\x6f\137\163\141\155\154\x5f\x66\154\x75\x73\x68\137\x63\141\x63\150\145");
        delete_option("\155\157\x5f\x73\141\x6d\154\137\x68\x6f\x73\x74\137\156\141\x6d\145");
        delete_option("\155\x6f\137\163\x61\x6d\x6c\x5f\x6e\145\x77\137\x72\x65\147\x69\x73\x74\162\141\x74\151\x6f\156");
        delete_option("\x6d\x6f\137\163\141\155\x6c\137\141\x64\155\x69\x6e\137\160\x68\157\x6e\x65");
        delete_option("\155\157\137\x73\141\155\154\137\x61\x64\x6d\x69\156\137\160\x61\163\163\x77\x6f\162\x64");
        delete_option("\155\157\137\x73\141\x6d\154\137\166\x65\x72\151\x66\171\137\x63\165\x73\164\157\x6d\145\162");
        delete_option("\x6d\157\137\163\x61\155\154\x5f\141\144\x6d\151\156\x5f\143\x75\x73\x74\157\x6d\x65\x72\x5f\153\x65\171");
        delete_option("\x6d\157\137\x73\141\x6d\x6c\137\141\x64\155\151\x6e\x5f\141\160\x69\x5f\153\145\x79");
        delete_option("\155\157\x5f\163\x61\155\x6c\x5f\x63\165\x73\x74\x6f\x6d\x65\162\x5f\x74\x6f\153\145\x6e");
        delete_option("\x6d\x6f\x5f\163\x61\x6d\154\137\x6d\x65\163\163\x61\147\x65");
        delete_option("\155\157\x5f\x73\141\x6d\154\137\162\145\147\x69\163\x74\x72\141\x74\x69\x6f\x6e\137\x73\164\141\x74\165\163");
        delete_option("\155\157\x5f\163\141\155\x6c\x5f\151\x64\160\x5f\x63\x6f\x6e\146\151\147\137\x63\157\x6d\160\154\145\164\x65");
        delete_option("\x6d\157\x5f\x73\141\x6d\x6c\137\164\162\141\156\x73\141\x63\x74\151\x6f\x6e\x49\x64");
        delete_option("\155\x6f\137\x73\141\155\154\137\145\x6e\x61\142\x6c\145\137\x63\x6c\157\x75\x64\x5f\142\x72\157\153\x65\162");
        delete_option("\166\154\137\x63\x68\145\143\x6b\137\164");
        delete_option("\x76\154\x5f\x63\x68\x65\x63\153\137\x73");
        mN:
    }
    function mo_saml_show_success_message()
    {
        remove_action("\x61\144\155\x69\x6e\137\x6e\157\164\151\x63\145\163", array($this, "\x6d\157\x5f\163\x61\x6d\x6c\x5f\x73\165\x63\143\145\163\163\137\155\145\163\x73\141\147\145"));
        add_action("\141\x64\x6d\x69\x6e\x5f\x6e\157\164\151\143\145\x73", array($this, "\x6d\x6f\x5f\163\141\x6d\154\137\145\162\162\157\x72\137\155\145\163\x73\x61\147\145"));
    }
    function mo_saml_show_error_message()
    {
        remove_action("\x61\144\155\x69\x6e\137\156\x6f\164\x69\143\145\163", array($this, "\155\x6f\x5f\x73\141\155\x6c\x5f\x65\162\162\x6f\x72\137\155\x65\163\x73\x61\x67\x65"));
        add_action("\141\144\155\x69\156\137\156\x6f\x74\x69\x63\145\163", array($this, "\x6d\157\x5f\163\x61\x6d\x6c\x5f\163\x75\143\143\x65\163\x73\x5f\155\x65\x73\x73\x61\x67\x65"));
    }
    function plugin_settings_style($F5)
    {
        if (!("\x74\x6f\160\x6c\x65\166\x65\154\137\160\141\x67\145\x5f\x6d\157\x5f\x73\x61\x6d\154\x5f\163\x65\x74\x74\151\156\x67\163" != $F5)) {
            goto fm;
        }
        return;
        fm:
        wp_enqueue_style("\x6d\157\137\x73\x61\155\154\x5f\141\144\155\x69\156\137\163\x65\x74\x74\151\x6e\147\x73\137\163\164\x79\154\x65\137\164\x72\x61\x63\x6b\145\x72", plugins_url("\x69\x6e\143\154\x75\144\145\163\57\143\x73\x73\57\x70\x72\157\147\x72\145\x73\163\x2d\x74\162\141\143\x6b\x65\x72\56\143\163\163", __FILE__));
        wp_enqueue_style("\x6d\157\x5f\x73\x61\155\x6c\137\x61\x64\155\151\156\x5f\x73\145\x74\x74\x69\156\x67\163\x5f\x73\164\x79\154\x65", plugins_url("\x69\156\143\x6c\165\144\145\x73\x2f\x63\x73\x73\x2f\x73\x74\171\x6c\145\x5f\x73\x65\164\164\151\156\147\x73\x2e\x6d\x69\x6e\x2e\143\163\x73\77\x76\145\x72\x3d\61\61\56\64\x2e\x30", __FILE__));
        wp_enqueue_style("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\141\x64\x6d\x69\156\137\163\145\164\164\151\x6e\147\x73\x5f\x70\x68\157\x6e\145\x5f\163\164\x79\x6c\145", plugins_url("\151\x6e\143\x6c\165\144\x65\x73\57\x63\x73\x73\x2f\x70\150\x6f\156\145\56\x6d\x69\156\56\143\x73\163\x3f\x76\145\x72\75\61\61\x2e\x34\x2e\x30", __FILE__));
        wp_enqueue_style("\x6d\x6f\x5f\x73\141\x6d\154\137\167\x70\142\x2d\146\x61", plugins_url("\151\156\143\154\165\x64\145\163\x2f\x63\x73\x73\x2f\146\157\156\164\x2d\141\167\145\x73\157\155\x65\56\155\151\x6e\56\x63\163\x73\x3f\x76\145\x72\75\x31\61\56\64\56\x30", __FILE__));
    }
    function plugin_settings_script($F5)
    {
        if (!("\x74\157\x70\x6c\145\x76\145\154\137\x70\141\147\145\137\155\x6f\137\x73\141\155\154\137\x73\145\164\164\151\156\x67\163" != $F5)) {
            goto qM;
        }
        return;
        qM:
        wp_enqueue_script("\x6a\x71\x75\145\162\171");
        wp_enqueue_script("\x6d\x6f\137\x73\141\155\x6c\x5f\x61\144\x6d\151\156\137\x73\x65\x74\x74\x69\156\147\x73\x5f\143\157\x6c\x6f\162\x5f\163\143\162\x69\x70\164", plugins_url("\151\156\143\154\165\144\x65\x73\x2f\x6a\163\x2f\x6a\x73\143\x6f\154\x6f\x72\57\152\x73\143\157\154\x6f\x72\56\152\163", __FILE__));
        wp_enqueue_script("\x6d\x6f\x5f\x73\141\155\x6c\137\141\x64\x6d\x69\156\x5f\x62\157\157\164\x73\164\162\141\160\137\x73\x63\x72\151\160\164", plugins_url("\x69\x6e\x63\154\165\144\x65\163\57\152\x73\x2f\142\157\157\x74\163\x74\162\141\x70\x2e\152\x73\x3f\x76\x65\162\75\61\61\56\64\x2e\60", __FILE__));
        wp_enqueue_script("\x6d\x6f\x5f\x73\x61\x6d\154\137\x61\144\x6d\x69\x6e\137\163\145\164\164\x69\156\147\163\137\x73\143\x72\151\160\x74", plugins_url("\x69\156\x63\154\165\x64\145\163\x2f\x6a\x73\57\163\x65\x74\164\x69\x6e\147\163\56\x6d\x69\x6e\56\152\163\77\x76\x65\162\75\x31\x31\x2e\x34\56\x30", __FILE__));
        wp_enqueue_script("\155\157\x5f\163\141\155\154\137\141\x64\155\x69\156\137\163\x65\x74\164\x69\x6e\x67\x73\x5f\x70\150\157\156\x65\x5f\163\143\x72\x69\160\164", plugins_url("\151\x6e\143\154\x75\x64\145\163\57\152\x73\57\x70\150\157\156\x65\x2e\155\151\x6e\56\152\x73\77\x76\145\162\x3d\61\x31\x2e\x34\56\x30", __FILE__));
    }
    function mo_saml_activation_message()
    {
        $AS = "\x75\x70\x64\141\x74\x65\144";
        $Nr = get_option("\x6d\157\137\x73\141\x6d\154\x5f\155\145\x73\x73\x61\x67\x65");
        echo "\74\144\151\x76\x20\143\154\x61\163\x73\75\x27" . $AS . "\x27\x3e\40\x3c\160\x3e" . $Nr . "\74\x2f\160\76\x3c\x2f\144\x69\x76\x3e";
    }
    function get_empty_strings()
    {
        return '';
    }
    function mo_saml_custom_attr_column($iO)
    {
        $oY = get_option("\x6d\157\137\163\x61\x6d\x6c\137\143\165\x73\x74\x6f\155\x5f\x61\x74\164\162\163\x5f\x6d\141\x70\160\151\156\147");
        if (!@unserialize($oY)) {
            goto y1;
        }
        $oY = unserialize($oY);
        y1:
        $jN = get_option("\163\141\x6d\x6c\x5f\x73\150\157\x77\x5f\x75\163\145\x72\x5f\x61\x74\x74\162\x69\x62\165\164\145");
        $W0 = 0;
        foreach ($oY as $Kn => $Iy) {
            if (empty($Kn)) {
                goto YJ;
            }
            if (!in_array($W0, $jN)) {
                goto ja;
            }
            $iO[$Kn] = $Kn;
            ja:
            YJ:
            $W0++;
            q8:
        }
        LZ:
        return $iO;
    }
    function mo_saml_attr_column_content($Iy, $yZ, $wu)
    {
        $oY = get_option("\155\157\137\163\141\x6d\154\137\x63\165\163\164\157\x6d\x5f\141\164\164\162\x73\x5f\155\141\160\160\151\x6e\147");
        if (!is_array($oY)) {
            goto g1;
        }
        foreach ($oY as $Kn => $Iy) {
            if (!($Kn === $yZ)) {
                goto EL;
            }
            $t2 = get_user_meta($wu, $yZ, false);
            if (empty($t2)) {
                goto BA;
            }
            if (!is_array($t2[0])) {
                goto Ty;
            }
            $cz = '';
            foreach ($t2[0] as $Ex) {
                $cz = $cz . $Ex;
                if (!next($t2[0])) {
                    goto eA;
                }
                $cz = $cz . "\x20\174\40";
                eA:
                d_:
            }
            K3:
            return $cz;
            goto pY;
            Ty:
            return $t2[0];
            pY:
            BA:
            EL:
            fh:
        }
        eF:
        g1:
    }
    static function mo_check_option_admin_referer($fm)
    {
        return isset($_POST["\x6f\x70\x74\151\x6f\156"]) and $_POST["\157\160\x74\x69\x6f\156"] == $fm and check_admin_referer($fm);
    }
    function miniorange_login_widget_saml_save_settings()
    {
        if (!current_user_can("\x6d\141\x6e\x61\147\145\x5f\x6f\x70\x74\151\157\156\163")) {
            goto u7;
        }
        if (!(is_admin() && get_option("\x41\x63\x74\151\166\141\164\x65\144\x5f\x50\x6c\x75\147\151\x6e") == "\120\154\x75\x67\x69\156\x2d\123\x6c\x75\147")) {
            goto wB;
        }
        delete_option("\x41\x63\x74\151\x76\x61\x74\x65\x64\137\120\x6c\x75\x67\151\156");
        update_option("\x6d\157\137\x73\x61\x6d\x6c\137\155\x65\x73\x73\141\x67\x65", "\x47\157\x20\164\x6f\40\x70\154\x75\x67\x69\156\x20\x3c\x62\x3e\x3c\x61\40\150\x72\x65\146\75\x22\141\x64\x6d\x69\156\56\x70\x68\160\77\160\141\147\x65\75\155\157\137\x73\x61\x6d\154\137\163\x65\164\164\x69\156\x67\x73\42\76\x73\145\x74\x74\151\x6e\x67\x73\74\57\x61\x3e\x3c\x2f\x62\x3e\40\x74\x6f\40\143\157\156\146\x69\147\165\162\x65\x20\123\x41\115\x4c\x20\123\x69\x6e\147\x6c\145\40\x53\151\x67\156\40\x4f\x6e\x20\142\171\x20\x6d\151\x6e\151\x4f\162\141\156\x67\145\56");
        add_action("\141\144\155\151\156\137\x6e\157\x74\151\143\x65\x73", array($this, "\x6d\157\137\163\x61\155\x6c\137\141\143\164\x69\166\x61\164\151\x6f\156\137\155\145\x73\163\141\x67\145"));
        wB:
        u7:
        if (!(isset($_POST["\x6f\160\164\x69\157\x6e"]) && current_user_can("\x6d\x61\156\141\147\145\x5f\157\x70\x74\x69\157\156\163"))) {
            goto f6;
        }
        if (self::mo_check_option_admin_referer("\x6c\x6f\147\x69\156\x5f\167\151\144\147\x65\x74\137\163\x61\155\154\137\x73\x61\166\x65\137\163\x65\x74\164\x69\x6e\147\x73")) {
            goto Z5;
        }
        if (self::mo_check_option_admin_referer("\154\x6f\x67\x69\x6e\x5f\167\x69\144\147\x65\164\137\x73\141\155\x6c\137\x61\164\x74\162\x69\142\165\164\x65\x5f\155\x61\160\x70\x69\x6e\x67")) {
            goto yV;
        }
        if (self::mo_check_option_admin_referer("\143\154\x65\x61\x72\x5f\141\164\164\x72\x73\x5f\154\x69\163\164")) {
            goto dA;
        }
        if (self::mo_check_option_admin_referer("\154\x6f\147\151\x6e\x5f\x77\151\x64\147\x65\164\x5f\x73\x61\x6d\x6c\137\162\x6f\154\x65\x5f\155\x61\160\x70\x69\156\147")) {
            goto RL;
        }
        if (self::mo_check_option_admin_referer("\163\x61\155\154\137\x66\157\162\x6d\137\144\x6f\155\141\x69\156\x5f\162\x65\x73\x74\162\151\x63\x74\x69\x6f\x6e\x5f\157\160\x74\151\x6f\156")) {
            goto so;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\x6d\154\137\165\160\x64\141\164\145\x5f\x69\144\160\137\x73\145\164\164\x69\156\x67\x73\137\157\160\x74\x69\157\156")) {
            goto pF;
        }
        if (!self::mo_check_option_admin_referer("\x73\x61\155\154\137\x75\160\x6c\157\x61\144\x5f\x6d\x65\x74\141\144\141\x74\x61")) {
            goto M_;
        }
        if (function_exists("\x77\x70\137\150\x61\x6e\x64\x6c\x65\137\165\160\154\x6f\x61\x64")) {
            goto sF;
        }
        require_once ABSPATH . "\x77\160\55\x61\144\x6d\151\x6e\57\x69\x6e\x63\x6c\x75\x64\145\x73\x2f\x66\x69\154\145\56\x70\x68\x70";
        sF:
        $this->_handle_upload_metadata();
        M_:
        goto BX;
        pF:
        if (!(isset($_POST["\155\157\137\163\x61\x6d\x6c\x5f\x73\160\x5f\142\141\x73\x65\137\165\162\154"]) && isset($_POST["\x6d\157\137\163\x61\x6d\x6c\x5f\x73\x70\x5f\145\x6e\164\x69\164\171\137\x69\x64"]))) {
            goto tz;
        }
        $We = sanitize_text_field($_POST["\x6d\x6f\137\163\x61\x6d\154\x5f\163\160\137\142\x61\x73\x65\x5f\165\162\x6c"]);
        $sM = sanitize_text_field($_POST["\x6d\x6f\x5f\x73\x61\x6d\x6c\x5f\163\x70\x5f\145\x6e\x74\x69\164\171\x5f\x69\144"]);
        if (!(substr($We, -1) == "\57")) {
            goto ky;
        }
        $We = substr($We, 0, -1);
        ky:
        update_option("\155\x6f\x5f\x73\x61\155\x6c\137\x73\x70\x5f\x62\x61\163\x65\137\165\x72\x6c", $We);
        update_option("\x6d\157\x5f\x73\x61\155\x6c\137\x73\x70\137\x65\x6e\164\x69\x74\x79\137\151\144", $sM);
        tz:
        update_option("\155\x6f\137\x73\141\155\x6c\x5f\x6d\x65\x73\x73\x61\147\145", "\x53\x65\164\164\151\156\x67\163\40\165\x70\x64\141\x74\145\x64\x20\163\x75\143\143\x65\x73\163\x66\165\x6c\154\x79\x2e");
        $this->mo_saml_show_success_message();
        BX:
        goto bG;
        so:
        $vG = isset($_POST["\155\157\x5f\163\x61\155\154\137\x65\156\x61\142\x6c\x65\x5f\144\x6f\155\x61\x69\x6e\137\162\x65\163\164\x72\151\143\164\x69\x6f\x6e\137\x6c\x6f\147\151\x6e"]) && !empty($_POST["\x6d\157\137\x73\141\x6d\x6c\x5f\145\156\141\142\x6c\145\x5f\144\157\x6d\x61\x69\x6e\137\x72\145\x73\x74\162\x69\x63\164\x69\x6f\x6e\137\154\x6f\147\x69\156"]) ? htmlspecialchars($_POST["\155\157\x5f\x73\141\155\154\137\145\x6e\x61\x62\154\145\x5f\144\x6f\155\141\x69\156\137\x72\145\163\164\162\x69\143\164\x69\157\156\x5f\x6c\157\x67\x69\x6e"]) : '';
        $zU = isset($_POST["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\141\154\x6c\157\x77\x5f\x64\x65\156\x79\137\165\163\145\x72\137\167\151\x74\150\137\x64\157\155\x61\x69\156"]) && !empty($_POST["\155\157\137\x73\x61\155\154\137\141\x6c\154\157\x77\137\144\x65\156\x79\x5f\165\163\145\162\137\167\x69\x74\150\x5f\144\157\x6d\141\x69\x6e"]) ? htmlspecialchars($_POST["\x6d\x6f\x5f\163\141\155\154\137\141\154\x6c\157\167\137\144\145\156\171\137\x75\x73\145\x72\137\x77\x69\164\x68\137\x64\x6f\155\x61\151\156"]) : "\141\x6c\x6c\x6f\x77";
        $xu = isset($_POST["\x73\x61\x6d\154\x5f\141\155\137\x65\155\141\151\154\137\144\157\155\141\x69\156\x73"]) && !empty($_POST["\x73\x61\155\154\x5f\141\155\137\x65\155\x61\151\154\x5f\144\157\x6d\141\x69\x6e\x73"]) ? htmlspecialchars($_POST["\163\141\155\154\137\141\x6d\x5f\x65\155\141\x69\x6c\137\144\x6f\155\x61\151\156\163"]) : '';
        update_option("\x6d\x6f\x5f\163\141\155\x6c\x5f\x65\x6e\x61\142\154\x65\x5f\144\x6f\x6d\x61\x69\156\137\162\x65\x73\x74\x72\151\x63\164\x69\157\x6e\137\x6c\x6f\147\151\156", $vG);
        update_option("\155\x6f\137\x73\141\x6d\x6c\137\141\x6c\x6c\x6f\167\137\144\x65\156\171\x5f\165\x73\x65\162\137\167\x69\x74\150\137\144\x6f\x6d\141\151\156", $zU);
        update_option("\163\x61\155\x6c\x5f\x61\155\137\x65\155\141\x69\154\137\144\x6f\155\x61\151\156\163", $xu);
        update_option("\155\x6f\137\163\x61\155\x6c\x5f\155\145\x73\x73\141\147\145", "\104\157\155\141\x69\x6e\40\122\x65\x73\164\162\151\x63\x74\x69\x6f\x6e\x20\150\141\x73\x20\142\x65\x65\x6e\x20\x73\141\166\145\x64\x20\x73\165\x63\x63\x65\x73\x73\x66\165\x6c\154\171\x2e");
        $this->mo_saml_show_success_message();
        bG:
        goto sp;
        RL:
        if (mo_saml_is_extension_installed("\x63\x75\162\x6c")) {
            goto hQ;
        }
        update_option("\155\157\x5f\x73\141\155\154\137\155\x65\163\163\141\x67\145", "\x45\122\x52\x4f\122\72\x20\120\x48\x50\40\143\x55\x52\114\40\145\x78\164\x65\x6e\x73\151\157\x6e\40\x69\163\x20\x6e\157\164\40\151\156\163\164\x61\x6c\154\145\144\40\x6f\162\x20\x64\151\x73\x61\x62\154\145\144\x2e\40\x53\141\x76\145\x20\122\157\x6c\x65\x20\x4d\x61\160\160\151\x6e\x67\x20\x66\141\151\154\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        hQ:
        if (!isset($_POST["\163\x61\155\154\x5f\x61\x6d\x5f\x64\x65\x66\x61\x75\154\164\x5f\x75\x73\x65\x72\x5f\x72\x6f\154\x65"])) {
            goto P2;
        }
        $DM = htmlspecialchars($_POST["\163\x61\155\x6c\x5f\141\x6d\x5f\x64\x65\x66\141\165\154\164\137\165\x73\145\162\x5f\x72\157\x6c\x65"]);
        update_option("\x73\x61\x6d\154\137\141\x6d\x5f\x64\145\x66\x61\x75\154\x74\x5f\x75\x73\145\162\137\162\157\x6c\145", $DM);
        P2:
        if (isset($_POST["\x73\x61\155\x6c\137\141\155\x5f\x64\x6f\x6e\x74\137\141\154\154\x6f\x77\x5f\x75\x6e\154\151\x73\164\x65\x64\x5f\165\163\x65\162\x5f\x72\157\x6c\x65"])) {
            goto Ry;
        }
        update_option("\163\141\x6d\x6c\137\141\x6d\137\144\157\x6e\164\137\x61\x6c\x6c\x6f\167\137\x75\x6e\154\x69\163\164\145\x64\x5f\165\x73\145\162\x5f\162\x6f\x6c\x65", "\x75\x6e\143\150\145\x63\x6b\x65\144");
        goto AR;
        Ry:
        update_option("\163\x61\x6d\154\x5f\141\155\x5f\144\x65\146\141\x75\154\164\x5f\x75\163\145\162\137\162\157\154\x65", false);
        update_option("\163\141\155\154\137\141\155\137\x64\157\x6e\164\137\x61\x6c\x6c\x6f\167\x5f\x75\156\154\x69\163\164\145\144\137\x75\163\145\x72\x5f\162\157\154\145", "\143\150\145\143\x6b\145\144");
        AR:
        if (isset($_POST["\155\157\x5f\x73\x61\x6d\x6c\137\144\157\156\x74\137\143\162\x65\141\164\x65\137\x75\x73\145\x72\x5f\x69\x66\137\162\157\154\145\x5f\x6e\x6f\x74\x5f\155\141\160\x70\x65\x64"])) {
            goto qc;
        }
        update_option("\155\x6f\137\x73\x61\x6d\154\137\x64\157\x6e\164\137\x63\162\145\141\x74\145\137\x75\x73\x65\162\x5f\x69\146\x5f\x72\x6f\154\x65\x5f\x6e\157\x74\137\x6d\x61\160\x70\145\x64", "\x75\156\143\x68\145\143\x6b\145\x64");
        goto XH;
        qc:
        update_option("\x6d\157\x5f\163\x61\155\x6c\x5f\x64\x6f\x6e\x74\x5f\x63\x72\145\x61\x74\x65\137\x75\163\145\162\x5f\x69\x66\137\x72\x6f\154\145\x5f\156\x6f\x74\x5f\x6d\141\160\160\145\x64", "\x63\150\145\143\153\x65\144");
        update_option("\163\x61\155\154\x5f\x61\155\137\x64\x65\146\x61\165\x6c\x74\137\165\163\x65\162\137\x72\x6f\x6c\x65", false);
        update_option("\x73\x61\155\154\x5f\141\155\137\x64\x6f\156\164\137\x61\154\x6c\157\x77\x5f\x75\156\154\151\163\164\145\x64\x5f\x75\163\x65\162\x5f\162\157\x6c\x65", "\165\156\x63\x68\145\143\153\x65\144");
        XH:
        if (isset($_POST["\155\x6f\x5f\163\x61\x6d\154\137\x64\x6f\x6e\x74\x5f\165\160\144\141\164\145\x5f\145\x78\151\x73\x74\x69\156\x67\137\165\x73\145\x72\137\162\x6f\x6c\145"])) {
            goto Np;
        }
        update_option("\163\141\x6d\154\x5f\141\155\137\x64\157\156\164\137\165\x70\x64\141\x74\145\x5f\145\x78\x69\x73\x74\x69\x6e\147\137\x75\163\x65\x72\137\162\157\x6c\x65", "\165\x6e\143\150\145\143\153\145\144");
        goto ip;
        Np:
        update_option("\x73\x61\x6d\154\137\141\155\x5f\x64\x6f\156\164\137\x75\x70\144\x61\x74\x65\x5f\145\170\151\x73\x74\151\156\147\137\165\x73\145\162\137\162\157\x6c\x65", "\143\x68\x65\143\153\145\144");
        ip:
        if (isset($_POST["\155\157\137\163\x61\x6d\154\x5f\144\157\x6e\x74\x5f\141\x6c\154\x6f\167\137\x75\x73\x65\x72\137\x74\157\x6c\157\147\x69\156\x5f\143\x72\145\141\x74\x65\137\x77\x69\164\150\137\147\151\x76\145\x6e\x5f\147\x72\x6f\x75\160\x73"])) {
            goto CS;
        }
        update_option("\x73\x61\155\154\x5f\x61\x6d\137\144\x6f\x6e\164\137\141\x6c\x6c\157\x77\137\x75\x73\x65\162\137\164\x6f\x6c\157\x67\151\156\137\143\x72\145\x61\164\145\x5f\x77\x69\164\150\137\147\x69\166\145\x6e\137\147\162\x6f\x75\160\163", "\x75\x6e\x63\150\145\x63\x6b\x65\x64");
        goto OE;
        CS:
        update_option("\163\x61\155\154\137\x61\x6d\x5f\144\157\x6e\x74\x5f\141\154\154\x6f\x77\x5f\x75\163\145\162\x5f\x74\x6f\x6c\x6f\x67\x69\156\x5f\x63\x72\145\x61\164\x65\137\167\x69\164\150\x5f\147\151\166\x65\x6e\x5f\147\x72\x6f\x75\160\x73", "\143\x68\x65\x63\x6b\145\x64");
        if (!isset($_POST["\x6d\x6f\x5f\x73\x61\155\x6c\137\x72\x65\163\x74\x72\x69\143\164\137\165\x73\145\162\x73\137\x77\151\x74\x68\137\x67\162\x6f\165\x70\x73"])) {
            goto rm;
        }
        if (!empty($_POST["\155\x6f\x5f\x73\141\155\x6c\137\x72\145\x73\164\x72\x69\143\x74\x5f\165\x73\x65\162\163\x5f\x77\x69\164\150\137\147\x72\x6f\165\x70\x73"])) {
            goto eq;
        }
        update_option("\x6d\157\137\x73\x61\x6d\x6c\137\162\x65\163\x74\x72\151\x63\164\137\165\x73\x65\x72\x73\x5f\x77\151\164\x68\x5f\x67\162\157\165\x70\163", '');
        goto En;
        eq:
        update_option("\155\x6f\x5f\x73\x61\x6d\154\137\162\145\163\x74\162\x69\x63\164\137\165\163\145\162\163\x5f\x77\x69\x74\150\137\147\x72\x6f\165\x70\x73", htmlspecialchars(stripslashes($_POST["\x6d\157\137\x73\x61\155\154\x5f\x72\x65\x73\x74\x72\151\143\x74\137\165\163\145\162\x73\x5f\x77\151\164\150\x5f\147\162\157\165\160\x73"])));
        En:
        rm:
        OE:
        $wp_roles = new WP_Roles();
        $MP = $wp_roles->get_names();
        $rd;
        foreach ($MP as $jP => $in) {
            $AI = "\x73\141\x6d\x6c\137\x61\155\137\147\x72\157\x75\x70\x5f\x61\x74\164\x72\x5f\x76\x61\x6c\165\x65\163\137" . $jP;
            $rd[$jP] = htmlspecialchars(stripslashes($_POST[$AI]));
            Ec:
        }
        fa:
        update_option("\163\141\155\154\137\141\x6d\x5f\x72\157\x6c\x65\137\155\x61\x70\160\151\156\147", $rd);
        update_option("\x6d\157\137\x73\141\x6d\x6c\x5f\x6d\x65\163\x73\141\x67\145", "\x52\x6f\154\x65\40\115\x61\x70\x70\x69\x6e\147\40\x64\x65\x74\141\151\x6c\163\x20\x73\141\x76\145\144\x20\163\165\143\x63\145\163\163\146\x75\x6c\154\171\56");
        $this->mo_saml_show_success_message();
        sp:
        goto nW;
        dA:
        delete_option("\x6d\x6f\137\163\141\155\x6c\137\164\x65\163\x74\137\x63\157\x6e\x66\151\x67\137\x61\x74\x74\x72\x73");
        update_option("\x6d\157\137\163\141\x6d\154\x5f\x6d\145\163\163\141\x67\145", "\x41\164\164\x72\x69\x62\x75\164\x65\163\40\x6c\x69\x73\x74\40\x72\x65\155\157\x76\145\144\x20\x73\165\143\143\x65\x73\x73\146\165\x6c\x6c\171");
        $this->mo_saml_show_success_message();
        nW:
        goto N9;
        yV:
        if (mo_saml_is_extension_installed("\x63\x75\x72\x6c")) {
            goto wN;
        }
        update_option("\x6d\157\x5f\163\x61\155\154\x5f\x6d\x65\163\x73\141\x67\x65", "\x45\x52\x52\117\x52\x3a\x20\x50\x48\120\40\143\125\x52\x4c\x20\x65\170\164\145\156\x73\x69\x6f\x6e\x20\x69\x73\40\x6e\157\164\40\x69\156\163\x74\141\154\x6c\145\144\40\x6f\162\x20\x64\x69\163\x61\x62\x6c\x65\x64\56\40\x53\x61\166\145\40\101\x74\164\162\x69\x62\165\x74\145\40\x4d\141\160\160\151\x6e\x67\40\146\141\x69\x6c\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        wN:
        update_option("\163\141\x6d\154\x5f\141\155\x5f\x75\163\x65\x72\x6e\x61\155\x65", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\x6c\137\141\155\x5f\165\163\x65\x72\x6e\x61\155\145"])));
        update_option("\163\141\x6d\x6c\x5f\141\155\x5f\145\x6d\141\x69\x6c", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\x6c\137\141\155\x5f\x65\155\x61\x69\x6c"])));
        update_option("\163\x61\x6d\154\137\x61\x6d\137\x66\151\x72\x73\x74\137\156\x61\155\145", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\x6c\x5f\141\155\137\x66\151\162\163\x74\137\156\141\155\145"])));
        update_option("\x73\x61\155\x6c\x5f\x61\155\137\154\141\x73\x74\137\x6e\x61\155\145", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\x6c\x5f\x61\155\x5f\154\141\x73\x74\x5f\x6e\x61\155\x65"])));
        update_option("\163\141\155\x6c\137\141\155\137\x67\162\x6f\165\160\x5f\156\141\x6d\x65", htmlspecialchars(stripslashes($_POST["\x73\x61\x6d\x6c\x5f\x61\x6d\x5f\147\162\x6f\165\160\137\x6e\x61\x6d\x65"])));
        update_option("\x73\x61\155\154\137\141\155\137\144\x69\x73\160\154\x61\171\137\156\x61\155\145", htmlspecialchars(stripslashes($_POST["\x73\x61\x6d\154\x5f\141\155\x5f\144\151\x73\x70\x6c\141\171\x5f\x6e\x61\x6d\x65"])));
        $oY = array();
        $ID = array();
        $o0 = array();
        $R1 = array();
        if (!(isset($_POST["\155\157\137\x73\141\155\154\x5f\143\165\163\x74\157\x6d\x5f\141\x74\164\x72\x69\142\x75\x74\145\x5f\x6b\145\x79\x73"]) && !empty($_POST["\155\157\137\163\x61\155\x6c\137\x63\x75\163\164\x6f\x6d\x5f\x61\x74\164\x72\151\x62\x75\x74\x65\137\x6b\145\171\x73"]))) {
            goto w_;
        }
        $ID = $_POST["\x6d\x6f\x5f\x73\141\155\154\137\143\x75\x73\x74\157\155\137\141\164\x74\x72\x69\142\165\164\x65\137\x6b\x65\x79\163"];
        w_:
        if (!(isset($_POST["\155\x6f\137\x73\x61\155\154\137\143\165\x73\164\x6f\155\137\141\x74\164\x72\151\x62\x75\164\145\137\x76\x61\x6c\165\x65\x73"]) && !empty($_POST["\155\x6f\x5f\x73\141\x6d\x6c\x5f\x63\165\163\x74\x6f\x6d\x5f\141\164\x74\x72\151\x62\x75\164\145\137\x76\141\x6c\165\145\163"]))) {
            goto Ld;
        }
        $o0 = $_POST["\x6d\x6f\x5f\x73\x61\155\x6c\x5f\143\165\x73\164\x6f\155\x5f\141\164\164\162\x69\142\x75\x74\145\137\166\x61\154\x75\145\x73"];
        Ld:
        $BJ = count($ID);
        if (!($BJ > 0)) {
            goto xP;
        }
        $ID = array_map("\150\164\x6d\154\163\x70\145\143\151\141\x6c\143\150\x61\162\163", $ID);
        $o0 = array_map("\x68\164\x6d\x6c\x73\160\x65\143\151\141\154\x63\150\141\162\x73", $o0);
        $ml = 0;
        fr:
        if (!($ml < $BJ)) {
            goto Ya;
        }
        if (!(isset($_POST["\155\x6f\x5f\x73\x61\x6d\154\x5f\x64\x69\x73\160\x6c\141\171\x5f\x61\x74\164\162\151\142\x75\x74\x65\137" . $ml]) && !empty($_POST["\155\157\137\x73\x61\155\154\137\144\151\163\x70\x6c\x61\171\x5f\x61\x74\x74\x72\151\142\165\164\145\137" . $ml]))) {
            goto C4;
        }
        array_push($R1, $ml);
        C4:
        $ml++;
        goto fr;
        Ya:
        xP:
        update_option("\x73\x61\x6d\154\137\163\150\x6f\167\137\x75\163\x65\x72\137\141\164\164\x72\151\142\165\164\x65", $R1);
        $oY = array_combine($ID, $o0);
        $oY = array_filter($oY);
        if (!empty($oY)) {
            goto A1;
        }
        $oY = get_option("\x6d\x6f\137\x73\x61\x6d\154\x5f\x63\165\x73\x74\157\155\x5f\141\x74\x74\162\x73\137\155\141\160\x70\151\x6e\x67");
        if (empty($oY)) {
            goto iz;
        }
        delete_option("\x6d\x6f\x5f\x73\141\x6d\154\x5f\x63\165\x73\x74\157\155\137\141\x74\x74\162\x73\137\x6d\141\x70\160\x69\x6e\x67");
        iz:
        goto A7;
        A1:
        update_option("\155\157\137\163\x61\x6d\x6c\x5f\x63\x75\x73\x74\157\x6d\x5f\x61\x74\x74\x72\163\x5f\155\141\x70\x70\x69\x6e\147", $oY);
        A7:
        update_option("\155\157\137\x73\141\155\x6c\137\155\x65\163\x73\x61\147\x65", "\x41\x74\x74\162\151\142\x75\x74\145\40\115\x61\x70\160\151\156\147\40\x64\x65\x74\141\151\x6c\x73\x20\163\x61\x76\145\144\x20\163\x75\x63\x63\x65\163\163\x66\165\x6c\154\x79");
        $this->mo_saml_show_success_message();
        N9:
        goto Lv;
        Z5:
        if (mo_saml_is_extension_installed("\143\165\x72\154")) {
            goto yq;
        }
        update_option("\x6d\x6f\137\163\141\x6d\x6c\137\x6d\145\x73\x73\141\x67\145", "\x45\122\122\x4f\x52\x3a\x20\x50\110\120\x20\x63\x55\x52\114\40\145\x78\x74\x65\156\x73\151\157\156\40\x69\163\40\x6e\x6f\x74\x20\x69\x6e\163\164\x61\x6c\154\x65\x64\x20\157\162\40\144\x69\x73\141\x62\x6c\145\144\x2e\40\123\141\x76\x65\x20\x49\144\x65\156\x74\x69\x74\x79\x20\x50\162\157\x76\151\x64\145\x72\x20\103\x6f\156\146\x69\x67\x75\162\141\164\x69\x6f\x6e\40\x66\x61\x69\154\x65\144\56");
        $this->mo_saml_show_error_message();
        return;
        yq:
        $qi = '';
        $pI = '';
        $qM = '';
        $m9 = '';
        $Vc = '';
        $GV = '';
        $wY = '';
        $nP = '';
        $B5 = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\163\141\155\x6c\x5f\x69\144\x65\156\164\x69\164\x79\137\x6e\141\155\145"]) || $this->mo_saml_check_empty_or_null($_POST["\163\x61\x6d\x6c\137\154\157\147\x69\x6e\137\165\162\154"]) || $this->mo_saml_check_empty_or_null($_POST["\163\x61\155\x6c\137\x69\x73\x73\165\x65\x72"]) || $this->mo_saml_check_empty_or_null($_POST["\x73\x61\155\154\x5f\x6e\x61\x6d\x65\151\144\137\x66\157\162\x6d\x61\x74"])) {
            goto Dj;
        }
        if (!preg_match("\57\x5e\134\x77\x2a\x24\57", $_POST["\x73\141\x6d\154\x5f\x69\x64\x65\156\164\151\x74\171\137\x6e\141\x6d\145"])) {
            goto Pu;
        }
        $qi = htmlspecialchars(trim($_POST["\x73\141\155\x6c\137\151\144\x65\x6e\x74\151\164\x79\137\156\141\x6d\145"]));
        $qM = htmlspecialchars(trim($_POST["\163\141\155\x6c\x5f\154\157\x67\151\156\x5f\x75\162\x6c"]));
        if (!array_key_exists("\163\141\x6d\x6c\137\x6c\157\147\x69\x6e\137\142\x69\156\x64\x69\x6e\147\x5f\x74\x79\160\x65", $_POST)) {
            goto Fk;
        }
        $pI = htmlspecialchars($_POST["\163\x61\155\154\137\x6c\157\147\151\156\x5f\142\151\156\x64\x69\x6e\x67\137\x74\x79\x70\x65"]);
        Fk:
        if (!array_key_exists("\163\141\155\154\x5f\154\x6f\147\157\x75\164\x5f\142\x69\156\144\x69\x6e\147\137\x74\x79\x70\x65", $_POST)) {
            goto ET;
        }
        $m9 = htmlspecialchars($_POST["\163\x61\155\x6c\x5f\x6c\157\147\157\x75\164\137\x62\x69\156\144\x69\x6e\147\x5f\x74\171\x70\x65"]);
        ET:
        if (!array_key_exists("\x73\x61\x6d\x6c\x5f\154\157\x67\x6f\x75\x74\x5f\x75\x72\154", $_POST)) {
            goto KQ;
        }
        $Vc = htmlspecialchars(trim($_POST["\163\141\x6d\154\137\154\157\147\x6f\165\164\137\x75\x72\x6c"]));
        KQ:
        $GV = htmlspecialchars(trim($_POST["\163\141\x6d\154\137\151\x73\163\165\145\x72"]));
        $g8 = htmlspecialchars(trim($_POST["\163\x61\x6d\x6c\137\x69\144\145\156\164\x69\164\171\x5f\160\x72\x6f\x76\151\144\145\x72\137\x67\165\151\144\145\137\x6e\141\155\x65"]));
        $wY = $_POST["\x73\141\155\154\x5f\170\65\x30\71\137\x63\x65\x72\x74\x69\146\x69\143\141\x74\145"];
        $B5 = htmlspecialchars($_POST["\163\x61\155\x6c\137\x6e\141\155\145\x69\x64\137\146\x6f\162\155\141\164"]);
        goto kz;
        Pu:
        update_option("\x6d\157\137\x73\x61\155\154\x5f\x6d\145\163\163\141\x67\x65", "\x50\154\x65\141\163\x65\40\x6d\141\164\143\x68\x20\x74\x68\145\40\162\x65\x71\x75\x65\x73\164\x65\144\40\146\157\x72\155\141\164\x20\x66\x6f\x72\40\111\144\145\x6e\x74\151\164\x79\40\120\x72\157\x76\x69\x64\x65\162\x20\116\141\x6d\145\56\40\117\x6e\154\x79\x20\x61\x6c\160\150\141\x62\x65\x74\163\54\40\156\x75\x6d\142\145\x72\163\40\141\x6e\x64\x20\x75\156\x64\x65\x72\x73\x63\x6f\x72\145\40\151\163\x20\141\x6c\154\x6f\167\145\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        kz:
        goto R5;
        Dj:
        update_option("\155\157\137\163\x61\x6d\x6c\x5f\155\145\x73\163\141\147\x65", "\101\x6c\x6c\40\x74\x68\x65\x20\146\x69\145\154\144\163\x20\x61\x72\145\x20\162\145\x71\x75\x69\162\145\x64\56\40\x50\154\145\x61\x73\145\40\145\x6e\x74\x65\162\x20\x76\x61\154\x69\144\40\145\156\x74\x72\151\145\x73\x2e");
        $this->mo_saml_show_error_message();
        return;
        R5:
        update_option("\163\141\155\154\x5f\151\x64\145\x6e\164\x69\x74\x79\x5f\156\141\x6d\x65", $qi);
        update_option("\x73\141\155\154\x5f\x6c\x6f\147\x69\x6e\x5f\x62\151\156\144\x69\x6e\147\x5f\164\x79\x70\145", $pI);
        update_option("\x73\141\x6d\x6c\x5f\154\x6f\147\x69\x6e\x5f\x75\x72\x6c", $qM);
        update_option("\163\x61\155\x6c\x5f\x6c\x6f\147\x6f\x75\164\x5f\x62\151\x6e\x64\x69\x6e\147\137\164\x79\160\x65", $m9);
        update_option("\163\x61\155\x6c\x5f\154\157\147\x6f\165\164\x5f\x75\162\x6c", $Vc);
        update_option("\163\x61\x6d\154\x5f\151\163\163\x75\145\x72", $GV);
        update_option("\163\x61\155\x6c\137\x6e\141\155\x65\151\x64\137\x66\x6f\162\155\141\x74", $B5);
        update_option("\163\x61\155\x6c\x5f\x69\x64\x65\156\x74\151\x74\171\137\x70\x72\157\x76\x69\144\145\x72\x5f\x67\x75\x69\x64\145\137\156\141\155\145", $g8);
        if (isset($_POST["\x73\141\155\x6c\x5f\x72\x65\161\x75\x65\163\x74\137\x73\151\x67\156\x65\x64"])) {
            goto Kd;
        }
        update_option("\x73\x61\155\154\137\x72\145\x71\x75\x65\163\x74\x5f\163\151\x67\x6e\145\144", "\x75\x6e\143\150\x65\143\x6b\x65\144");
        goto VK;
        Kd:
        update_option("\x73\x61\x6d\154\x5f\162\x65\161\165\145\163\x74\x5f\163\151\x67\156\x65\x64", "\143\150\x65\x63\153\145\144");
        VK:
        foreach ($wY as $Kn => $Iy) {
            if (empty($Iy)) {
                goto Qj;
            }
            $wY[$Kn] = SAMLSPUtilities::sanitize_certificate($Iy);
            if (@openssl_x509_read($wY[$Kn])) {
                goto dL;
            }
            update_option("\155\157\137\163\141\x6d\154\137\155\145\x73\163\x61\147\x65", "\111\x6e\x76\141\154\151\x64\x20\x63\145\162\x74\151\146\x69\143\x61\164\145\x3a\x20\x50\154\145\141\163\145\40\x70\162\157\166\151\x64\x65\x20\141\40\x76\x61\154\151\144\x20\x63\145\162\164\x69\146\x69\x63\141\164\145\x2e");
            $this->mo_saml_show_error_message();
            delete_option("\x73\141\x6d\154\x5f\x78\x35\x30\x39\x5f\x63\145\162\x74\151\146\151\x63\141\164\145");
            return;
            dL:
            goto i5;
            Qj:
            unset($wY[$Kn]);
            i5:
            SJ:
        }
        Nr:
        if (!empty($wY)) {
            goto Hm;
        }
        update_option("\155\x6f\x5f\x73\x61\x6d\154\137\155\145\163\x73\x61\147\x65", "\111\x6e\166\141\154\x69\x64\x20\103\x65\x72\x74\151\x66\151\x63\x61\x74\145\x3a\120\154\x65\x61\163\145\x20\160\162\x6f\166\x69\x64\x65\40\x61\x20\x63\x65\x72\x74\151\x66\x69\143\141\164\x65");
        $this->mo_saml_show_error_message();
        return;
        Hm:
        update_option("\163\141\x6d\154\x5f\170\65\60\71\137\x63\145\x72\164\x69\146\x69\x63\141\164\145", maybe_serialize($wY));
        if (isset($_POST["\x73\141\x6d\154\x5f\x72\x65\163\x70\x6f\156\163\145\x5f\163\x69\x67\156\145\x64"])) {
            goto aT;
        }
        update_option("\163\x61\155\154\x5f\x72\x65\163\x70\157\x6e\163\x65\137\x73\x69\x67\156\145\144", "\x59\x65\x73");
        goto gy;
        aT:
        update_option("\163\141\x6d\x6c\137\x72\145\163\x70\x6f\x6e\163\x65\x5f\163\151\x67\x6e\x65\x64", "\143\150\x65\143\153\x65\x64");
        gy:
        if (isset($_POST["\x73\141\x6d\154\137\141\x73\x73\145\x72\x74\151\x6f\156\137\163\x69\x67\x6e\x65\x64"])) {
            goto Z8;
        }
        update_option("\x73\x61\x6d\x6c\137\141\163\163\x65\x72\x74\x69\157\x6e\137\163\x69\147\156\x65\x64", "\131\x65\x73");
        goto HE;
        Z8:
        update_option("\x73\x61\155\x6c\x5f\141\x73\163\x65\x72\164\151\157\x6e\137\163\151\147\156\145\144", "\x63\x68\x65\x63\x6b\x65\144");
        HE:
        if (array_key_exists("\145\x6e\141\142\x6c\x65\137\x69\x63\x6f\x6e\x76", $_POST)) {
            goto SK;
        }
        update_option("\x6d\157\x5f\x73\141\155\154\137\x65\156\x63\x6f\144\151\156\147\x5f\145\x6e\x61\x62\x6c\145\144", '');
        goto zr;
        SK:
        update_option("\x6d\157\137\x73\x61\155\x6c\x5f\x65\x6e\x63\x6f\x64\151\156\x67\x5f\145\156\x61\142\154\145\x64", "\x63\x68\145\x63\x6b\x65\x64");
        zr:
        update_option("\x6d\157\137\x73\x61\x6d\154\137\155\x65\x73\x73\141\147\145", "\x49\x64\x65\x6e\164\151\164\x79\40\x50\162\x6f\166\x69\x64\145\x72\x20\x64\145\164\x61\151\154\x73\40\163\x61\166\x65\144\40\163\x75\143\143\145\163\163\x66\x75\x6c\154\x79\x2e");
        $this->mo_saml_show_success_message();
        Lv:
        if (self::mo_check_option_admin_referer("\141\144\x64\137\x63\x75\x73\164\x6f\x6d\137\143\x65\x72\x74\151\146\x69\143\141\164\145")) {
            goto RX;
        }
        if (self::mo_check_option_admin_referer("\x61\144\144\137\143\165\163\164\x6f\x6d\137\x6d\145\x73\x73\141\x67\145\x73")) {
            goto Uj;
        }
        if (!self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\x6d\154\x5f\162\145\x6c\141\171\137\163\x74\x61\164\145\137\157\160\164\x69\x6f\156")) {
            goto B6;
        }
        $SW = sanitize_text_field($_POST["\x6d\157\x5f\163\141\x6d\x6c\x5f\162\x65\x6c\x61\x79\x5f\x73\x74\x61\164\145"]);
        update_option("\x6d\157\137\163\x61\x6d\x6c\x5f\162\145\x6c\141\x79\x5f\x73\164\x61\164\x65", $SW);
        update_option("\x6d\157\x5f\x73\141\x6d\154\x5f\155\x65\x73\x73\x61\x67\145", "\122\145\x6c\141\x79\x20\x53\164\x61\x74\145\x20\x75\x70\144\x61\164\x65\144\40\163\165\143\143\x65\x73\x73\146\x75\x6c\x6c\x79\x2e");
        $this->mo_saml_show_success_message();
        B6:
        goto jW;
        Uj:
        update_option("\155\x6f\x5f\x73\141\155\x6c\x5f\141\143\143\x6f\165\x6e\x74\137\143\x72\x65\141\164\151\157\x6e\x5f\x64\x69\x73\x61\142\154\x65\144\137\x6d\163\147", sanitize_text_field($_POST["\x6d\x6f\137\x73\141\x6d\x6c\x5f\x61\143\x63\157\x75\156\x74\137\x63\162\x65\141\x74\x69\157\156\137\x64\x69\x73\x61\142\x6c\145\x64\x5f\x6d\163\x67"]));
        update_option("\155\157\x5f\x73\x61\x6d\x6c\137\162\145\163\164\x72\x69\143\164\145\144\137\x64\157\155\141\x69\156\x5f\145\x72\162\x6f\162\137\x6d\x73\147", sanitize_text_field($_POST["\155\x6f\x5f\x73\x61\155\x6c\137\162\x65\163\x74\x72\151\x63\164\145\144\137\144\x6f\155\141\x69\156\x5f\x65\162\162\157\x72\x5f\x6d\x73\x67"]));
        update_option("\155\157\137\163\141\155\x6c\137\x6d\x65\163\x73\141\x67\145", "\103\157\x6e\x66\151\x67\x75\162\x61\x74\151\x6f\x6e\x20\x68\x61\x73\x20\142\x65\x65\x6e\x20\163\141\166\145\x64\x20\x73\165\143\x63\x65\163\x73\146\x75\154\154\171\x2e");
        $this->mo_saml_show_success_message();
        jW:
        goto iE;
        RX:
        if (isset($_POST["\x73\165\x62\x6d\151\x74"]) and $_POST["\x73\165\x62\155\x69\164"] == "\x55\x70\x6c\x6f\141\144") {
            goto L_;
        }
        if (!(isset($_POST["\163\x75\142\155\x69\164"]) and $_POST["\163\165\142\155\x69\164"] == "\122\x65\x73\145\164")) {
            goto yT;
        }
        delete_option("\x6d\157\x5f\163\141\155\154\137\143\165\163\164\157\155\137\x63\x65\x72\x74");
        delete_option("\x6d\157\x5f\x73\141\x6d\154\x5f\143\165\163\164\157\155\137\143\145\x72\164\x5f\x70\162\x69\166\x61\x74\x65\137\153\145\x79");
        update_option("\155\x6f\137\x73\x61\155\154\137\143\165\x72\162\145\x6e\164\137\x63\145\162\164", isset($dJ));
        update_option("\155\157\137\x73\x61\155\x6c\x5f\x63\x75\x72\162\x65\x6e\x74\137\143\145\x72\164\x5f\160\x72\x69\x76\141\164\145\x5f\153\145\171", isset($Oz));
        update_option("\155\x6f\137\163\141\x6d\x6c\x5f\155\x65\x73\x73\141\x67\145", "\122\x65\x73\145\164\40\x43\145\x72\x74\151\x66\x69\x63\x61\164\x65\40\163\x75\143\143\x65\163\x73\x66\x75\x6c\x6c\x79\56");
        $this->mo_saml_show_success_message();
        yT:
        goto sl;
        L_:
        if (!@openssl_x509_read($_POST["\163\141\155\x6c\137\160\x75\x62\154\x69\143\137\x78\65\x30\71\137\143\x65\162\164\151\x66\151\143\141\x74\x65"])) {
            goto wl;
        }
        if (!@openssl_x509_check_private_key($_POST["\163\x61\x6d\x6c\x5f\x70\x75\x62\x6c\151\143\x5f\x78\x35\x30\71\x5f\x63\145\162\164\x69\146\151\x63\x61\x74\x65"], $_POST["\x73\x61\x6d\154\x5f\x70\x72\x69\x76\141\164\145\x5f\x78\x35\60\71\x5f\143\145\x72\164\151\x66\x69\143\x61\164\x65"])) {
            goto Nu;
        }
        if (openssl_x509_read($_POST["\x73\x61\x6d\x6c\137\x70\x75\x62\154\x69\x63\x5f\170\65\60\71\x5f\x63\145\162\x74\x69\x66\x69\x63\141\x74\145"]) && openssl_x509_check_private_key($_POST["\x73\x61\x6d\154\137\x70\165\x62\154\x69\x63\x5f\x78\65\x30\x39\x5f\x63\145\x72\x74\151\146\x69\x63\141\164\145"], $_POST["\163\x61\x6d\154\x5f\x70\162\151\166\141\164\x65\x5f\170\65\x30\x39\137\143\x65\162\164\x69\146\151\143\x61\x74\x65"])) {
            goto YO;
        }
        goto Mb;
        wl:
        update_option("\x6d\x6f\x5f\x73\x61\x6d\154\x5f\x6d\x65\x73\x73\x61\147\x65", "\111\x6e\166\x61\x6c\x69\x64\x20\103\x65\162\x74\x69\146\151\143\x61\x74\145\40\146\157\162\155\141\164\56\40\x50\x6c\145\141\x73\x65\40\145\156\164\x65\162\x20\x61\40\166\x61\154\x69\144\40\x63\145\x72\164\x69\146\x69\143\141\164\x65\56");
        $this->mo_saml_show_error_message();
        return;
        goto Mb;
        Nu:
        update_option("\155\x6f\137\163\x61\155\154\x5f\155\145\x73\x73\x61\147\145", "\111\156\x76\x61\x6c\x69\x64\x20\120\x72\151\x76\141\x74\145\40\113\145\171\x2e");
        $this->mo_saml_show_error_message();
        return;
        goto Mb;
        YO:
        $N_ = $_POST["\163\141\155\154\137\160\x75\x62\154\151\143\x5f\170\65\x30\x39\x5f\143\x65\x72\x74\x69\x66\151\143\x61\164\x65"];
        $UI = $_POST["\163\141\155\154\137\x70\162\x69\166\141\164\x65\x5f\x78\x35\60\71\137\143\x65\x72\164\x69\146\151\x63\141\x74\x65"];
        update_option("\x6d\x6f\137\163\x61\x6d\154\x5f\143\165\163\x74\x6f\x6d\137\x63\145\x72\164", $N_);
        update_option("\x6d\x6f\137\163\x61\x6d\x6c\x5f\x63\x75\163\164\157\x6d\137\x63\x65\162\164\137\160\x72\151\x76\141\x74\x65\x5f\x6b\145\171", $UI);
        update_option("\155\x6f\x5f\163\x61\155\154\137\143\x75\x72\x72\x65\x6e\x74\x5f\143\145\162\x74", $N_);
        update_option("\x6d\x6f\137\163\x61\155\x6c\137\143\165\x72\x72\x65\x6e\x74\x5f\143\x65\x72\164\137\x70\x72\151\166\x61\164\145\137\153\145\x79", $UI);
        update_option("\155\x6f\137\x73\141\x6d\x6c\137\x6d\x65\x73\163\141\x67\145", "\x43\x75\x73\x74\x6f\155\40\x43\145\x72\164\x69\146\151\x63\141\164\145\x20\x75\x70\144\141\164\x65\144\40\163\165\x63\x63\145\x73\x73\x66\165\x6c\154\x79\56");
        $this->mo_saml_show_success_message();
        Mb:
        sl:
        iE:
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\163\x61\155\154\x5f\167\x69\x64\x67\x65\x74\x5f\157\x70\164\x69\x6f\156")) {
            goto iM;
        }
        if (self::mo_check_option_admin_referer("\163\141\x6d\154\x5f\x67\145\x6e\x65\162\141\x74\145\137\143\x65\162\164\151\146\x69\x63\141\x74\145")) {
            goto wx;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\163\x61\x6d\154\x5f\x72\145\147\151\x73\164\x65\162\x5f\x63\x75\163\164\157\155\145\x72")) {
            goto Mt;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\163\x61\155\x6c\x5f\166\141\x6c\151\x64\141\x74\145\x5f\157\164\x70")) {
            goto O2;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\163\x61\155\154\137\166\x65\x72\151\146\x79\x5f\143\165\163\164\157\155\145\x72")) {
            goto nl;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\141\x6d\154\137\143\157\156\x74\141\143\x74\x5f\165\x73\x5f\161\x75\145\162\x79\137\x6f\x70\164\x69\157\156")) {
            goto a8;
        }
        if (self::mo_check_option_admin_referer("\155\157\x5f\x73\x61\155\x6c\x5f\x72\x65\163\145\156\144\137\x6f\x74\160\x5f\145\155\141\x69\154")) {
            goto xu;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\162\145\163\145\x6e\144\137\x6f\x74\160\x5f\x70\150\x6f\x6e\145")) {
            goto XZ;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\x61\155\154\137\x67\x6f\x5f\x62\x61\x63\x6b")) {
            goto ns;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\x61\x6d\154\x5f\x72\145\147\x69\x73\x74\145\x72\137\167\x69\164\x68\137\x70\150\x6f\x6e\145\137\x6f\x70\164\x69\157\156")) {
            goto KS;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\x73\x61\x6d\x6c\137\162\x65\x67\x69\163\x74\x65\x72\145\144\x5f\x6f\156\154\x79\137\x61\x63\x63\145\163\163\x5f\x6f\160\x74\x69\157\156")) {
            goto i1;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\x61\155\154\137\x72\x65\x64\151\x72\145\143\164\137\x74\x6f\x5f\167\160\x5f\x6c\x6f\x67\x69\156\137\x6f\x70\x74\151\157\156")) {
            goto hT;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\163\141\x6d\154\x5f\146\157\x72\x63\145\137\x61\165\x74\150\145\x6e\x74\151\x63\141\x74\x69\157\156\x5f\x6f\160\164\151\x6f\156")) {
            goto Rm;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\141\x6d\x6c\x5f\x65\156\141\142\x6c\x65\137\x72\x73\163\137\x61\x63\143\x65\x73\163\x5f\157\x70\164\151\157\x6e")) {
            goto L2;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\141\x6d\154\137\x65\156\141\142\x6c\145\137\x6c\x6f\x67\151\156\137\162\145\144\151\x72\x65\143\164\x5f\157\160\x74\x69\157\156")) {
            goto eP;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\163\x61\155\x6c\137\141\x64\144\x5f\x73\x73\157\137\x62\x75\164\x74\x6f\x6e\x5f\x77\x70\x5f\157\160\164\x69\157\156")) {
            goto o7;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\x61\155\154\x5f\x75\x73\x65\x5f\x62\165\x74\x74\x6f\x6e\x5f\x61\x73\137\x73\x68\x6f\x72\164\x63\x6f\144\x65\137\x6f\x70\164\151\x6f\156")) {
            goto Qa;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\x73\x61\x6d\154\x5f\165\163\145\137\x62\165\164\x74\157\156\x5f\x61\163\x5f\167\x69\144\147\x65\164\x5f\157\x70\164\x69\157\x6e")) {
            goto mv;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\163\141\x6d\154\137\141\x6c\x6c\157\x77\x5f\167\x70\137\163\x69\147\156\x69\x6e\x5f\x6f\x70\x74\151\157\156")) {
            goto zB;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\x61\155\x6c\137\143\165\x73\x74\x6f\x6d\137\142\x75\164\164\x6f\x6e\137\157\x70\x74\x69\157\x6e")) {
            goto TI;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\x61\x6d\x6c\x5f\146\157\162\x67\x6f\x74\137\160\141\x73\x73\x77\157\162\x64\x5f\146\157\162\155\x5f\157\160\x74\151\x6f\x6e")) {
            goto gL;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\x61\x6d\x6c\x5f\166\145\x72\151\146\171\x5f\154\151\x63\145\156\x73\145")) {
            goto bz;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\x73\x61\x6d\154\137\146\162\x65\x65\x5f\164\x72\151\141\154")) {
            goto Zt;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\141\155\x6c\x5f\143\x68\x65\x63\153\x5f\154\151\143\x65\156\x73\145")) {
            goto H9;
        }
        if (!self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\155\154\137\162\145\155\x6f\166\145\137\x61\x63\143\157\x75\156\x74")) {
            goto P1;
        }
        $this->mo_sso_saml_deactivate();
        add_option("\x6d\x6f\137\163\141\x6d\x6c\137\x72\x65\x67\151\x73\164\162\x61\x74\x69\157\x6e\x5f\x73\164\141\x74\165\x73", "\162\145\x6d\157\x76\x65\144\137\x61\x63\x63\x6f\165\156\164");
        $AP = add_query_arg(array("\x74\x61\142" => "\154\x6f\x67\x69\x6e"), $_SERVER["\122\105\x51\125\x45\x53\124\x5f\x55\122\111"]);
        header("\114\157\143\141\x74\x69\157\x6e\72\40" . $AP);
        P1:
        goto Vf;
        H9:
        $V4 = new Customersaml();
        $t2 = $V4->check_customer_ln();
        if ($t2) {
            goto Hu;
        }
        return;
        Hu:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\x74\x61\164\x75\x73"], "\x53\125\x43\103\x45\123\x53") == 0) {
            goto dF;
        }
        $Kn = get_option("\x6d\x6f\137\x73\x61\x6d\154\137\143\x75\163\x74\x6f\155\145\162\x5f\164\157\x6b\145\x6e");
        update_option("\x73\151\x74\145\x5f\143\x6b\137\x6c", AESEncryption::encrypt_data("\x66\141\x6c\x73\x65", $Kn));
        $AP = add_query_arg(array("\x74\x61\x62" => "\x6c\151\x63\x65\x6e\163\x69\x6e\147"), $_SERVER["\x52\x45\121\125\105\x53\124\x5f\125\122\111"]);
        update_option("\x6d\x6f\x5f\x73\141\x6d\154\137\x6d\x65\163\x73\x61\147\x65", "\x59\157\x75\x20\x68\x61\166\145\40\156\157\164\x20\x75\x70\x67\162\x61\144\145\144\40\171\x65\164\x2e\x20" . addLink("\103\x6c\x69\x63\x6b\40\x68\145\x72\x65", $AP) . "\40\164\157\x20\165\160\x67\162\141\144\x65\x20\164\x6f\x20\160\x72\145\x6d\x69\x75\155\40\166\x65\x72\x73\x69\157\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto xt;
        dF:
        if (array_key_exists("\154\151\143\145\156\x73\145\120\x6c\x61\156", $t2) && !$this->mo_saml_check_empty_or_null($t2["\x6c\x69\143\145\x6e\163\x65\x50\x6c\141\x6e"])) {
            goto hw;
        }
        $Kn = get_option("\x6d\157\137\x73\x61\x6d\154\x5f\143\165\x73\x74\x6f\155\145\162\x5f\x74\x6f\153\x65\156");
        update_option("\163\151\164\145\137\x63\x6b\x5f\x6c", AESEncryption::encrypt_data("\146\141\x6c\x73\145", $Kn));
        $AP = add_query_arg(array("\x74\141\142" => "\154\x69\x63\145\x6e\163\151\156\147"), $_SERVER["\x52\105\x51\125\105\123\124\x5f\x55\122\111"]);
        update_option("\155\157\137\163\141\x6d\154\137\x6d\x65\163\163\x61\x67\x65", "\131\157\x75\x20\150\x61\x76\145\x20\x6e\x6f\x74\40\165\160\147\x72\x61\x64\145\x64\40\x79\x65\x74\x2e\40" . addLink("\103\154\151\x63\x6b\40\x68\x65\162\145", $AP) . "\x20\164\x6f\40\x75\160\x67\162\x61\144\145\x20\x74\x6f\x20\x70\162\x65\x6d\151\165\x6d\40\x76\x65\162\x73\151\x6f\x6e\56");
        $this->mo_saml_show_error_message();
        goto Vb;
        hw:
        update_option("\x6d\157\x5f\163\141\x6d\x6c\137\x6c\151\x63\x65\x6e\163\x65\x5f\156\x61\x6d\145", base64_encode($t2["\x6c\x69\143\145\x6e\x73\145\x50\x6c\x61\156"]));
        $Kn = get_option("\155\157\137\163\x61\x6d\154\137\x63\165\x73\x74\157\155\145\162\137\164\157\153\145\156");
        if (!(array_key_exists("\x6e\157\x4f\146\x55\x73\x65\x72\x73", $t2) && !$this->mo_saml_check_empty_or_null($t2["\x6e\x6f\117\146\x55\x73\x65\x72\163"]))) {
            goto ji;
        }
        update_option("\x6d\x6f\137\163\141\x6d\154\x5f\165\163\162\137\x6c\155\x74", AESEncryption::encrypt_data($t2["\156\x6f\x4f\146\125\163\x65\162\x73"], $Kn));
        ji:
        update_option("\163\151\164\x65\137\x63\153\137\154", AESEncryption::encrypt_data("\x74\162\x75\x65", $Kn));
        $zj = plugin_dir_path(__FILE__);
        $eE = home_url();
        $eE = trim($eE, "\57");
        if (preg_match("\x23\136\150\x74\x74\160\x28\x73\x29\x3f\72\57\x2f\43", $eE)) {
            goto ij;
        }
        $eE = "\x68\x74\164\160\x3a\x2f\x2f" . $eE;
        ij:
        $OQ = parse_url($eE);
        $dx = preg_replace("\x2f\136\x77\x77\167\134\56\57", '', $OQ["\150\x6f\163\164"]);
        $MX = wp_upload_dir();
        $cW = $dx . "\x2d" . $MX["\x62\x61\x73\x65\x64\151\162"];
        $NZ = hash_hmac("\x73\x68\x61\x32\x35\66", $cW, "\64\x44\110\146\x6a\147\x66\x6a\x61\163\156\144\146\163\x61\152\146\x48\107\112");
        $D4 = $this->djkasjdksa();
        $Ju = round(strlen($D4) / rand(2, 20));
        $D4 = substr_replace($D4, $NZ, $Ju, 0);
        $rX = base64_decode($D4);
        if (is_writable($zj . "\154\x69\x63\145\156\163\x65")) {
            goto Ue;
        }
        $D4 = str_rot13($D4);
        $yy = base64_decode("\x62\107\x4e\153\x61\155\x74\150\143\x32\160\x6b\141\63\x4e\150\x59\x32\x77\x3d");
        update_option($yy, $D4);
        goto VN;
        Ue:
        file_put_contents($zj . "\154\151\143\x65\156\x73\x65", $rX);
        VN:
        update_option("\154\x63\167\162\164\154\146\x73\x61\x6d\x6c", true);
        $AP = add_query_arg(array("\x74\x61\x62" => "\147\x65\156\x65\162\x61\154"), $_SERVER["\122\x45\121\x55\105\x53\x54\x5f\x55\x52\111"]);
        update_option("\155\x6f\137\163\141\x6d\154\137\155\145\x73\163\141\x67\145", "\131\157\x75\40\150\141\166\145\40\163\x75\x63\143\145\163\x73\146\165\154\154\171\x20\x75\x70\x67\162\x61\x64\x65\x64\40\x79\157\165\x72\x20\x6c\x69\x63\x65\156\163\x65\56");
        $this->mo_saml_show_success_message();
        Vb:
        xt:
        Vf:
        goto K0;
        Zt:
        if (decryptSamlElement()) {
            goto zF;
        }
        $ug = postResponse();
        $V4 = new Customersaml();
        $t2 = $V4->mo_saml_vl($ug, false);
        if ($t2) {
            goto Pc;
        }
        return;
        Pc:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\x74\x61\x74\165\163"], "\x53\125\x43\x43\x45\123\123") == 0) {
            goto hU;
        }
        if (strcasecmp($t2["\163\164\x61\x74\165\x73"], "\106\101\x49\114\x45\104") == 0) {
            goto OI;
        }
        update_option("\x6d\x6f\137\x73\141\155\154\137\x6d\145\x73\163\x61\147\145", "\101\156\40\x65\x72\x72\157\162\x20\x6f\143\x63\165\162\x65\x64\40\167\x68\151\154\x65\40\x70\x72\x6f\143\x65\x73\163\x69\156\x67\40\x79\x6f\165\x72\40\162\145\161\165\x65\x73\x74\x2e\x20\120\x6c\x65\x61\x73\145\40\124\x72\x79\x20\x61\147\x61\x69\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto tr;
        OI:
        update_option("\155\157\x5f\163\141\155\x6c\137\155\x65\x73\163\141\147\145", "\x54\x68\145\162\145\x20\167\x61\x73\x20\141\156\40\145\162\162\x6f\162\x20\141\143\x74\151\166\141\164\151\156\x67\40\171\157\x75\x72\40\124\122\111\101\x4c\x20\166\x65\x72\x73\x69\x6f\156\x2e\40\120\154\145\141\x73\145\40\143\x6f\x6e\x74\141\143\x74\x20\x69\x6e\146\157\x40\x78\145\x63\x75\x72\x69\x66\171\x2e\143\157\155\40\x66\x6f\162\40\x67\x65\164\164\151\156\x67\40\x6e\145\x77\x20\154\151\x63\x65\x6e\x73\x65\40\x66\157\x72\40\x74\162\151\x61\154\x20\x76\145\x72\163\151\x6f\x6e\x2e");
        $this->mo_saml_show_error_message();
        tr:
        goto ZM;
        hU:
        $Kn = get_option("\155\x6f\x5f\x73\141\155\x6c\137\143\x75\x73\164\x6f\x6d\145\x72\137\x74\x6f\153\145\x6e");
        $Kn = get_option("\x6d\157\137\163\141\x6d\154\x5f\x63\x75\163\164\157\x6d\x65\162\137\164\157\x6b\x65\156");
        update_option("\164\x5f\163\151\164\x65\x5f\163\x74\x61\x74\x75\163", AESEncryption::encrypt_data("\x74\162\165\x65", $Kn));
        update_option("\x6d\157\x5f\x73\x61\x6d\x6c\x5f\155\x65\x73\163\x61\x67\x65", "\131\x6f\165\x72\40\x35\40\144\x61\171\163\x20\124\x52\x49\x41\114\40\x69\163\x20\141\x63\164\x69\x76\x61\x74\x65\144\56\x20\x59\x6f\x75\40\x63\x61\x6e\40\x6e\157\x77\x20\163\145\164\x75\x70\x20\164\150\145\40\x70\x6c\x75\147\151\x6e\56");
        $this->mo_saml_show_success_message();
        ZM:
        goto xI;
        zF:
        update_option("\x6d\x6f\137\163\x61\155\154\137\155\x65\163\x73\x61\x67\x65", "\124\150\145\x72\145\40\x77\141\163\x20\141\x6e\x20\x65\x72\162\157\162\40\141\x63\164\x69\166\141\x74\x69\x6e\x67\40\x79\157\x75\x72\40\x54\x52\111\101\114\40\x76\145\x72\x73\151\157\x6e\56\40\105\x69\164\x68\145\x72\x20\x79\x6f\165\162\40\164\x72\151\141\154\x20\160\x65\162\x69\x6f\144\x20\x69\x73\40\x65\x78\160\151\x72\145\x64\40\x6f\x72\x20\171\x6f\x75\x20\141\x72\x65\x20\x75\x73\151\156\147\40\167\162\x6f\x6e\147\40\x74\x72\151\x61\154\40\166\145\x72\163\151\157\x6e\x2e\x20\x50\154\145\x61\163\145\x20\x63\x6f\x6e\x74\141\x63\x74\40\151\x6e\146\x6f\x40\x78\x65\143\165\x72\151\x66\171\56\x63\157\155\x20\146\157\x72\40\x67\x65\x74\x74\151\156\147\40\x6e\x65\x77\x20\x6c\151\x63\x65\x6e\x73\145\40\146\x6f\162\40\x74\162\151\x61\x6c\40\166\145\x72\163\151\x6f\156\56");
        $this->mo_saml_show_error_message();
        xI:
        K0:
        goto g0;
        bz:
        if (!$this->mo_saml_check_empty_or_null($_POST["\x73\141\155\x6c\137\x6c\x69\143\145\x6e\143\145\137\153\x65\x79"])) {
            goto aq;
        }
        update_option("\155\157\137\x73\141\x6d\x6c\x5f\x6d\145\x73\163\141\147\145", "\x41\x6c\x6c\x20\164\x68\x65\40\146\x69\145\154\x64\x73\40\141\162\x65\40\x72\145\x71\x75\151\162\x65\x64\x2e\x20\x50\x6c\x65\141\163\x65\x20\x65\156\164\x65\x72\40\x76\141\154\151\x64\x20\x6c\151\143\x65\156\163\145\x20\x6b\145\x79\56");
        $this->mo_saml_show_error_message();
        return;
        aq:
        $ug = htmlspecialchars(trim($_POST["\163\141\155\x6c\x5f\x6c\x69\143\x65\156\143\145\137\153\145\171"]));
        $V4 = new Customersaml();
        $t2 = $V4->check_customer_ln();
        if ($t2) {
            goto Up;
        }
        return;
        Up:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\163\164\x61\x74\165\163"], "\x53\x55\103\x43\x45\123\x53") == 0) {
            goto ap;
        }
        $Kn = get_option("\155\157\x5f\163\141\155\154\137\143\x75\x73\x74\157\x6d\x65\x72\137\164\x6f\x6b\145\x6e");
        update_option("\163\x69\x74\145\x5f\x63\x6b\137\x6c", AESEncryption::encrypt_data("\x66\x61\154\x73\145", $Kn));
        $AP = add_query_arg(array("\164\141\x62" => "\x6c\151\143\x65\156\163\151\156\x67"), $_SERVER["\122\105\121\x55\x45\x53\124\137\x55\x52\111"]);
        update_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\x6d\145\x73\163\x61\147\145", "\x59\x6f\165\40\150\x61\166\x65\40\x6e\157\164\x20\165\x70\147\x72\x61\144\145\144\x20\x79\145\x74\x2e\x20" . addLink("\x43\x6c\151\143\x6b\40\x68\145\x72\145", $AP) . "\x20\164\x6f\40\x75\160\147\162\x61\144\145\40\x74\x6f\x20\x70\x72\x65\x6d\x69\165\x6d\40\166\x65\162\x73\151\x6f\x6e\56");
        $this->mo_saml_show_error_message();
        goto w8;
        ap:
        $t2 = json_decode($V4->mo_saml_vl($ug, false), true);
        update_option("\166\154\x5f\143\150\x65\x63\153\137\164", time());
        if (strcasecmp($t2["\163\164\x61\x74\165\x73"], "\x53\x55\103\103\x45\x53\x53") == 0) {
            goto OL;
        }
        if (strcasecmp($t2["\x73\x74\x61\x74\165\163"], "\x46\101\111\x4c\x45\x44") == 0) {
            goto UX;
        }
        update_option("\x6d\157\x5f\163\141\155\154\137\155\145\x73\x73\x61\x67\145", "\x41\x6e\x20\x65\x72\162\x6f\x72\x20\x6f\143\143\x75\x72\x65\144\x20\167\150\x69\x6c\x65\x20\160\162\x6f\143\x65\163\x73\x69\x6e\147\x20\x79\157\x75\x72\40\x72\x65\161\165\x65\163\x74\x2e\40\x50\154\145\x61\x73\x65\x20\x54\x72\x79\x20\x61\147\x61\x69\x6e\56");
        $this->mo_saml_show_error_message();
        goto YV;
        UX:
        if (strcasecmp($t2["\155\x65\163\x73\141\x67\145"], "\x43\x6f\144\145\x20\150\x61\163\40\105\x78\x70\151\x72\x65\x64") == 0) {
            goto OK;
        }
        update_option("\x6d\157\x5f\x73\141\x6d\154\x5f\155\145\163\163\x61\147\145", "\x59\157\x75\40\150\141\x76\145\40\x65\156\x74\x65\162\145\144\40\x61\x6e\x20\151\x6e\x76\141\154\x69\144\40\x6c\x69\x63\145\156\x73\145\x20\x6b\x65\x79\x2e\40\x50\154\145\141\x73\x65\40\145\156\164\145\x72\40\x61\x20\166\x61\154\151\x64\x20\154\151\x63\x65\156\x73\145\40\153\x65\171\x2e");
        goto f_;
        OK:
        $AP = add_query_arg(array("\x74\x61\x62" => "\x6c\151\143\x65\x6e\163\151\x6e\147"), $_SERVER["\122\105\x51\x55\x45\x53\x54\137\x55\x52\111"]);
        update_option("\x6d\157\x5f\163\x61\x6d\154\137\x6d\x65\163\163\141\147\x65", "\114\151\143\145\x6e\x73\145\40\153\145\x79\40\171\x6f\x75\x20\x68\x61\166\x65\40\x65\156\x74\x65\x72\x65\144\x20\150\x61\x73\40\141\x6c\x72\x65\x61\144\171\x20\142\x65\x65\x6e\40\x75\x73\x65\144\x2e\40\x50\154\145\141\x73\x65\x20\145\x6e\x74\145\x72\x20\x61\x20\153\145\x79\40\x77\x68\151\143\150\x20\150\x61\x73\40\156\157\164\x20\x62\145\145\156\40\x75\x73\145\x64\x20\x62\x65\x66\157\162\145\x20\x6f\x6e\40\141\156\x79\x20\x6f\164\150\x65\162\40\x69\156\x73\164\x61\156\143\x65\x20\x6f\162\x20\x69\146\40\x79\x6f\x75\40\x68\x61\166\145\x20\145\x78\141\x75\163\x74\x65\x64\x20\141\x6c\154\x20\171\x6f\165\162\x20\x6b\145\x79\x73\40\x74\150\x65\x6e\40" . addLink("\103\154\151\x63\153\40\x68\145\162\x65", $AP) . "\40\164\157\40\142\x75\x79\x20\155\x6f\x72\x65\x2e");
        f_:
        $this->mo_saml_show_error_message();
        YV:
        goto a4;
        OL:
        $Kn = get_option("\x6d\x6f\137\163\141\155\x6c\x5f\x63\165\x73\x74\157\x6d\145\162\137\x74\x6f\153\145\156");
        update_option("\163\155\x6c\137\x6c\x6b", AESEncryption::encrypt_data($ug, $Kn));
        $Nr = "\x59\157\165\162\x20\154\151\143\x65\156\163\145\40\x69\163\x20\166\145\x72\x69\x66\x69\x65\144\x2e\40\131\x6f\x75\40\143\141\156\40\x6e\x6f\167\x20\163\x65\164\165\x70\x20\x74\x68\145\x20\x70\154\165\x67\x69\156\56";
        update_option("\x6d\157\x5f\x73\x61\155\154\x5f\155\145\x73\x73\x61\147\145", $Nr);
        $Kn = get_option("\155\x6f\x5f\x73\141\155\154\137\143\x75\x73\x74\157\155\145\162\x5f\164\x6f\x6b\x65\x6e");
        update_option("\163\x69\x74\x65\x5f\143\153\x5f\x6c", AESEncryption::encrypt_data("\164\162\x75\145", $Kn));
        update_option("\164\x5f\163\x69\x74\x65\x5f\x73\x74\141\164\165\x73", AESEncryption::encrypt_data("\x66\141\154\x73\x65", $Kn));
        $zj = plugin_dir_path(__FILE__);
        $eE = home_url();
        $eE = trim($eE, "\x2f");
        if (preg_match("\43\x5e\x68\164\164\160\x28\163\x29\77\x3a\x2f\57\43", $eE)) {
            goto Ak;
        }
        $eE = "\150\x74\x74\160\x3a\x2f\x2f" . $eE;
        Ak:
        $OQ = parse_url($eE);
        $dx = preg_replace("\57\136\x77\x77\x77\x5c\x2e\x2f", '', $OQ["\150\157\163\164"]);
        $MX = wp_upload_dir();
        $cW = $dx . "\x2d" . $MX["\142\x61\x73\x65\x64\151\162"];
        $NZ = hash_hmac("\163\150\x61\x32\65\66", $cW, "\x34\104\x48\146\x6a\147\x66\152\x61\x73\156\144\146\163\141\x6a\146\110\x47\x4a");
        $D4 = $this->djkasjdksa();
        $Ju = round(strlen($D4) / rand(2, 20));
        $D4 = substr_replace($D4, $NZ, $Ju, 0);
        $rX = base64_decode($D4);
        if (is_writable($zj . "\154\151\x63\x65\x6e\x73\145")) {
            goto pp;
        }
        $D4 = str_rot13($D4);
        $yy = base64_decode("\x62\107\116\153\141\x6d\x74\x68\x63\x32\160\153\x61\63\116\150\x59\62\x77\x3d");
        update_option($yy, $D4);
        goto mr;
        pp:
        file_put_contents($zj . "\154\x69\x63\145\x6e\163\145", $rX);
        mr:
        update_option("\154\143\167\162\x74\x6c\146\x73\141\155\x6c", true);
        $AP = add_query_arg(array("\164\x61\x62" => "\x67\x65\x6e\x65\162\x61\154"), $_SERVER["\x52\105\121\125\x45\x53\x54\x5f\125\x52\111"]);
        $this->mo_saml_show_success_message();
        a4:
        w8:
        g0:
        goto PS;
        gL:
        if (mo_saml_is_extension_installed("\143\165\162\x6c")) {
            goto Sb;
        }
        update_option("\155\157\137\x73\141\x6d\x6c\x5f\x6d\145\163\x73\x61\147\x65", "\105\x52\122\117\x52\72\x20\120\110\x50\40\x63\x55\122\114\x20\145\x78\164\145\x6e\163\x69\157\x6e\40\x69\163\40\156\x6f\x74\40\151\x6e\163\x74\141\154\x6c\145\x64\x20\157\162\40\x64\x69\163\x61\142\154\145\x64\x2e\40\x52\x65\163\x65\156\x64\40\x4f\x54\x50\40\146\141\x69\154\145\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        Sb:
        $oz = get_option("\x6d\x6f\137\x73\141\155\x6c\137\141\144\x6d\151\156\x5f\x65\155\x61\151\154");
        $V4 = new Customersaml();
        $t2 = $V4->mo_saml_forgot_password($oz);
        if ($t2) {
            goto SH;
        }
        return;
        SH:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\164\x61\164\165\163"], "\x53\125\x43\103\105\x53\x53") == 0) {
            goto rS;
        }
        update_option("\155\157\137\x73\141\x6d\x6c\x5f\155\145\x73\163\141\147\145", "\101\156\x20\x65\x72\162\157\x72\x20\x6f\143\143\x75\x72\145\x64\40\167\x68\x69\154\x65\x20\x70\x72\x6f\143\x65\x73\163\x69\156\x67\40\171\157\x75\162\40\x72\x65\x71\x75\145\163\x74\x2e\x20\x50\154\145\x61\x73\x65\40\x54\x72\x79\40\141\x67\x61\151\156\x2e");
        $this->mo_saml_show_error_message();
        goto Cp;
        rS:
        update_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\155\x65\x73\163\141\147\x65", "\x59\157\165\x72\x20\160\x61\163\x73\x77\157\x72\x64\x20\x68\141\x73\x20\x62\x65\x65\x6e\40\162\x65\163\x65\x74\x20\x73\x75\x63\143\x65\163\x73\x66\165\x6c\154\171\x2e\40\x50\x6c\x65\141\x73\x65\x20\145\x6e\164\x65\162\x20\164\x68\x65\40\x6e\145\x77\x20\160\141\163\x73\167\x6f\x72\144\x20\x73\145\x6e\164\x20\164\x6f\40" . $oz . "\56");
        $this->mo_saml_show_success_message();
        Cp:
        PS:
        goto U7;
        TI:
        $c3 = '';
        $Fd = '';
        $ns = '';
        $iK = '';
        $LW = '';
        $vZ = '';
        $d4 = '';
        $nM = '';
        $Qu = '';
        $AH = '';
        $hx = "\x61\x62\157\x76\x65";
        if (!(array_key_exists("\155\157\x5f\163\x61\155\x6c\x5f\142\165\x74\164\x6f\x6e\137\x73\151\x7a\145", $_POST) && !empty($_POST["\155\157\x5f\163\141\x6d\x6c\x5f\142\x75\164\x74\x6f\156\x5f\x73\151\172\x65"]))) {
            goto Sy;
        }
        $ns = htmlspecialchars($_POST["\155\x6f\137\163\141\155\154\137\x62\165\x74\x74\x6f\x6e\x5f\x73\151\x7a\x65"]);
        Sy:
        if (!(array_key_exists("\x6d\x6f\x5f\163\141\x6d\x6c\x5f\x62\165\164\164\x6f\x6e\137\x77\151\x64\164\150", $_POST) && !empty($_POST["\155\157\x5f\163\x61\155\154\137\142\x75\x74\164\x6f\156\137\x77\151\x64\x74\x68"]))) {
            goto D5;
        }
        $iK = htmlspecialchars($_POST["\155\157\137\163\x61\155\x6c\x5f\142\165\164\164\x6f\x6e\x5f\167\151\x64\164\150"]);
        D5:
        if (!(array_key_exists("\x6d\x6f\137\163\141\155\154\x5f\x62\x75\x74\x74\157\156\x5f\x68\x65\151\147\150\164", $_POST) && !empty($_POST["\155\157\137\x73\x61\155\x6c\137\x62\165\164\164\x6f\156\137\x68\145\x69\147\x68\x74"]))) {
            goto vW;
        }
        $LW = htmlspecialchars($_POST["\x6d\157\x5f\163\x61\155\154\x5f\142\x75\164\x74\157\x6e\x5f\150\145\x69\x67\150\x74"]);
        vW:
        if (!(array_key_exists("\155\157\x5f\163\141\x6d\154\137\142\165\164\x74\157\156\x5f\143\x75\162\x76\145", $_POST) && !empty($_POST["\x6d\x6f\x5f\163\x61\155\x6c\x5f\142\x75\164\164\157\x6e\x5f\x63\165\x72\166\x65"]))) {
            goto UU;
        }
        $vZ = htmlspecialchars($_POST["\155\x6f\137\x73\141\x6d\x6c\x5f\x62\x75\164\x74\x6f\x6e\137\143\165\162\x76\x65"]);
        UU:
        if (!array_key_exists("\x6d\157\x5f\x73\x61\155\x6c\x5f\x62\x75\164\x74\x6f\156\x5f\143\157\154\157\x72", $_POST)) {
            goto Do1;
        }
        $d4 = htmlspecialchars($_POST["\155\157\137\x73\141\155\x6c\x5f\142\x75\x74\x74\157\x6e\x5f\143\157\x6c\x6f\162"]);
        Do1:
        if (!array_key_exists("\x6d\x6f\x5f\x73\141\x6d\154\x5f\142\165\164\x74\x6f\156\x5f\164\x68\145\x6d\x65", $_POST)) {
            goto Zb;
        }
        $c3 = htmlspecialchars($_POST["\x6d\157\x5f\163\x61\x6d\154\x5f\142\x75\164\164\157\x6e\137\164\150\145\x6d\145"]);
        Zb:
        if (!array_key_exists("\155\x6f\137\x73\141\155\x6c\x5f\142\x75\164\164\157\156\137\164\145\x78\x74", $_POST)) {
            goto vu;
        }
        $nM = htmlspecialchars($_POST["\155\157\137\163\141\x6d\x6c\x5f\x62\x75\164\164\157\x6e\x5f\x74\x65\x78\164"]);
        if (!(empty($nM) || $nM == "\x4c\x6f\x67\x69\156")) {
            goto YC;
        }
        $nM = "\x4c\x6f\147\151\156";
        YC:
        $qb = get_option("\x73\x61\x6d\154\137\151\144\145\156\x74\x69\x74\x79\137\x6e\x61\x6d\145");
        $nM = str_replace("\43\43\x49\104\x50\43\43", $qb, $nM);
        vu:
        if (!array_key_exists("\155\157\137\163\x61\155\x6c\x5f\x66\157\x6e\x74\137\143\x6f\x6c\x6f\x72", $_POST)) {
            goto mF;
        }
        $Qu = htmlspecialchars($_POST["\x6d\x6f\x5f\163\x61\155\154\137\x66\x6f\x6e\164\137\143\157\x6c\x6f\162"]);
        mF:
        if (!array_key_exists("\155\x6f\137\163\141\155\x6c\137\146\157\156\164\137\163\x69\x7a\145", $_POST)) {
            goto Iv;
        }
        $AH = htmlspecialchars($_POST["\x6d\157\x5f\163\x61\155\x6c\x5f\x66\157\x6e\x74\137\163\x69\172\145"]);
        Iv:
        if (!array_key_exists("\163\x73\157\x5f\x62\x75\x74\164\x6f\x6e\x5f\154\157\147\151\156\137\146\x6f\x72\155\x5f\160\157\163\x69\164\151\x6f\156", $_POST)) {
            goto sD;
        }
        $hx = htmlspecialchars($_POST["\163\163\157\x5f\x62\x75\x74\x74\157\x6e\x5f\154\x6f\x67\151\156\137\146\157\162\155\137\x70\157\x73\x69\164\151\157\156"]);
        sD:
        update_option("\x6d\x6f\x5f\163\141\155\x6c\x5f\x62\165\164\x74\x6f\156\137\164\150\x65\x6d\x65", $c3);
        update_option("\155\x6f\137\x73\141\155\154\137\142\165\164\x74\x6f\156\x5f\x73\151\172\145", $ns);
        update_option("\155\157\137\163\x61\x6d\154\137\x62\x75\164\164\157\156\x5f\167\151\x64\x74\x68", $iK);
        update_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\142\x75\x74\164\157\156\137\150\x65\151\147\x68\x74", $LW);
        update_option("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\142\x75\164\x74\x6f\x6e\137\143\x75\162\x76\x65", $vZ);
        update_option("\x6d\x6f\x5f\x73\x61\155\154\x5f\142\165\164\x74\x6f\x6e\x5f\x63\157\154\157\162", $d4);
        update_option("\155\157\137\x73\141\155\x6c\x5f\x62\x75\x74\x74\157\x6e\137\x74\145\x78\164", $nM);
        update_option("\x6d\157\x5f\x73\x61\x6d\154\x5f\x66\157\x6e\164\x5f\x63\x6f\x6c\157\162", $Qu);
        update_option("\x6d\x6f\x5f\x73\141\x6d\154\x5f\x66\157\x6e\x74\x5f\163\x69\x7a\145", $AH);
        update_option("\x73\x73\157\x5f\142\x75\x74\x74\157\x6e\137\x6c\x6f\147\151\156\x5f\x66\x6f\x72\x6d\x5f\160\x6f\163\x69\x74\151\x6f\156", $hx);
        update_option("\x6d\157\x5f\x73\x61\155\x6c\x5f\x6d\145\163\163\141\147\145", "\123\x69\x67\156\x20\111\x6e\40\x73\x65\164\164\151\x6e\x67\x73\x20\165\x70\144\141\x74\x65\x64\x2e");
        $this->mo_saml_show_success_message();
        U7:
        goto U_;
        zB:
        $qa = "\146\x61\x6c\163\x65";
        if (array_key_exists("\x6d\157\137\x73\x61\x6d\x6c\137\x61\154\x6c\x6f\x77\x5f\167\160\137\x73\151\x67\156\151\156", $_POST)) {
            goto V3;
        }
        $nb = "\146\141\x6c\163\x65";
        goto jU;
        V3:
        $nb = htmlspecialchars($_POST["\x6d\157\x5f\x73\x61\x6d\154\137\x61\x6c\x6c\157\x77\137\x77\x70\137\163\x69\x67\x6e\151\x6e"]);
        jU:
        if ($nb == "\x74\162\165\x65") {
            goto In;
        }
        update_option("\x6d\157\x5f\163\x61\155\x6c\137\x61\154\154\157\167\137\167\160\137\x73\151\x67\x6e\151\156", '');
        goto SA;
        In:
        update_option("\155\x6f\137\163\x61\155\154\x5f\141\x6c\x6c\x6f\x77\137\x77\x70\x5f\163\151\147\156\x69\x6e", "\164\162\165\145");
        if (!array_key_exists("\x6d\x6f\137\163\x61\155\154\x5f\x62\141\x63\153\144\157\x6f\x72\x5f\x75\162\154", $_POST)) {
            goto Rt;
        }
        $qa = htmlspecialchars(trim($_POST["\155\x6f\137\x73\x61\155\x6c\137\x62\x61\x63\x6b\144\x6f\x6f\162\137\x75\x72\154"]));
        Rt:
        SA:
        update_option("\155\157\x5f\163\141\x6d\x6c\137\142\x61\x63\153\144\x6f\x6f\162\x5f\165\162\154", $qa);
        update_option("\155\x6f\x5f\163\141\155\154\x5f\155\x65\x73\163\141\147\x65", "\x53\151\147\x6e\40\111\x6e\x20\x73\x65\x74\164\x69\x6e\147\x73\40\165\x70\x64\141\x74\x65\144\x2e");
        $this->mo_saml_show_success_message();
        U_:
        goto LV;
        mv:
        if (mo_saml_is_sp_configured()) {
            goto rQ;
        }
        update_option("\155\157\137\x73\141\x6d\x6c\137\x6d\x65\163\x73\x61\147\145", "\120\x6c\145\x61\163\145\x20\x63\157\x6d\x70\154\x65\164\x65\40" . addLink("\x53\145\162\x76\151\143\145\x20\x50\x72\157\x76\x69\x64\145\x72", add_query_arg(array("\x74\x61\x62" => "\x73\141\166\x65"), $_SERVER["\x52\105\x51\125\105\x53\x54\x5f\x55\122\111"])) . "\40\143\x6f\156\146\151\x67\165\x72\141\x74\151\x6f\156\x20\x66\x69\x72\x73\x74\x2e");
        $this->mo_saml_show_error_message();
        goto ay;
        rQ:
        if (array_key_exists("\x6d\157\137\163\141\155\154\137\x75\163\145\x5f\142\x75\x74\164\157\x6e\x5f\x61\163\x5f\167\x69\144\147\145\x74", $_POST)) {
            goto ig;
        }
        $E1 = "\x66\141\x6c\163\145";
        goto kb;
        ig:
        $E1 = htmlspecialchars($_POST["\155\x6f\x5f\163\141\155\154\137\165\x73\145\x5f\142\165\164\x74\x6f\x6e\x5f\141\163\137\x77\x69\x64\147\x65\x74"]);
        kb:
        update_option("\x6d\157\x5f\163\x61\155\x6c\x5f\x75\x73\x65\x5f\x62\x75\x74\x74\157\156\x5f\141\163\137\167\151\x64\x67\145\x74", $E1);
        update_option("\155\x6f\x5f\163\141\x6d\154\x5f\x6d\x65\163\163\141\x67\145", "\x53\151\x67\156\40\x69\x6e\40\x6f\160\x74\151\157\156\x73\x20\x75\x70\144\x61\164\145\144\56");
        $this->mo_saml_show_success_message();
        ay:
        LV:
        goto nf;
        Qa:
        if (mo_saml_is_sp_configured()) {
            goto a1;
        }
        update_option("\155\157\137\163\x61\155\x6c\x5f\x6d\x65\163\163\141\147\x65", "\120\x6c\145\x61\163\x65\x20\143\157\x6d\x70\154\145\164\x65\40" . addLink("\x53\145\162\x76\x69\x63\145\40\120\162\157\x76\x69\144\x65\162", add_query_arg(array("\x74\141\142" => "\163\x61\166\x65"), $_SERVER["\x52\x45\121\125\105\123\x54\137\125\x52\111"])) . "\40\143\157\x6e\146\151\x67\x75\x72\x61\x74\x69\x6f\x6e\40\146\x69\x72\x73\x74\56");
        $this->mo_saml_show_error_message();
        goto Kr;
        a1:
        if (array_key_exists("\x6d\157\x5f\x73\x61\155\154\x5f\x75\x73\145\x5f\142\x75\164\x74\157\x6e\137\141\x73\137\163\150\x6f\x72\x74\143\x6f\144\x65", $_POST)) {
            goto PY;
        }
        $E1 = "\x66\141\154\163\145";
        goto ZO;
        PY:
        $E1 = htmlspecialchars($_POST["\x6d\x6f\x5f\163\141\x6d\x6c\137\x75\163\x65\x5f\142\165\x74\x74\x6f\156\137\x61\163\137\x73\150\157\162\164\x63\x6f\x64\x65"]);
        ZO:
        update_option("\x6d\x6f\137\x73\141\x6d\154\x5f\x75\163\x65\137\x62\x75\164\164\x6f\x6e\x5f\141\163\137\163\x68\157\x72\x74\x63\x6f\144\145", $E1);
        update_option("\155\x6f\137\163\x61\155\154\x5f\155\145\x73\x73\141\x67\x65", "\x53\x69\x67\x6e\40\151\x6e\40\157\x70\x74\151\x6f\x6e\x73\x20\165\160\144\141\164\x65\x64\56");
        $this->mo_saml_show_success_message();
        Kr:
        nf:
        goto mb;
        o7:
        if (mo_saml_is_sp_configured()) {
            goto Ch;
        }
        update_option("\x6d\157\137\163\141\x6d\x6c\x5f\x6d\x65\163\163\x61\x67\x65", "\120\x6c\x65\x61\163\x65\40\x63\157\155\160\x6c\x65\x74\x65\40" . addLink("\123\145\162\166\151\143\145\40\x50\162\157\166\x69\144\x65\x72", add_query_arg(array("\164\x61\x62" => "\x73\141\166\145"), $_SERVER["\122\x45\x51\125\x45\123\x54\137\125\122\111"])) . "\x20\143\x6f\x6e\x66\151\x67\x75\162\x61\x74\151\x6f\x6e\40\x66\x69\x72\x73\x74\x2e");
        $this->mo_saml_show_error_message();
        goto tn;
        Ch:
        if (array_key_exists("\x6d\157\137\x73\141\155\x6c\137\141\144\x64\x5f\163\163\x6f\x5f\142\x75\164\164\157\x6e\137\167\160", $_POST)) {
            goto ke;
        }
        $eV = "\x66\141\154\x73\x65";
        goto bl;
        ke:
        $eV = htmlspecialchars($_POST["\x6d\157\x5f\x73\141\155\154\137\x61\144\144\x5f\163\x73\x6f\x5f\142\165\164\x74\x6f\x6e\137\x77\160"]);
        bl:
        update_option("\x6d\157\x5f\163\141\x6d\154\x5f\x61\x64\144\137\x73\163\157\x5f\x62\165\164\164\157\156\137\167\160", $eV);
        update_option("\155\157\137\x73\x61\155\x6c\137\x6d\x65\x73\163\x61\x67\x65", "\123\x69\x67\156\40\151\x6e\x20\157\160\164\151\x6f\x6e\163\x20\165\160\144\x61\164\x65\144\x2e");
        $this->mo_saml_show_success_message();
        tn:
        mb:
        goto ri;
        eP:
        if (mo_saml_is_sp_configured()) {
            goto v3;
        }
        update_option("\x6d\157\x5f\x73\141\155\154\137\155\x65\x73\x73\141\x67\145", "\x50\x6c\x65\141\163\x65\x20\143\x6f\155\x70\154\145\164\145\40" . addLink("\123\x65\x72\x76\x69\x63\145\x20\x50\x72\157\166\x69\144\x65\162", add_query_arg(array("\164\141\142" => "\x73\x61\166\x65"), $_SERVER["\x52\x45\x51\x55\105\123\124\x5f\x55\122\x49"])) . "\40\x63\157\x6e\146\151\147\165\162\141\164\x69\x6f\156\40\x66\x69\x72\x73\164\x2e");
        $this->mo_saml_show_error_message();
        goto hp;
        v3:
        if (array_key_exists("\155\x6f\x5f\x73\x61\x6d\154\137\x65\x6e\x61\x62\x6c\x65\137\154\x6f\x67\151\156\x5f\162\145\x64\151\x72\x65\143\x74", $_POST)) {
            goto FH;
        }
        $AX = "\146\x61\154\163\145";
        goto ee;
        FH:
        $AX = htmlspecialchars($_POST["\x6d\157\x5f\x73\x61\x6d\154\137\x65\x6e\141\142\x6c\145\137\154\157\147\x69\x6e\137\x72\145\x64\151\162\x65\143\164"]);
        ee:
        if ($AX == "\164\x72\165\145") {
            goto XP;
        }
        update_option("\x6d\x6f\x5f\x73\141\155\x6c\137\x65\x6e\x61\142\154\145\x5f\154\157\x67\151\x6e\x5f\162\x65\x64\x69\162\145\x63\164", '');
        update_option("\155\x6f\137\163\141\155\x6c\x5f\141\154\154\157\167\x5f\x77\160\137\x73\151\x67\x6e\x69\156", '');
        goto QE;
        XP:
        update_option("\155\157\x5f\163\x61\x6d\x6c\137\x65\156\141\142\x6c\145\137\x6c\x6f\x67\151\156\x5f\162\x65\x64\151\x72\145\x63\x74", "\x74\162\165\145");
        update_option("\x6d\157\x5f\x73\x61\x6d\154\x5f\141\x6c\x6c\157\x77\137\x77\x70\137\x73\151\147\156\x69\156", "\164\x72\x75\x65");
        QE:
        update_option("\x6d\x6f\137\x73\x61\x6d\154\137\155\145\x73\x73\x61\147\145", "\x53\x69\147\156\40\x69\x6e\x20\157\160\x74\x69\157\x6e\x73\x20\165\160\144\141\x74\x65\x64\56");
        $this->mo_saml_show_success_message();
        hp:
        ri:
        goto jF;
        L2:
        if (mo_saml_is_sp_configured()) {
            goto QV;
        }
        update_option("\x6d\x6f\137\163\x61\x6d\x6c\x5f\x6d\x65\x73\x73\141\x67\145", "\120\x6c\145\141\x73\x65\40\143\157\155\x70\x6c\x65\164\145\x20" . addLink("\123\x65\162\x76\x69\143\145\x20\120\x72\157\166\x69\x64\x65\x72", add_query_arg(array("\164\x61\x62" => "\163\x61\166\x65"), $_SERVER["\x52\105\x51\x55\105\x53\124\x5f\x55\x52\111"])) . "\40\x63\157\156\146\151\147\165\x72\x61\x74\151\x6f\156\x20\x66\151\162\x73\x74\56");
        $this->mo_saml_show_error_message();
        goto oO;
        QV:
        if (array_key_exists("\x6d\157\x5f\x73\x61\x6d\154\x5f\145\156\x61\142\154\x65\x5f\x72\163\163\137\x61\143\x63\145\x73\163", $_POST)) {
            goto vL;
        }
        $Za = false;
        goto DW;
        vL:
        $Za = htmlspecialchars($_POST["\x6d\157\x5f\163\x61\x6d\154\x5f\145\156\141\142\x6c\145\x5f\x72\x73\163\137\141\143\143\x65\163\x73"]);
        DW:
        if ($Za == "\164\162\165\x65") {
            goto LO;
        }
        update_option("\155\x6f\137\x73\x61\155\154\x5f\145\x6e\x61\142\x6c\145\x5f\162\x73\x73\x5f\141\x63\x63\145\x73\163", '');
        goto s1;
        LO:
        update_option("\x6d\157\x5f\163\x61\x6d\154\137\x65\x6e\141\x62\154\x65\137\x72\x73\163\137\x61\x63\x63\x65\x73\x73", "\x74\x72\165\x65");
        s1:
        update_option("\155\x6f\137\163\141\155\x6c\137\155\x65\x73\163\141\147\x65", "\122\x53\x53\40\x46\145\x65\x64\x20\157\160\164\x69\157\156\40\x75\160\144\141\x74\x65\144\56");
        $this->mo_saml_show_success_message();
        oO:
        jF:
        goto yS;
        Rm:
        if (mo_saml_is_sp_configured()) {
            goto Zs;
        }
        update_option("\155\157\x5f\163\141\155\154\137\x6d\x65\163\163\x61\x67\145", "\x50\x6c\145\x61\x73\x65\40\x63\x6f\155\x70\x6c\x65\164\x65\40" . addLink("\123\x65\162\166\151\143\x65\40\x50\162\157\x76\151\x64\145\162", add_query_arg(array("\164\141\142" => "\x73\x61\166\x65"), $_SERVER["\x52\105\121\125\x45\x53\x54\x5f\x55\x52\x49"])) . "\40\143\x6f\156\146\x69\x67\165\x72\x61\x74\x69\157\x6e\x20\x66\x69\x72\163\164\56");
        $this->mo_saml_show_error_message();
        goto gp;
        Zs:
        if (array_key_exists("\155\157\x5f\163\x61\x6d\154\137\146\157\162\143\x65\137\141\165\164\150\x65\156\164\x69\143\x61\x74\151\x6f\x6e", $_POST)) {
            goto hC;
        }
        $AX = "\x66\x61\154\x73\x65";
        goto kN;
        hC:
        $AX = htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\154\137\146\157\x72\143\x65\137\x61\165\x74\x68\x65\x6e\x74\151\x63\x61\164\x69\x6f\156"]);
        kN:
        if ($AX == "\164\162\165\145") {
            goto fE;
        }
        update_option("\155\x6f\137\163\x61\155\x6c\x5f\x66\157\162\143\145\x5f\141\165\x74\150\145\156\164\151\x63\x61\x74\x69\157\x6e", '');
        goto ps;
        fE:
        update_option("\x6d\x6f\x5f\x73\141\155\x6c\137\x66\157\162\143\145\x5f\x61\x75\164\x68\x65\156\164\x69\x63\x61\164\x69\157\156", "\x74\x72\165\145");
        ps:
        update_option("\x6d\157\137\163\x61\x6d\x6c\137\x6d\x65\163\163\x61\x67\x65", "\x53\x69\x67\x6e\x20\151\156\40\157\x70\164\x69\157\x6e\163\x20\x75\160\144\x61\x74\x65\x64\x2e");
        $this->mo_saml_show_success_message();
        gp:
        yS:
        goto Gf;
        hT:
        if (!mo_saml_is_sp_configured()) {
            goto Ba;
        }
        if (array_key_exists("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\162\x65\x64\151\x72\x65\143\x74\137\164\157\137\x77\x70\x5f\154\x6f\147\151\156", $_POST)) {
            goto w1;
        }
        $uf = "\x66\x61\x6c\163\x65";
        goto Fa;
        w1:
        $uf = htmlspecialchars($_POST["\x6d\157\x5f\163\141\155\x6c\x5f\162\x65\144\151\x72\145\x63\x74\x5f\164\157\137\167\x70\137\154\x6f\x67\x69\x6e"]);
        Fa:
        update_option("\155\x6f\137\163\141\x6d\154\137\162\x65\144\x69\162\x65\x63\x74\137\x74\157\x5f\167\160\x5f\154\157\x67\x69\156", $uf);
        update_option("\x6d\x6f\137\x73\x61\155\154\137\x6d\x65\x73\x73\x61\147\145", "\123\151\147\156\x20\151\156\40\157\160\x74\x69\x6f\156\163\40\x75\160\x64\x61\164\x65\x64\56");
        $this->mo_saml_show_success_message();
        Ba:
        Gf:
        goto kL;
        i1:
        if (mo_saml_is_sp_configured()) {
            goto ZW;
        }
        update_option("\x6d\x6f\x5f\163\141\155\154\137\155\x65\x73\x73\141\147\x65", "\x50\x6c\145\141\163\145\x20\143\x6f\x6d\160\154\x65\x74\145\x20" . addLink("\x53\145\x72\166\x69\x63\x65\40\120\162\x6f\x76\151\144\x65\162", add_query_arg(array("\164\x61\142" => "\x73\141\166\x65"), $_SERVER["\x52\x45\121\125\105\123\x54\x5f\x55\122\x49"])) . "\x20\x63\157\x6e\x66\x69\x67\165\162\x61\x74\x69\157\156\x20\146\151\x72\x73\x74\x2e");
        $this->mo_saml_show_error_message();
        goto Hh;
        ZW:
        if (array_key_exists("\x6d\157\x5f\163\x61\x6d\x6c\137\x72\145\x67\151\163\x74\x65\x72\x65\x64\x5f\x6f\156\x6c\x79\137\x61\x63\x63\145\x73\163", $_POST)) {
            goto X3;
        }
        $AX = "\x66\141\154\163\145";
        goto Ns;
        X3:
        $AX = htmlspecialchars($_POST["\155\x6f\137\163\141\x6d\154\x5f\x72\x65\x67\151\163\164\x65\162\x65\x64\137\157\x6e\154\x79\137\x61\143\x63\145\163\163"]);
        Ns:
        if ($AX == "\164\162\x75\145") {
            goto xM;
        }
        update_option("\x6d\x6f\137\x73\141\155\x6c\137\162\145\x67\x69\x73\x74\x65\x72\x65\144\137\x6f\156\x6c\171\137\141\x63\x63\x65\163\163", '');
        goto N1;
        xM:
        update_option("\x6d\157\x5f\163\141\155\154\137\162\145\147\151\163\x74\145\162\145\x64\137\x6f\156\154\x79\x5f\141\x63\x63\145\x73\x73", "\164\162\165\145");
        N1:
        update_option("\155\157\137\163\141\155\x6c\x5f\x6d\145\x73\x73\x61\147\x65", "\x53\151\147\156\40\x69\156\x20\x6f\160\x74\x69\x6f\x6e\x73\40\x75\160\x64\141\164\145\x64\56");
        $this->mo_saml_show_success_message();
        Hh:
        kL:
        goto PC;
        KS:
        if (mo_saml_is_extension_installed("\x63\x75\162\x6c")) {
            goto ir;
        }
        update_option("\x6d\157\137\x73\x61\155\x6c\x5f\x6d\145\163\163\x61\x67\145", "\x45\122\122\117\x52\72\40\120\110\120\x20\x63\125\x52\x4c\x20\145\170\x74\x65\156\163\x69\x6f\x6e\40\151\x73\x20\x6e\x6f\164\40\x69\156\x73\x74\x61\x6c\x6c\145\144\40\x6f\162\40\144\x69\x73\x61\142\154\x65\144\56\x20\122\x65\163\145\x6e\x64\40\x4f\124\x50\x20\x66\141\151\x6c\x65\144\56");
        $this->mo_saml_show_error_message();
        return;
        ir:
        $mz = sanitize_text_field($_POST["\x70\x68\x6f\x6e\145"]);
        $mz = str_replace("\40", '', $mz);
        $mz = str_replace("\x2d", '', $mz);
        update_option("\155\157\x5f\x73\141\x6d\x6c\137\141\x64\155\151\156\x5f\160\x68\157\156\145", $mz);
        $V4 = new CustomerSaml();
        $t2 = $V4->send_otp_token('', $mz, FALSE, TRUE);
        if ($t2) {
            goto gA;
        }
        return;
        gA:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\x74\141\x74\x75\163"], "\123\x55\x43\x43\x45\123\123") == 0) {
            goto Zf;
        }
        update_option("\155\157\x5f\163\141\x6d\154\x5f\x6d\145\x73\x73\x61\147\x65", "\x54\x68\x65\x72\145\40\x77\141\163\x20\x61\156\x20\145\162\x72\157\162\x20\151\x6e\x20\163\x65\x6e\x64\x69\156\147\x20\x53\115\x53\x2e\x20\x50\x6c\x65\x61\x73\x65\x20\143\154\151\143\153\40\157\156\40\x52\x65\163\x65\x6e\144\40\x4f\124\120\x20\x74\x6f\x20\164\x72\171\x20\x61\147\141\x69\x6e\x2e");
        update_option("\x6d\x6f\x5f\x73\x61\155\154\x5f\x72\145\x67\x69\x73\164\x72\x61\x74\x69\x6f\x6e\x5f\x73\x74\x61\x74\x75\x73", "\115\x4f\137\117\x54\x50\137\104\105\x4c\x49\x56\x45\122\x45\x44\137\106\x41\x49\x4c\125\x52\105\137\120\x48\x4f\x4e\x45");
        $this->mo_saml_show_error_message();
        goto vq;
        Zf:
        update_option("\155\157\x5f\x73\x61\x6d\x6c\x5f\155\x65\x73\x73\141\x67\x65", "\x20\x41\40\157\156\145\40\x74\151\x6d\145\40\x70\141\x73\x73\x63\157\x64\x65\x20\151\163\40\163\145\x6e\x74\x20\x74\157\x20" . get_option("\155\x6f\137\163\x61\x6d\x6c\137\x61\144\155\151\x6e\x5f\160\150\x6f\156\x65") . "\56\40\120\154\145\141\163\x65\x20\145\156\x74\145\162\40\164\x68\x65\x20\x6f\x74\160\40\150\145\162\x65\x20\164\x6f\40\166\145\162\151\146\x79\40\171\x6f\165\x72\x20\145\155\x61\151\x6c\x2e");
        update_option("\x6d\x6f\137\163\141\155\154\137\x74\x72\141\x6e\x73\141\143\164\x69\x6f\x6e\x49\144", $t2["\164\170\111\144"]);
        update_option("\x6d\157\x5f\163\x61\x6d\x6c\137\162\x65\x67\x69\x73\x74\162\141\x74\151\x6f\x6e\137\163\x74\x61\164\165\163", "\115\x4f\x5f\x4f\x54\120\137\x44\105\114\x49\126\x45\122\x45\104\x5f\x53\x55\103\x43\x45\x53\x53\x5f\x50\x48\117\x4e\105");
        $this->mo_saml_show_success_message();
        vq:
        PC:
        goto XY;
        ns:
        update_option("\x6d\157\x5f\x73\141\155\x6c\137\162\x65\147\151\x73\164\162\141\164\151\157\156\137\x73\x74\x61\164\x75\163", '');
        update_option("\x6d\157\137\163\x61\x6d\x6c\x5f\x76\x65\x72\x69\x66\171\137\143\165\163\164\x6f\155\145\x72", '');
        delete_option("\x6d\157\137\x73\141\155\x6c\x5f\156\x65\167\x5f\x72\145\147\x69\163\x74\x72\141\x74\x69\157\156");
        delete_option("\155\x6f\x5f\163\x61\155\x6c\137\x61\x64\x6d\x69\156\137\145\x6d\x61\x69\154");
        delete_option("\155\157\x5f\163\x61\155\x6c\137\x61\x64\x6d\x69\156\137\160\x68\x6f\x6e\x65");
        delete_site_option("\x73\155\154\x5f\x6c\153");
        delete_site_option("\x74\x5f\163\151\164\145\x5f\x73\x74\141\164\x75\x73");
        delete_site_option("\x73\x69\164\145\x5f\143\153\137\x6c");
        XY:
        goto He;
        XZ:
        if (mo_saml_is_extension_installed("\143\x75\x72\x6c")) {
            goto sU;
        }
        update_option("\155\157\137\x73\x61\x6d\x6c\x5f\155\145\x73\163\141\147\145", "\105\x52\x52\117\122\x3a\x20\x50\x48\x50\x20\x63\125\x52\114\x20\145\170\164\x65\156\x73\x69\157\x6e\x20\151\163\x20\x6e\x6f\164\40\x69\156\x73\x74\141\154\154\145\x64\x20\x6f\x72\x20\x64\151\163\141\142\154\x65\x64\56\x20\x52\x65\x73\x65\156\144\x20\117\124\x50\40\x66\141\x69\x6c\145\144\56");
        $this->mo_saml_show_error_message();
        return;
        sU:
        $mz = get_option("\155\x6f\137\x73\141\x6d\154\x5f\141\x64\x6d\x69\x6e\x5f\x70\x68\x6f\156\x65");
        $V4 = new CustomerSaml();
        $t2 = $V4->send_otp_token('', $mz, FALSE, TRUE);
        if ($t2) {
            goto tm;
        }
        return;
        tm:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\164\141\x74\x75\163"], "\123\125\103\103\105\x53\123") == 0) {
            goto mC;
        }
        update_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\155\145\x73\163\x61\x67\145", "\x54\150\145\162\145\x20\167\x61\163\40\x61\156\40\145\x72\x72\157\x72\40\151\156\40\x73\x65\x6e\x64\x69\x6e\147\40\145\x6d\x61\x69\154\56\40\x50\x6c\x65\141\163\145\x20\x63\x6c\x69\143\153\40\x6f\156\40\122\145\x73\145\x6e\x64\x20\117\x54\120\x20\164\x6f\x20\x74\x72\171\40\141\147\x61\151\x6e\56");
        update_option("\155\x6f\137\x73\141\x6d\154\137\162\x65\x67\151\163\164\162\141\164\151\157\156\x5f\163\164\x61\x74\x75\163", "\115\x4f\x5f\117\x54\120\x5f\104\x45\114\111\x56\x45\122\x45\x44\137\106\101\x49\114\x55\x52\x45\x5f\x50\x48\x4f\116\x45");
        $this->mo_saml_show_error_message();
        goto LT;
        mC:
        update_option("\x6d\x6f\x5f\163\141\155\154\x5f\155\x65\x73\x73\x61\147\145", "\40\101\40\157\156\145\x20\164\151\x6d\x65\40\160\141\x73\x73\143\x6f\144\145\40\x69\163\x20\163\145\156\x74\40\x74\157\40" . $mz . "\40\x61\147\141\151\x6e\x2e\x20\120\x6c\x65\x61\x73\145\40\143\x68\x65\143\153\40\x69\146\40\x79\157\x75\x20\147\157\164\x20\164\150\x65\40\x6f\164\160\40\141\156\144\x20\x65\156\x74\145\x72\40\151\x74\40\150\x65\162\145\56");
        update_option("\155\157\137\x73\x61\155\x6c\137\x74\162\141\156\x73\141\x63\x74\x69\157\156\111\x64", $t2["\164\170\111\x64"]);
        update_option("\x6d\x6f\137\163\x61\155\x6c\x5f\162\x65\147\151\x73\164\162\141\x74\x69\157\x6e\x5f\x73\x74\x61\x74\165\x73", "\115\x4f\137\x4f\x54\120\x5f\104\x45\x4c\x49\x56\105\122\x45\104\x5f\x53\125\103\103\x45\123\x53\137\x50\x48\117\116\105");
        $this->mo_saml_show_success_message();
        LT:
        He:
        goto fY;
        xu:
        if (mo_saml_is_extension_installed("\x63\x75\x72\154")) {
            goto u_;
        }
        update_option("\x6d\x6f\x5f\x73\141\155\x6c\137\x6d\145\x73\163\141\x67\x65", "\x45\x52\122\x4f\x52\x3a\40\120\x48\x50\x20\143\125\122\x4c\x20\145\x78\x74\145\156\x73\x69\x6f\x6e\x20\x69\163\40\x6e\x6f\x74\40\x69\x6e\x73\x74\x61\154\x6c\x65\144\x20\x6f\162\x20\144\151\x73\x61\142\x6c\145\x64\x2e\x20\x52\145\x73\145\x6e\144\x20\117\x54\x50\x20\x66\x61\x69\x6c\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        u_:
        $oz = get_option("\x6d\x6f\137\163\141\x6d\154\x5f\x61\144\x6d\151\156\x5f\145\155\x61\151\x6c");
        $V4 = new CustomerSaml();
        $t2 = $V4->send_otp_token($oz, '');
        if ($t2) {
            goto x2;
        }
        return;
        x2:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\163\x74\x61\164\165\x73"], "\123\x55\103\103\105\123\123") == 0) {
            goto sG;
        }
        update_option("\155\157\137\163\x61\x6d\154\x5f\x6d\145\163\163\x61\x67\x65", "\x54\x68\x65\162\x65\40\167\x61\163\40\x61\156\40\x65\x72\162\x6f\162\x20\151\156\x20\163\x65\x6e\144\151\x6e\x67\x20\145\x6d\141\151\154\x2e\40\x50\154\x65\141\x73\x65\x20\143\154\151\x63\x6b\40\157\156\x20\x52\x65\163\x65\156\x64\40\117\x54\x50\40\164\x6f\x20\x74\x72\x79\40\x61\147\x61\151\x6e\x2e");
        update_option("\x6d\157\137\x73\141\x6d\x6c\137\162\x65\x67\151\x73\164\162\x61\164\x69\x6f\x6e\x5f\x73\164\141\164\165\x73", "\115\117\x5f\117\124\120\137\104\x45\x4c\x49\x56\x45\x52\105\x44\137\x46\x41\111\x4c\125\x52\x45\137\x45\x4d\101\111\114");
        $this->mo_saml_show_error_message();
        goto No;
        sG:
        update_option("\155\157\137\x73\141\155\x6c\137\x6d\x65\x73\x73\141\147\145", "\x20\x41\x20\157\x6e\x65\40\164\151\x6d\145\40\x70\x61\163\x73\x63\x6f\144\145\x20\151\x73\x20\x73\145\156\164\x20\x74\x6f\x20" . get_option("\x6d\157\x5f\163\x61\155\154\x5f\x61\144\155\151\156\137\x65\x6d\x61\151\154") . "\x20\141\147\x61\151\x6e\x2e\x20\x50\x6c\x65\141\163\145\x20\143\150\x65\143\153\x20\x69\x66\x20\x79\157\165\x20\147\x6f\x74\x20\x74\150\145\x20\157\164\160\x20\141\x6e\144\x20\145\156\x74\x65\162\x20\151\164\x20\x68\x65\162\145\x2e");
        update_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\x74\162\x61\156\163\141\143\164\x69\157\156\111\x64", $t2["\x74\170\111\144"]);
        update_option("\x6d\x6f\x5f\163\x61\155\154\137\162\x65\147\x69\x73\x74\162\141\164\x69\157\156\x5f\163\164\x61\164\x75\x73", "\x4d\117\137\117\124\x50\137\104\x45\x4c\111\126\105\x52\105\x44\137\123\x55\103\103\x45\123\123\137\105\x4d\x41\111\114");
        $this->mo_saml_show_success_message();
        No:
        fY:
        goto WU;
        a8:
        if (mo_saml_is_extension_installed("\143\165\x72\154")) {
            goto QM;
        }
        update_option("\155\157\137\x73\141\155\154\137\x6d\x65\x73\x73\141\x67\145", "\105\x52\x52\x4f\x52\x3a\40\x50\x48\x50\x20\x63\x55\x52\114\40\x65\x78\x74\145\156\x73\x69\157\x6e\x20\x69\163\x20\156\157\164\x20\x69\156\163\x74\141\x6c\154\145\144\x20\157\x72\40\x64\x69\x73\x61\x62\x6c\145\x64\56\40\x51\165\145\162\x79\x20\163\x75\x62\155\151\x74\40\x66\x61\151\x6c\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        QM:
        $oz = sanitize_email($_POST["\155\157\137\163\141\155\x6c\137\x63\x6f\156\164\x61\143\x74\137\165\x73\x5f\145\155\x61\x69\x6c"]);
        $mz = htmlspecialchars($_POST["\155\157\x5f\163\141\x6d\x6c\x5f\143\157\x6e\164\x61\143\164\137\165\163\137\x70\150\157\156\x65"]);
        $C8 = htmlspecialchars($_POST["\x6d\x6f\137\x73\141\155\x6c\137\143\x6f\x6e\x74\x61\x63\164\x5f\x75\163\x5f\161\x75\x65\162\171"]);
        if (array_key_exists("\163\x65\x6e\144\x5f\x70\x6c\x75\x67\x69\x6e\137\143\x6f\156\146\x69\147", $_POST) === true) {
            goto vl;
        }
        update_option("\x73\145\156\144\137\x70\x6c\165\147\x69\x6e\x5f\x63\x6f\x6e\x66\151\x67", "\157\x66\146");
        goto hg;
        vl:
        $o6 = miniorange_import_export(true, true);
        $C8 .= $o6;
        delete_option("\163\x65\156\x64\x5f\x70\x6c\x75\x67\151\x6e\x5f\x63\157\x6e\x66\151\x67");
        hg:
        $V4 = new CustomerSaml();
        if ($this->mo_saml_check_empty_or_null($oz) || $this->mo_saml_check_empty_or_null($C8)) {
            goto tZ;
        }
        if (!filter_var($oz, FILTER_VALIDATE_EMAIL)) {
            goto bZ;
        }
        $Dg = $V4->submit_contact_us($oz, $mz, $C8);
        if ($Dg) {
            goto vf;
        }
        return;
        vf:
        update_option("\155\157\x5f\163\x61\155\154\x5f\155\145\x73\163\x61\147\145", "\124\150\x61\156\153\163\40\x66\x6f\x72\x20\x67\x65\164\164\151\156\x67\40\x69\156\40\164\x6f\x75\143\150\41\x20\x57\145\40\x73\x68\x61\x6c\154\x20\x67\x65\164\40\x62\141\x63\153\40\x74\157\40\171\157\165\x20\x73\150\x6f\x72\x74\x6c\171\x2e");
        $this->mo_saml_show_success_message();
        goto yP;
        bZ:
        update_option("\x6d\x6f\x5f\163\x61\155\x6c\x5f\x6d\x65\x73\x73\141\147\145", "\x50\154\145\x61\163\145\x20\x65\x6e\x74\145\x72\40\x61\40\166\141\x6c\x69\x64\x20\x65\x6d\x61\x69\154\40\141\144\144\x72\145\163\163\x2e");
        $this->mo_saml_show_error_message();
        return;
        yP:
        goto aC;
        tZ:
        update_option("\155\157\137\x73\x61\x6d\x6c\137\x6d\145\163\163\141\147\145", "\x50\154\x65\141\x73\145\x20\x66\151\154\154\x20\x75\x70\x20\105\x6d\x61\x69\154\x20\x61\x6e\144\40\x51\165\x65\162\171\x20\146\151\145\154\x64\x73\x20\164\157\40\163\165\x62\155\x69\x74\40\171\157\165\162\x20\161\165\145\162\x79\56");
        $this->mo_saml_show_error_message();
        aC:
        WU:
        goto on;
        nl:
        if (mo_saml_is_extension_installed("\143\x75\x72\x6c")) {
            goto gf;
        }
        update_option("\x6d\x6f\137\163\x61\x6d\x6c\x5f\x6d\145\163\x73\141\x67\145", "\x45\122\x52\117\122\x3a\x20\120\x48\120\x20\x63\x55\122\x4c\x20\145\170\x74\145\x6e\x73\x69\x6f\156\40\x69\163\40\156\157\164\40\151\156\163\164\x61\154\154\x65\x64\x20\x6f\x72\40\x64\151\163\x61\142\x6c\x65\x64\56\x20\114\x6f\x67\151\x6e\x20\146\x61\151\154\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        gf:
        $oz = '';
        $U1 = self::get_empty_strings();
        if ($this->mo_saml_check_empty_or_null($_POST["\145\155\141\151\154"]) || $this->mo_saml_check_empty_or_null($_POST["\x70\141\x73\x73\167\157\162\x64"])) {
            goto qx;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\160\141\163\163\x77\x6f\162\144"]))) {
            goto BN;
        }
        $oz = sanitize_email($_POST["\x65\x6d\141\x69\x6c"]);
        $U1 = stripslashes(strip_tags($_POST["\160\x61\163\x73\167\157\x72\x64"]));
        goto nd;
        BN:
        update_option("\155\157\x5f\x73\x61\x6d\x6c\137\155\x65\163\x73\x61\147\145", "\115\x69\156\x69\x6d\x75\x6d\40\x36\40\x63\150\x61\x72\141\x63\x74\145\x72\163\40\163\150\x6f\165\x6c\144\x20\142\145\40\x70\x72\145\x73\145\x6e\164\x2e\40\x4d\141\x78\x69\155\165\155\x20\x31\x35\40\143\x68\x61\162\141\143\x74\x65\162\x73\x20\163\x68\157\x75\154\x64\x20\x62\145\40\160\162\x65\163\x65\156\164\x2e\40\117\x6e\x6c\x79\40\146\157\x6c\154\157\167\151\x6e\147\x20\163\171\155\142\x6f\x6c\x73\x20\x28\41\x40\x23\56\44\45\x5e\x26\x2a\55\x5f\x29\40\x73\x68\157\165\154\x64\40\142\x65\x20\160\x72\145\163\145\x6e\164\56");
        $this->mo_saml_show_error_message();
        return;
        nd:
        goto xs;
        qx:
        update_option("\155\x6f\x5f\163\x61\155\x6c\137\x6d\x65\163\x73\x61\147\145", "\x41\154\x6c\40\x74\150\x65\x20\146\x69\145\154\144\163\40\141\162\145\40\162\145\161\165\x69\x72\145\144\x2e\x20\x50\x6c\145\x61\x73\145\x20\x65\156\164\x65\162\x20\166\x61\154\x69\x64\40\145\x6e\164\162\151\x65\x73\x2e");
        $this->mo_saml_show_error_message();
        return;
        xs:
        update_option("\x6d\x6f\x5f\163\141\x6d\154\137\141\144\x6d\x69\x6e\x5f\145\155\x61\151\x6c", $oz);
        update_option("\x6d\157\x5f\163\141\x6d\154\137\141\144\x6d\151\156\x5f\x70\x61\x73\x73\x77\157\x72\x64", $U1);
        $V4 = new Customersaml();
        $t2 = $V4->get_customer_key();
        if ($t2) {
            goto m0;
        }
        return;
        m0:
        $CQ = json_decode($t2, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto dy;
        }
        update_option("\155\x6f\137\x73\141\155\154\137\x6d\x65\163\163\x61\147\x65", "\x49\x6e\166\x61\x6c\151\144\x20\165\163\x65\x72\156\x61\x6d\x65\x20\x6f\162\x20\x70\x61\163\x73\x77\x6f\162\x64\56\40\x50\154\x65\x61\163\145\x20\x74\x72\x79\x20\x61\147\141\151\156\x2e");
        $this->mo_saml_show_error_message();
        goto Qt;
        dy:
        update_option("\x6d\157\137\x73\141\155\154\137\141\x64\x6d\x69\156\137\143\x75\x73\x74\x6f\x6d\x65\x72\x5f\x6b\145\x79", $CQ["\151\144"]);
        update_option("\x6d\157\137\163\141\x6d\154\x5f\141\144\x6d\151\x6e\137\141\x70\x69\137\x6b\145\x79", $CQ["\141\160\151\113\x65\171"]);
        update_option("\x6d\x6f\x5f\x73\141\x6d\154\137\143\165\163\x74\157\x6d\x65\x72\x5f\x74\x6f\x6b\x65\x6e", $CQ["\x74\157\x6b\x65\x6e"]);
        if (empty($CQ["\x70\x68\157\x6e\x65"])) {
            goto Oz;
        }
        update_option("\155\x6f\137\163\x61\x6d\x6c\x5f\141\x64\x6d\151\x6e\x5f\160\x68\x6f\156\145", $CQ["\160\150\157\x6e\145"]);
        Oz:
        update_option("\155\x6f\137\163\x61\x6d\x6c\x5f\x61\x64\x6d\x69\156\137\x70\141\x73\x73\167\x6f\162\144", '');
        update_option("\155\157\x5f\163\141\x6d\154\137\x6d\x65\163\163\x61\147\x65", "\103\165\x73\164\157\x6d\x65\x72\40\162\145\164\x72\151\x65\x76\x65\x64\x20\163\165\x63\143\145\163\x73\x66\x75\154\x6c\x79");
        update_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\x72\145\147\x69\163\x74\162\141\x74\151\157\x6e\137\x73\x74\x61\164\x75\163", "\105\x78\151\163\x74\151\x6e\147\x20\125\163\x65\x72");
        delete_option("\x6d\157\137\163\x61\x6d\x6c\x5f\166\145\162\x69\x66\x79\137\143\165\163\x74\157\155\x65\162");
        if (get_option("\x73\x6d\154\137\x6c\153")) {
            goto UK;
        }
        $this->mo_saml_show_success_message();
        goto Sm;
        UK:
        $Kn = get_option("\x6d\157\x5f\x73\x61\155\154\137\x63\165\163\164\x6f\x6d\145\x72\137\164\x6f\x6b\x65\156");
        $ug = AESEncryption::decrypt_data(get_option("\163\155\x6c\137\x6c\x6b"), $Kn);
        $t2 = json_decode($V4->mo_saml_vl($ug, false), true);
        update_option("\166\x6c\137\x63\150\x65\x63\153\137\164", time());
        if (strcasecmp($t2["\x73\164\x61\164\x75\163"], "\x53\125\103\103\x45\123\x53") == 0) {
            goto PJ;
        }
        update_option("\x6d\157\x5f\x73\141\155\154\137\155\x65\x73\163\x61\147\145", "\x4c\151\143\x65\156\x73\x65\x20\153\x65\x79\x20\146\157\162\x20\164\150\151\163\40\151\156\x73\164\141\x6e\x63\145\40\x69\x73\40\151\x6e\x63\x6f\162\x72\145\x63\x74\56\40\x4d\141\x6b\x65\40\x73\x75\x72\x65\x20\171\x6f\165\x20\150\141\166\x65\x20\x6e\x6f\x74\40\x74\141\x6d\160\x65\x72\x65\144\40\167\151\164\x68\x20\151\164\40\141\x74\x20\x61\154\154\56\40\120\154\x65\141\x73\145\x20\x65\156\164\x65\162\40\141\40\x76\x61\x6c\x69\144\x20\x6c\151\143\145\156\163\145\x20\153\x65\x79\56");
        delete_option("\163\155\x6c\137\x6c\153");
        $this->mo_saml_show_error_message();
        goto Y6;
        PJ:
        $zj = plugin_dir_path(__FILE__);
        $eE = home_url();
        $eE = trim($eE, "\57");
        if (preg_match("\x23\136\150\x74\164\160\x28\x73\51\x3f\72\x2f\x2f\x23", $eE)) {
            goto Ab;
        }
        $eE = "\x68\164\164\x70\72\x2f\57" . $eE;
        Ab:
        $OQ = parse_url($eE);
        $dx = preg_replace("\57\x5e\167\167\167\x5c\x2e\57", '', $OQ["\150\157\x73\164"]);
        $MX = wp_upload_dir();
        $cW = $dx . "\x2d" . $MX["\x62\141\163\145\x64\151\162"];
        $NZ = hash_hmac("\163\150\141\62\x35\x36", $cW, "\x34\x44\x48\146\152\x67\x66\x6a\x61\x73\x6e\x64\146\163\x61\152\146\x48\107\112");
        $D4 = $this->djkasjdksa();
        $Ju = round(strlen($D4) / rand(2, 20));
        $D4 = substr_replace($D4, $NZ, $Ju, 0);
        $rX = base64_decode($D4);
        if (is_writable($zj . "\x6c\151\143\145\156\x73\x65")) {
            goto CH;
        }
        $D4 = str_rot13($D4);
        $yy = base64_decode("\142\x47\116\x6b\x61\x6d\x74\150\x63\x32\x70\153\x61\63\x4e\x68\131\62\x77\x3d");
        update_option($yy, $D4);
        goto y3;
        CH:
        file_put_contents($zj . "\154\x69\143\x65\156\x73\x65", $rX);
        y3:
        update_option("\x6c\143\x77\x72\x74\x6c\x66\x73\x61\155\x6c", true);
        $this->mo_saml_show_success_message();
        Y6:
        Sm:
        Qt:
        update_option("\x6d\157\137\x73\x61\x6d\154\137\x61\144\155\x69\156\x5f\160\x61\x73\163\167\157\x72\x64", '');
        on:
        goto hH;
        O2:
        if (mo_saml_is_extension_installed("\x63\165\x72\x6c")) {
            goto iY;
        }
        update_option("\155\x6f\137\x73\141\155\154\x5f\x6d\x65\163\163\x61\x67\145", "\105\x52\x52\117\122\x3a\x20\x50\110\120\40\143\x55\x52\x4c\x20\145\170\x74\x65\156\x73\151\x6f\156\x20\x69\x73\40\x6e\x6f\164\x20\151\156\163\164\141\154\x6c\145\x64\40\157\x72\40\144\151\x73\141\142\154\145\144\56\x20\x56\x61\154\151\144\141\164\x65\x20\117\124\120\x20\146\x61\x69\154\145\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        iY:
        $Qg = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\x6f\164\x70\x5f\164\157\x6b\x65\156"])) {
            goto qB;
        }
        $Qg = sanitize_text_field($_POST["\x6f\x74\x70\x5f\x74\x6f\153\x65\156"]);
        goto Ny;
        qB:
        update_option("\155\157\137\x73\141\155\154\x5f\x6d\x65\x73\x73\x61\x67\145", "\120\154\x65\x61\x73\145\x20\x65\x6e\164\145\x72\x20\141\x20\x76\141\x6c\x75\x65\x20\151\x6e\40\157\164\x70\x20\146\x69\x65\154\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        Ny:
        $V4 = new CustomerSaml();
        $t2 = $V4->validate_otp_token(get_option("\x6d\x6f\x5f\x73\141\x6d\x6c\137\164\x72\141\x6e\x73\x61\x63\x74\151\157\156\x49\144"), $Qg);
        if ($t2) {
            goto UV;
        }
        return;
        UV:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\x74\x61\164\165\163"], "\x53\x55\x43\x43\x45\x53\x53") == 0) {
            goto Hv;
        }
        update_option("\x6d\157\137\x73\x61\155\154\x5f\155\145\163\x73\141\x67\145", "\111\x6e\x76\x61\x6c\151\144\40\157\156\x65\40\164\151\155\145\40\x70\141\x73\x73\x63\x6f\144\x65\x2e\40\120\154\145\x61\x73\x65\x20\x65\156\x74\145\x72\40\141\x20\166\141\154\151\144\40\x6f\164\160\56");
        $this->mo_saml_show_error_message();
        goto Ms;
        Hv:
        $this->create_customer();
        Ms:
        hH:
        goto Q1;
        Mt:
        if (mo_saml_is_extension_installed("\143\x75\162\x6c")) {
            goto ba;
        }
        update_option("\x6d\157\x5f\x73\141\x6d\154\137\x6d\x65\x73\163\x61\x67\145", "\105\122\122\117\x52\72\x20\120\x48\x50\40\x63\125\x52\114\x20\145\x78\x74\145\x6e\x73\x69\x6f\x6e\40\x69\x73\40\x6e\x6f\164\40\x69\x6e\x73\164\x61\x6c\154\145\144\x20\157\x72\40\x64\151\163\141\142\154\x65\144\56\x20\x52\x65\147\151\x73\x74\x72\141\164\x69\157\156\40\146\x61\x69\154\145\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        ba:
        $oz = '';
        $mz = '';
        $U1 = self::get_empty_strings();
        $b2 = self::get_empty_strings();
        if ($this->mo_saml_check_empty_or_null($_POST["\x65\x6d\141\151\x6c"]) || $this->mo_saml_check_empty_or_null($_POST["\x70\141\163\x73\x77\x6f\x72\144"]) || $this->mo_saml_check_empty_or_null($_POST["\x63\x6f\x6e\x66\151\162\155\x50\141\x73\163\167\157\162\x64"])) {
            goto rF;
        }
        if (strlen($_POST["\160\x61\x73\x73\x77\x6f\x72\144"]) < 6 || strlen($_POST["\x63\x6f\x6e\x66\151\162\x6d\120\x61\x73\163\x77\x6f\x72\x64"]) < 6) {
            goto PN;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\160\x61\x73\x73\167\157\x72\144"]))) {
            goto Jd;
        }
        $oz = sanitize_email($_POST["\145\x6d\x61\151\x6c"]);
        if (!isset($_POST["\x70\150\157\x6e\x65"])) {
            goto uc;
        }
        $mz = sanitize_text_field($_POST["\160\x68\x6f\x6e\145"]);
        uc:
        $U1 = stripslashes(strip_tags($_POST["\x70\141\x73\163\x77\x6f\162\144"]));
        $b2 = stripslashes(strip_tags($_POST["\x63\x6f\156\x66\x69\x72\155\120\x61\163\163\x77\x6f\x72\x64"]));
        goto ng;
        Jd:
        update_option("\155\x6f\137\x73\141\x6d\x6c\x5f\155\x65\x73\163\x61\x67\145", "\115\151\x6e\x69\155\x75\x6d\40\x36\x20\143\x68\141\162\x61\143\x74\145\x72\163\x20\163\150\157\165\154\x64\x20\142\145\x20\160\x72\145\163\x65\x6e\164\x2e\40\x4d\x61\170\x69\x6d\165\155\40\x31\x35\40\143\x68\x61\162\141\x63\x74\145\162\163\40\x73\x68\157\165\154\144\x20\142\x65\40\x70\x72\x65\x73\x65\x6e\164\x2e\40\117\156\x6c\171\40\x66\x6f\x6c\154\157\x77\x69\x6e\147\x20\x73\171\x6d\x62\x6f\x6c\x73\40\50\41\x40\x23\x2e\44\x25\x5e\x26\x2a\x2d\x5f\x29\40\163\150\157\165\x6c\x64\x20\142\145\x20\160\162\145\163\145\156\x74\x2e");
        $this->mo_saml_show_error_message();
        return;
        ng:
        goto Dw;
        PN:
        update_option("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x6d\145\x73\x73\x61\x67\145", "\x43\x68\x6f\157\163\145\40\x61\40\160\x61\x73\x73\x77\x6f\162\x64\40\x77\151\x74\x68\x20\155\151\156\151\155\x75\x6d\40\154\145\156\x67\164\150\x20\x36\56");
        $this->mo_saml_show_error_message();
        return;
        Dw:
        goto F_;
        rF:
        update_option("\155\x6f\137\x73\141\x6d\x6c\x5f\155\x65\x73\x73\141\x67\145", "\x41\x6c\154\40\164\150\145\x20\x66\x69\x65\154\144\x73\40\141\162\145\x20\x72\145\x71\165\151\x72\x65\144\56\x20\x50\x6c\x65\x61\x73\x65\x20\x65\156\x74\x65\162\40\166\x61\x6c\x69\x64\x20\145\x6e\x74\162\151\x65\x73\x2e");
        $this->mo_saml_show_error_message();
        return;
        F_:
        update_option("\155\157\x5f\x73\x61\x6d\x6c\137\x61\144\155\151\156\x5f\x65\x6d\x61\151\x6c", $oz);
        update_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\141\144\155\x69\156\137\160\x68\x6f\x6e\x65", $mz);
        if (strcmp($U1, $b2) == 0) {
            goto ZQ;
        }
        update_option("\x6d\157\137\x73\x61\x6d\x6c\137\x6d\x65\x73\163\x61\147\x65", "\120\141\163\x73\167\157\x72\x64\163\x20\144\157\40\156\x6f\x74\x20\155\x61\x74\x63\150\x2e");
        delete_option("\x6d\x6f\x5f\x73\141\x6d\154\137\x76\145\162\x69\146\171\137\143\x75\163\164\x6f\155\x65\x72");
        $this->mo_saml_show_error_message();
        goto VM;
        ZQ:
        update_option("\x6d\x6f\137\163\141\x6d\x6c\137\x61\x64\155\x69\x6e\x5f\x70\x61\163\163\x77\x6f\162\x64", $U1);
        $oz = get_option("\155\x6f\x5f\x73\141\x6d\x6c\137\141\144\155\151\156\137\145\x6d\x61\151\x6c");
        $V4 = new CustomerSaml();
        $t2 = $V4->check_customer();
        if ($t2) {
            goto kh;
        }
        return;
        kh:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\163\x74\141\x74\x75\x73"], "\x43\x55\123\x54\117\115\x45\x52\137\116\117\x54\x5f\106\x4f\125\116\104") == 0) {
            goto x1;
        }
        $this->get_current_customer();
        goto an;
        x1:
        $t2 = $V4->send_otp_token($oz, '');
        if ($t2) {
            goto GJ;
        }
        return;
        GJ:
        $t2 = json_decode($t2, true);
        if (strcasecmp($t2["\x73\x74\141\x74\x75\x73"], "\123\x55\103\103\x45\x53\x53") == 0) {
            goto BD;
        }
        update_option("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x6d\x65\x73\163\x61\x67\x65", "\x54\x68\x65\162\x65\40\x77\x61\x73\x20\x61\x6e\40\x65\x72\162\x6f\162\40\151\156\x20\163\145\x6e\x64\151\156\147\x20\145\x6d\141\x69\x6c\x2e\40\x50\x6c\145\141\163\145\40\x76\x65\162\x69\146\x79\40\x79\x6f\x75\162\40\x65\x6d\141\x69\154\x20\x61\156\144\40\164\162\171\x20\141\147\141\151\x6e\x2e");
        update_option("\x6d\x6f\x5f\163\x61\155\x6c\137\x72\145\147\151\163\x74\x72\141\164\151\x6f\x6e\x5f\x73\x74\141\164\x75\163", "\115\x4f\137\x4f\124\120\x5f\x44\x45\x4c\111\x56\x45\122\x45\104\137\x46\x41\x49\x4c\125\122\105\x5f\x45\115\101\x49\114");
        $this->mo_saml_show_error_message();
        goto yO;
        BD:
        update_option("\x6d\157\x5f\x73\x61\x6d\x6c\x5f\155\145\163\163\141\x67\x65", "\x20\x41\40\157\156\145\x20\164\x69\x6d\x65\40\x70\x61\x73\x73\143\x6f\x64\145\40\151\163\x20\x73\145\156\164\x20\164\157\x20" . get_option("\155\x6f\137\x73\x61\x6d\x6c\x5f\141\144\155\x69\156\x5f\145\155\x61\151\154") . "\56\40\120\154\145\141\163\145\40\145\x6e\x74\x65\x72\x20\x74\150\x65\x20\157\164\x70\x20\150\x65\x72\145\x20\x74\157\40\x76\x65\x72\151\x66\x79\40\171\x6f\x75\162\40\145\x6d\x61\151\154\x2e");
        update_option("\x6d\x6f\137\x73\141\155\154\137\x74\162\x61\156\163\x61\143\x74\151\x6f\156\111\x64", $t2["\x74\x78\111\144"]);
        update_option("\x6d\x6f\x5f\163\141\x6d\x6c\x5f\162\x65\x67\x69\x73\x74\162\x61\164\x69\157\156\x5f\x73\x74\x61\x74\165\x73", "\x4d\117\x5f\x4f\124\120\x5f\104\x45\114\x49\126\x45\x52\x45\x44\137\x53\125\x43\103\105\123\123\137\x45\115\x41\x49\114");
        $this->mo_saml_show_success_message();
        yO:
        an:
        VM:
        Q1:
        goto iR;
        wx:
        $TF = array("\x63\x6f\x75\x6e\164\162\171\116\x61\155\x65" => htmlspecialchars($_POST["\x63\157\165\156\164\x72\x79"]), "\x73\x74\x61\x74\x65\x4f\x72\120\x72\x6f\x76\x69\x6e\143\x65\116\141\155\145" => htmlspecialchars($_POST["\x73\x74\x61\x74\x65"]), "\x6c\x6f\x63\x61\154\x69\x74\x79\116\x61\x6d\145" => htmlspecialchars($_POST["\x6c\x6f\143\141\154\x69\x74\171"]), "\157\162\x67\141\156\151\172\141\x74\151\x6f\x6e\116\141\155\145" => htmlspecialchars($_POST["\x6f\x72\x67"]), "\157\x72\147\x61\156\151\172\x61\x74\x69\157\x6e\141\x6c\x55\156\x69\164\x4e\x61\x6d\x65" => htmlspecialchars($_POST["\157\x72\x67\x5f\165\156\x69\x74"]), "\143\157\x6d\x6d\157\156\x4e\x61\x6d\145" => htmlspecialchars($_POST["\x63\x6e"]), "\x65\x6d\141\x69\154\101\144\x64\162\x65\x73\163" => htmlspecialchars($_POST["\x65\x6d\141\151\154"]));
        $Kf = array("\x64\151\147\145\x73\164\x5f\x61\154\x67" => htmlspecialchars($_POST["\x68\141\x73\x68\137\x61\154\x67\x6f\162\x69\164\x68\155"]), "\x78\x35\60\x39\x5f\x65\170\x74\145\156\163\151\157\x6e\x73" => "\x76\x33\137\143\141", "\x70\162\x69\166\141\x74\145\x5f\153\x65\171\137\x62\151\164\x73" => 2048, "\x70\162\151\x76\141\x74\145\x5f\153\145\171\137\164\x79\x70\x65" => OPENSSL_KEYTYPE_RSA, "\145\156\x63\162\x79\x70\164\x5f\x6b\x65\171" => false);
        $DN = CertificateUtility::generate_certificate($TF, $Kf, (int) $_POST["\x65\170\160\x69\162\171\x5f\x64\141\x79\163"]);
        update_option("\155\x6f\x5f\163\x61\155\154\137\x63\x75\x72\x72\145\x6e\164\137\143\145\x72\x74", $DN["\160\165\x62\x6c\151\143\x5f\x6b\145\x79"]);
        $ig = $ig && update_option("\155\x6f\x5f\163\x61\155\x6c\x5f\143\165\x72\x72\145\156\164\x5f\x63\x65\162\x74\x5f\x70\162\151\x76\141\x74\145\137\153\145\x79", $DN["\160\x72\x69\x76\141\x74\x65\137\153\145\x79"]);
        if ($ig) {
            goto zw;
        }
        update_option("\x6d\x6f\137\x73\141\x6d\x6c\x5f\x6d\x65\163\163\x61\147\x65", "\x45\162\162\x6f\x72\40\157\x63\x63\x75\x72\x65\x64\x20\x77\x68\x69\154\145\x20\147\145\156\145\162\x61\164\x69\156\147\x20\x74\x68\145\40\143\x65\x72\164\x69\x66\x69\143\141\164\145\x73\56\x20\x53\145\145\40\120\x48\x50\40\145\x72\162\157\162\x20\154\x6f\147\163\x20\141\156\144\x20\x6d\x61\x6b\145\x20\x73\165\162\x65\40\x68\141\166\x65\x20\x73\145\x74\x20\167\x72\151\164\145\40\x70\x65\x72\x6d\x69\163\163\x69\157\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto CT;
        zw:
        update_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\x6d\x65\163\163\x61\147\x65", "\x4e\145\x77\x20\143\x65\x72\164\151\x66\151\143\141\x74\145\163\40\147\145\x6e\x65\x72\x61\164\x65\144\x20\163\165\143\x63\145\163\163\x66\165\154\154\171\x2e");
        $this->mo_saml_show_success_message();
        CT:
        iR:
        goto H0;
        iM:
        $QU = sanitize_text_field($_POST["\155\x6f\x5f\163\141\155\154\x5f\x63\165\x73\164\157\x6d\x5f\x6c\157\x67\x69\156\137\x74\145\170\164"]);
        update_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\x63\x75\x73\164\157\155\137\154\x6f\x67\151\x6e\137\164\x65\170\164", stripcslashes($QU));
        $oN = sanitize_text_field($_POST["\x6d\x6f\137\163\141\x6d\x6c\137\x63\165\x73\x74\x6f\155\x5f\x67\162\145\x65\164\151\x6e\147\137\x74\x65\x78\x74"]);
        update_option("\155\x6f\137\x73\141\155\154\137\143\x75\x73\164\157\x6d\x5f\x67\162\145\x65\164\151\x6e\147\137\x74\145\x78\164", stripcslashes($oN));
        $oh = sanitize_text_field($_POST["\x6d\157\137\x73\x61\x6d\x6c\x5f\147\x72\145\x65\x74\151\x6e\147\x5f\x6e\x61\155\145"]);
        update_option("\x6d\x6f\x5f\163\x61\155\154\137\147\162\145\x65\164\151\x6e\x67\x5f\x6e\141\155\145", stripslashes($oh));
        $eN = sanitize_text_field($_POST["\x6d\x6f\137\x73\x61\155\x6c\137\143\165\x73\x74\x6f\155\137\154\157\x67\157\x75\164\137\x74\x65\x78\164"]);
        update_option("\155\157\x5f\163\x61\x6d\154\x5f\143\x75\163\164\x6f\x6d\137\154\157\147\x6f\x75\164\x5f\164\145\170\x74", stripcslashes($eN));
        update_option("\x6d\157\x5f\x73\x61\x6d\154\x5f\x6d\x65\163\163\141\x67\145", "\127\151\x64\147\145\x74\x20\x53\145\164\164\x69\156\x67\163\x20\165\160\144\x61\x74\x65\144\40\163\165\143\143\x65\x73\163\x66\x75\154\x6c\x79\x2e");
        $this->mo_saml_show_success_message();
        H0:
        f6:
        if (mo_saml_is_trial_active()) {
            goto jh;
        }
        if (site_check()) {
            goto UT;
        }
        delete_option("\155\x6f\137\x73\141\155\154\x5f\x66\x6f\162\143\x65\x5f\141\x75\x74\x68\145\156\164\151\143\x61\x74\151\x6f\x6e");
        UT:
        goto Vm;
        jh:
        if (!decryptSamlElement()) {
            goto zE;
        }
        $Kn = get_option("\155\x6f\x5f\x73\141\x6d\x6c\137\x63\x75\163\164\x6f\155\x65\x72\137\x74\x6f\x6b\145\156");
        update_option("\x74\x5f\163\x69\x74\145\137\163\x74\x61\x74\165\x73", AESEncryption::encrypt_data("\146\x61\154\x73\145", $Kn));
        zE:
        Vm:
    }
    function djkasjdksa()
    {
        $SO = "\x21\x7e\x40\43\44\x25\x5e\46\52\50\x29\x5f\53\174\x7b\x7d\74\x3e\x3f\60\61\x32\63\x34\65\66\x37\x38\x39\141\142\143\x64\145\146\147\150\151\152\153\x6c\155\x6e\x6f\x70\x71\162\x73\x74\165\x76\167\170\x79\x7a\101\x42\x43\x44\105\x46\107\x48\x49\112\x4b\114\x4d\x4e\x4f\x50\121\x52\x53\124\125\126\x57\x58\131\x5a";
        $mX = strlen($SO);
        $wq = '';
        $W0 = 0;
        H7:
        if (!($W0 < 10000)) {
            goto Fd;
        }
        $wq .= $SO[rand(0, $mX - 1)];
        RR:
        $W0++;
        goto H7;
        Fd:
        return $wq;
    }
    function create_customer()
    {
        $V4 = new CustomerSaml();
        $t2 = $V4->create_customer();
        if ($t2) {
            goto dW;
        }
        return;
        dW:
        $CQ = json_decode($t2, true);
        if (strcasecmp($CQ["\x73\164\141\x74\165\x73"], "\103\125\x53\124\x4f\115\105\122\137\x55\x53\105\x52\116\x41\115\x45\x5f\x41\x4c\x52\x45\x41\x44\131\137\105\x58\x49\123\124\123") == 0) {
            goto hs;
        }
        if (!(strcasecmp($CQ["\163\x74\141\164\165\163"], "\x53\125\103\x43\x45\123\123") == 0)) {
            goto FY;
        }
        update_option("\x6d\157\137\163\x61\155\x6c\137\x61\x64\155\151\x6e\137\143\165\163\x74\157\155\x65\x72\x5f\153\145\x79", $CQ["\151\144"]);
        update_option("\x6d\x6f\x5f\x73\141\155\x6c\137\x61\144\155\151\x6e\x5f\x61\x70\x69\x5f\153\x65\x79", $CQ["\141\x70\x69\113\145\x79"]);
        update_option("\155\157\137\163\141\155\x6c\137\x63\165\163\x74\157\155\145\162\x5f\164\x6f\x6b\x65\x6e", $CQ["\x74\x6f\153\145\156"]);
        update_option("\155\157\x5f\x73\141\155\x6c\137\141\144\155\151\x6e\x5f\x70\141\x73\x73\167\x6f\162\144", '');
        update_option("\155\x6f\137\x73\141\155\154\137\155\x65\163\x73\x61\x67\x65", "\124\150\141\156\x6b\x20\171\x6f\x75\40\146\x6f\x72\x20\x72\145\x67\151\163\x74\x65\162\x69\x6e\x67\x20\167\x69\x74\x68\x20\x6d\x69\x6e\151\x6f\162\x61\x6e\147\x65\x2e");
        update_option("\x6d\157\137\x73\141\155\154\137\x72\x65\147\151\x73\x74\162\141\x74\x69\x6f\156\137\x73\164\x61\164\x75\163", '');
        delete_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\166\145\162\x69\146\171\137\143\x75\x73\164\157\x6d\x65\x72");
        delete_option("\155\x6f\x5f\x73\141\155\x6c\137\x6e\145\167\x5f\x72\x65\147\x69\x73\x74\162\x61\164\151\x6f\x6e");
        $this->mo_saml_show_success_message();
        FY:
        goto kj;
        hs:
        $this->get_current_customer();
        kj:
        update_option("\x6d\x6f\x5f\x73\141\155\154\137\141\x64\x6d\x69\156\137\x70\141\x73\163\x77\x6f\162\x64", '');
    }
    function get_current_customer()
    {
        $V4 = new CustomerSaml();
        $t2 = $V4->get_customer_key();
        if ($t2) {
            goto ce;
        }
        return;
        ce:
        $CQ = json_decode($t2, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto q_;
        }
        update_option("\x6d\157\137\x73\x61\x6d\x6c\137\x6d\x65\x73\163\x61\147\x65", "\x59\157\x75\40\141\x6c\x72\x65\141\144\x79\40\x68\141\x76\x65\40\x61\156\40\141\143\143\157\165\156\164\40\167\151\x74\150\40\x6d\x69\156\x69\117\x72\141\x6e\147\145\x2e\40\120\x6c\145\141\x73\145\40\145\x6e\x74\x65\162\40\x61\40\166\141\154\151\x64\40\160\x61\x73\x73\x77\x6f\162\144\56");
        update_option("\155\157\137\x73\141\x6d\x6c\x5f\166\145\162\151\146\171\x5f\143\165\163\164\x6f\x6d\145\162", "\x74\162\x75\145");
        delete_option("\x6d\x6f\x5f\163\x61\155\x6c\137\156\x65\167\x5f\x72\145\x67\151\x73\x74\x72\x61\x74\151\157\156");
        $this->mo_saml_show_error_message();
        goto up;
        q_:
        update_option("\x6d\157\x5f\x73\141\155\154\x5f\x61\144\x6d\x69\156\x5f\x63\x75\x73\164\x6f\x6d\145\162\x5f\153\x65\x79", $CQ["\151\144"]);
        update_option("\155\x6f\137\163\141\155\x6c\x5f\141\x64\x6d\x69\x6e\137\x61\x70\x69\x5f\x6b\x65\171", $CQ["\141\160\151\113\145\x79"]);
        update_option("\155\157\x5f\163\141\x6d\154\137\143\x75\x73\164\157\155\145\162\137\164\157\x6b\145\x6e", $CQ["\164\157\x6b\145\156"]);
        update_option("\155\x6f\x5f\x73\x61\x6d\154\137\141\144\155\151\x6e\x5f\x70\x61\x73\163\167\x6f\x72\144", '');
        update_option("\x6d\157\x5f\x73\x61\x6d\154\137\x6d\145\163\163\141\x67\x65", "\131\x6f\165\x72\40\x61\143\143\x6f\x75\156\164\x20\x68\x61\163\40\x62\x65\x65\156\40\162\145\164\162\x69\x65\166\145\x64\40\x73\165\x63\x63\145\x73\163\146\165\x6c\154\171\56");
        delete_option("\x6d\x6f\x5f\x73\x61\155\154\137\x76\x65\162\x69\x66\x79\137\143\165\163\164\157\155\x65\162");
        delete_option("\x6d\157\x5f\163\x61\155\x6c\x5f\156\145\x77\x5f\162\145\x67\x69\x73\164\x72\141\x74\x69\x6f\156");
        $this->mo_saml_show_success_message();
        up:
    }
    public function mo_saml_check_empty_or_null($Iy)
    {
        if (!(!isset($Iy) || empty($Iy))) {
            goto dl;
        }
        return true;
        dl:
        return false;
    }
    function miniorange_sso_menu()
    {
        $F5 = add_menu_page("\115\x4f\40\123\101\115\x4c\x20\123\x65\x74\x74\x69\156\147\163\40" . __("\x43\x6f\156\146\x69\147\x75\x72\145\40\123\101\x4d\114\x20\x49\144\145\x6e\x74\x69\x74\x79\40\x50\162\x6f\x76\151\x64\x65\x72\x20\146\157\x72\40\123\123\x4f", "\155\x6f\137\x73\141\x6d\x6c\137\x73\145\164\164\151\156\147\x73"), "\155\x69\x6e\151\x4f\x72\x61\x6e\x67\145\40\x53\x41\x4d\114\40\x32\x2e\x30\40\x53\x53\x4f", "\141\x64\x6d\151\156\151\163\164\162\x61\x74\x6f\x72", "\x6d\157\x5f\163\141\x6d\x6c\137\163\145\x74\x74\x69\156\147\163", array($this, "\155\x6f\x5f\x6c\x6f\x67\151\x6e\x5f\x77\151\144\x67\x65\x74\137\x73\x61\155\x6c\137\157\x70\164\x69\x6f\x6e\163"), plugin_dir_url(__FILE__) . "\151\155\x61\x67\x65\163\57\155\151\x6e\x69\x6f\162\x61\156\147\x65\56\160\156\x67");
    }
    function mo_saml_redirect_for_authentication($SW)
    {
        if (!mo_saml_is_customer_license_key_verified()) {
            goto W0;
        }
        if (get_option("\x6d\x6f\x5f\163\x61\x6d\154\x5f\162\x65\x67\151\163\x74\145\162\x65\144\137\157\156\154\x79\x5f\141\x63\x63\145\x73\x73") == "\164\162\165\145" || get_option("\x6d\157\137\x73\141\x6d\x6c\137\x65\156\141\x62\x6c\x65\137\154\157\x67\151\x6e\137\162\145\x64\x69\x72\145\143\164") == "\164\x72\165\x65") {
            goto ht;
        }
        if (!(get_option("\x6d\157\x5f\x73\x61\155\x6c\x5f\x72\145\x64\151\162\x65\x63\x74\137\164\157\137\167\160\137\154\x6f\x67\x69\156") == "\x74\x72\165\145")) {
            goto od;
        }
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto gi;
        }
        $AP = site_url() . "\57\167\x70\x2d\154\x6f\x67\x69\156\x2e\x70\150\160";
        if (empty($SW)) {
            goto ub;
        }
        $AP = $AP . "\77\162\x65\x64\151\162\145\143\x74\137\164\157\75" . urlencode($SW) . "\x26\162\x65\141\x75\164\x68\x3d\x31";
        ub:
        header("\x4c\157\143\x61\164\151\x6f\156\x3a\40" . $AP);
        die;
        gi:
        od:
        goto tV;
        ht:
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto Yf;
        }
        $We = get_option("\155\157\x5f\x73\x61\x6d\154\137\163\160\137\x62\x61\x73\145\137\x75\x72\x6c");
        if (!empty($We)) {
            goto Ej;
        }
        $We = home_url();
        Ej:
        if (!(get_option("\x6d\157\137\x73\x61\155\x6c\x5f\162\145\x6c\x61\x79\x5f\163\164\x61\x74\145") && get_option("\155\x6f\x5f\x73\141\x6d\x6c\137\162\145\x6c\x61\171\x5f\x73\164\141\164\145") != '')) {
            goto Hj;
        }
        $SW = get_option("\x6d\x6f\137\163\x61\x6d\x6c\137\x72\145\x6c\x61\171\137\x73\164\x61\164\145");
        Hj:
        $SW = parse_url($SW, PHP_URL_PATH);
        $ia = empty($SW) ? "\x2f" : $SW;
        $u8 = get_option("\163\x61\155\x6c\x5f\x6c\x6f\147\x69\156\137\165\x72\154");
        $EO = get_option("\163\141\155\154\137\x6c\157\147\x69\x6e\137\142\x69\156\x64\x69\156\x67\x5f\164\171\x70\x65");
        $C6 = get_option("\155\157\x5f\x73\141\x6d\x6c\x5f\x66\x6f\162\x63\145\137\x61\x75\x74\150\145\x6e\164\151\143\141\x74\151\x6f\x6e");
        $og = $We . "\57";
        $sM = get_option("\155\157\137\x73\141\155\154\137\x73\160\137\145\156\x74\151\164\x79\x5f\151\x64");
        $B5 = get_option("\x73\x61\155\x6c\137\x6e\141\x6d\x65\151\144\x5f\x66\x6f\x72\x6d\141\x74");
        if (!empty($sM)) {
            goto EE;
        }
        $sM = $We . "\x2f\167\x70\x2d\x63\x6f\x6e\x74\x65\x6e\x74\57\x70\x6c\165\x67\151\x6e\x73\57\155\151\156\151\157\x72\x61\x6e\147\x65\55\163\x61\x6d\154\55\62\x30\x2d\x73\151\156\x67\154\x65\x2d\163\x69\x67\156\55\x6f\x6e\57";
        EE:
        $hW = SAMLSPUtilities::createAuthnRequest($og, $sM, $u8, $C6, $EO, $B5);
        if (empty($EO) || $EO == "\110\x74\164\x70\122\145\x64\x69\x72\145\143\x74") {
            goto Mu;
        }
        if (!(get_option("\x73\141\x6d\x6c\137\162\x65\x71\x75\145\163\164\x5f\163\151\x67\x6e\x65\144") == "\165\156\143\x68\x65\143\153\x65\x64")) {
            goto YN;
        }
        $ur = base64_encode($hW);
        SAMLSPUtilities::postSAMLRequest($u8, $ur, $ia);
        die;
        YN:
        $CJ = '';
        $wh = '';
        $ur = SAMLSPUtilities::signXML($hW, "\116\141\155\145\x49\x44\120\157\x6c\x69\143\x79");
        SAMLSPUtilities::postSAMLRequest($u8, $ur, $ia);
        goto iL;
        Mu:
        $YN = $u8;
        if (strpos($u8, "\77") !== false) {
            goto mw;
        }
        $YN .= "\x3f";
        goto r1;
        mw:
        $YN .= "\x26";
        r1:
        if (!(get_option("\163\141\x6d\154\x5f\162\145\161\165\x65\163\x74\x5f\163\x69\147\x6e\x65\x64") == "\x75\x6e\143\x68\x65\x63\x6b\x65\x64")) {
            goto S9;
        }
        $YN .= "\x53\101\115\114\122\x65\161\165\145\163\164\75" . $hW . "\46\x52\145\x6c\x61\171\123\x74\x61\164\x65\75" . urlencode($ia);
        header("\x4c\157\x63\141\164\151\x6f\x6e\x3a\40" . $YN);
        die;
        S9:
        $hW = "\123\x41\x4d\114\122\x65\161\165\145\163\x74\75" . $hW . "\x26\x52\145\154\141\171\x53\x74\x61\164\x65\x3d" . urlencode($ia) . "\x26\x53\151\147\101\154\147\75" . urlencode(XMLSecurityKey::RSA_SHA256);
        $d_ = array("\x74\x79\x70\145" => "\x70\162\151\166\141\x74\145");
        $Kn = new XMLSecurityKey(XMLSecurityKey::RSA_SHA256, $d_);
        $r6 = get_option("\155\157\137\x73\x61\x6d\x6c\137\143\x75\162\162\145\156\x74\137\143\145\x72\x74\137\x70\x72\151\x76\141\164\x65\137\x6b\145\171");
        $Kn->loadKey($r6, FALSE);
        $XY = new XMLSecurityDSig();
        $Xy = $Kn->signData($hW);
        $Xy = base64_encode($Xy);
        $YN .= $hW . "\x26\x53\x69\147\x6e\141\x74\x75\162\145\x3d" . urlencode($Xy);
        header("\x4c\x6f\143\x61\164\151\157\156\72\40" . $YN);
        die;
        iL:
        Yf:
        tV:
        W0:
    }
    function mo_saml_authenticate()
    {
        $KP = '';
        if (!isset($_REQUEST["\x72\145\144\151\x72\145\143\x74\137\x74\157"])) {
            goto qN;
        }
        $KP = htmlspecialchars($_REQUEST["\x72\145\144\151\162\145\143\x74\137\164\x6f"]);
        qN:
        if (!is_user_logged_in()) {
            goto e9;
        }
        if (!empty($KP)) {
            goto W_;
        }
        header("\x4c\x6f\x63\141\164\151\157\x6e\72\x20" . home_url());
        goto Fx;
        W_:
        header("\x4c\157\x63\x61\164\151\157\156\x3a\40" . $KP);
        Fx:
        die;
        e9:
        if (!(get_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\145\156\141\142\x6c\145\x5f\x6c\x6f\x67\x69\156\137\162\x65\144\151\x72\x65\143\164") == "\x74\162\165\x65")) {
            goto ya;
        }
        $o1 = get_option("\155\x6f\137\163\141\x6d\154\x5f\x62\x61\x63\x6b\x64\x6f\x6f\x72\137\165\x72\154") ? trim(get_option("\x6d\x6f\137\163\141\155\154\137\x62\141\x63\153\144\x6f\x6f\x72\x5f\x75\162\x6c")) : "\146\141\x6c\163\x65";
        if (isset($_GET["\x6c\x6f\147\147\x65\144\x6f\165\164"]) && $_GET["\154\x6f\147\x67\x65\x64\x6f\165\x74"] == "\164\x72\165\145") {
            goto Vc;
        }
        if (get_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\x61\x6c\154\157\167\x5f\x77\x70\137\163\151\x67\156\x69\x6e") == "\164\x72\x75\x65") {
            goto JM;
        }
        goto Vo;
        Vc:
        header("\x4c\157\143\141\x74\151\157\156\72\40" . home_url());
        die;
        goto Vo;
        JM:
        if (isset($_GET["\163\x61\155\154\x5f\x73\163\x6f"]) && $_GET["\x73\141\x6d\x6c\x5f\x73\x73\157"] === $o1 || isset($_POST["\x73\x61\x6d\x6c\137\x73\163\x6f"]) && $_POST["\163\141\155\154\x5f\x73\163\157"] === $o1) {
            goto jd;
        }
        if (isset($_REQUEST["\162\x65\x64\151\x72\145\143\x74\137\164\157"])) {
            goto Pf;
        }
        goto Lj;
        jd:
        return;
        goto Lj;
        Pf:
        $KP = htmlspecialchars($_REQUEST["\x72\145\144\151\x72\145\143\164\x5f\164\x6f"]);
        if (!(strpos($KP, "\167\x70\55\141\144\x6d\x69\156") !== false && strpos($KP, "\163\141\x6d\154\137\x73\x73\157\75" . $o1) !== false)) {
            goto Fh;
        }
        return;
        Fh:
        Lj:
        Vo:
        $this->mo_saml_redirect_for_authentication($KP);
        ya:
    }
    function mo_saml_auto_redirect()
    {
        if (!current_user_can("\162\x65\x61\x64")) {
            goto TG;
        }
        return;
        TG:
        if (!(get_option("\x6d\x6f\137\163\x61\155\154\x5f\x72\x65\x67\x69\163\x74\145\162\145\144\x5f\157\156\154\x79\137\x61\x63\143\145\163\163") == "\x74\162\165\x65" || get_option("\155\x6f\137\x73\x61\x6d\154\x5f\x72\145\144\151\162\x65\143\164\x5f\164\x6f\x5f\167\x70\137\x6c\157\147\151\156") == "\x74\162\165\145")) {
            goto n1;
        }
        if (!(get_option("\x6d\x6f\x5f\x73\x61\155\x6c\137\145\156\141\x62\x6c\x65\x5f\162\x73\x73\137\x61\x63\143\x65\163\x73") == "\x74\162\165\x65" && is_feed())) {
            goto cD;
        }
        return;
        cD:
        $SW = saml_get_current_page_url();
        $this->mo_saml_redirect_for_authentication($SW);
        n1:
    }
    function mo_saml_modify_login_form()
    {
        $o1 = get_option("\x6d\157\137\163\141\x6d\154\137\142\141\x63\153\144\157\157\x72\x5f\x75\x72\154") ? trim(get_option("\155\x6f\x5f\163\x61\155\x6c\x5f\x62\141\x63\153\144\157\x6f\x72\137\x75\162\x6c")) : "\146\x61\x6c\163\145";
        echo "\x3c\x69\x6e\x70\x75\164\x20\x74\171\160\x65\75\42\150\x69\x64\x64\145\156\42\x20\156\x61\x6d\x65\x3d\x22\163\141\155\x6c\x5f\x73\163\x6f\42\40\166\141\154\165\145\x3d" . $o1 . "\x3e" . "\12";
        if (!(get_option("\x6d\157\137\x73\x61\x6d\154\x5f\141\144\x64\x5f\163\x73\157\137\142\x75\x74\x74\157\156\137\x77\160") == "\x74\x72\x75\145")) {
            goto G9;
        }
        $this->mo_saml_add_sso_button();
        G9:
    }
    function mo_saml_login_enqueue_scripts()
    {
        wp_enqueue_script("\x6a\161\165\145\x72\x79");
    }
    function mo_saml_add_sso_button()
    {
        if (is_user_logged_in()) {
            goto BY;
        }
        $We = get_option("\x6d\x6f\x5f\163\x61\x6d\154\x5f\x73\x70\137\142\141\x73\x65\137\165\x72\154");
        if (!empty($We)) {
            goto ak;
        }
        $We = home_url();
        ak:
        $F0 = get_option("\x6d\x6f\x5f\163\141\155\x6c\x5f\142\x75\164\x74\157\x6e\x5f\167\x69\144\x74\150") ? get_option("\x6d\157\137\x73\141\x6d\x6c\137\x62\x75\164\164\x6f\x6e\137\167\x69\144\164\x68") : "\x31\60\60";
        $sk = get_option("\x6d\x6f\x5f\x73\141\x6d\154\x5f\142\x75\x74\164\x6f\x6e\137\150\145\x69\x67\150\164") ? get_option("\155\157\137\x73\141\x6d\154\x5f\142\165\x74\x74\x6f\x6e\x5f\x68\x65\151\147\150\164") : "\x35\x30";
        $RT = get_option("\155\157\x5f\x73\x61\x6d\x6c\x5f\142\165\x74\x74\x6f\156\137\163\x69\172\x65") ? get_option("\155\157\137\x73\141\155\154\x5f\x62\165\164\164\x6f\156\x5f\163\x69\x7a\x65") : "\x35\60";
        $Si = get_option("\x6d\x6f\x5f\163\x61\x6d\154\137\142\x75\x74\x74\157\156\x5f\143\x75\162\x76\x65") ? get_option("\155\x6f\x5f\x73\141\155\x6c\x5f\x62\x75\164\164\x6f\x6e\x5f\143\x75\162\166\x65") : "\x35";
        $dm = get_option("\x6d\157\137\x73\141\x6d\x6c\137\x62\x75\164\164\x6f\156\137\x63\x6f\154\157\x72") ? get_option("\x6d\157\x5f\x73\141\x6d\154\x5f\142\165\x74\164\x6f\x6e\137\x63\157\x6c\x6f\162") : "\60\60\x38\x35\142\141";
        $xh = get_option("\x6d\157\137\x73\141\x6d\x6c\x5f\142\165\164\x74\x6f\x6e\x5f\x74\150\x65\x6d\x65") ? get_option("\155\157\x5f\163\x61\155\154\x5f\142\x75\164\164\x6f\x6e\x5f\x74\x68\x65\155\145") : "\154\157\x6e\147\x62\165\x74\x74\157\156";
        $Y1 = get_option("\155\157\x5f\x73\141\x6d\154\137\142\x75\164\164\x6f\156\137\x74\x65\170\x74") ? get_option("\155\157\137\x73\141\x6d\154\137\142\x75\x74\164\157\156\137\x74\x65\170\164") : (get_option("\163\141\155\x6c\x5f\x69\144\x65\156\x74\x69\x74\x79\x5f\156\141\x6d\145") ? get_option("\x73\141\155\x6c\x5f\x69\144\x65\156\164\151\x74\171\137\x6e\x61\155\x65") : "\114\x6f\x67\x69\x6e");
        $Ms = get_option("\x6d\x6f\137\163\141\x6d\154\x5f\146\x6f\x6e\164\x5f\143\x6f\154\157\162") ? get_option("\155\x6f\137\x73\141\x6d\154\137\x66\157\x6e\x74\137\143\x6f\154\x6f\162") : "\x66\146\146\x66\x66\x66";
        $t0 = get_option("\155\x6f\137\163\141\155\x6c\x5f\146\157\156\164\137\163\x69\x7a\145") ? get_option("\155\x6f\x5f\x73\141\x6d\x6c\x5f\146\x6f\x6e\x74\137\163\151\x7a\145") : "\62\60";
        $hx = get_option("\163\163\x6f\137\x62\x75\x74\164\x6f\x6e\137\x6c\x6f\x67\x69\156\137\x66\x6f\x72\155\137\160\157\x73\x69\164\x69\x6f\x6e") ? get_option("\x73\x73\x6f\137\142\x75\x74\164\157\156\137\x6c\x6f\147\x69\x6e\137\146\x6f\x72\155\x5f\160\x6f\163\151\x74\x69\157\x6e") : "\141\142\157\x76\145";
        $qC = "\74\x69\x6e\x70\165\x74\40\x74\x79\x70\x65\x3d\x22\142\165\x74\164\x6f\x6e\x22\x20\156\141\x6d\x65\x3d\x22\x6d\x6f\x5f\163\x61\155\x6c\137\167\160\137\163\163\157\x5f\x62\165\x74\164\x6f\156\x22\40\166\141\x6c\165\145\75\x22" . $Y1 . "\x22\x20\x73\x74\x79\154\145\x3d\42";
        $kA = '';
        if ($xh == "\154\x6f\x6e\147\142\x75\164\x74\157\156") {
            goto nL;
        }
        if ($xh == "\143\151\162\x63\154\x65") {
            goto BL;
        }
        if ($xh == "\157\166\x61\154") {
            goto C6;
        }
        if ($xh == "\x73\161\x75\x61\162\x65") {
            goto vj;
        }
        goto YT;
        BL:
        $kA = $kA . "\x77\x69\x64\164\150\72" . $RT . "\160\170\x3b";
        $kA = $kA . "\x68\145\x69\147\x68\164\72" . $RT . "\160\x78\x3b";
        $kA = $kA . "\142\x6f\162\144\x65\162\55\162\141\x64\x69\x75\x73\x3a\71\71\x39\160\170\73";
        goto YT;
        C6:
        $kA = $kA . "\x77\151\x64\164\150\x3a" . $RT . "\x70\x78\73";
        $kA = $kA . "\150\145\x69\x67\150\164\72" . $RT . "\160\x78\x3b";
        $kA = $kA . "\142\x6f\x72\x64\145\x72\x2d\162\141\144\x69\x75\x73\x3a\65\160\170\x3b";
        goto YT;
        vj:
        $kA = $kA . "\x77\151\x64\x74\150\x3a" . $RT . "\x70\170\73";
        $kA = $kA . "\150\145\x69\147\x68\164\x3a" . $RT . "\x70\x78\73";
        $kA = $kA . "\142\157\162\144\145\x72\x2d\162\141\144\151\165\163\72\60\x70\x78\x3b";
        $kA = $kA . "\160\x61\144\x64\x69\156\147\x3a\60\160\x78\x3b";
        YT:
        goto qJ;
        nL:
        $kA = $kA . "\167\x69\x64\164\x68\72" . $F0 . "\160\170\x3b";
        $kA = $kA . "\x68\x65\151\x67\x68\x74\72" . $sk . "\160\x78\x3b";
        $kA = $kA . "\x62\x6f\x72\x64\x65\162\55\x72\141\144\151\x75\x73\x3a" . $Si . "\x70\170\73";
        qJ:
        $kA = $kA . "\x62\x61\x63\x6b\x67\x72\x6f\165\x6e\144\55\x63\157\154\157\x72\x3a\43" . $dm . "\x3b";
        $kA = $kA . "\x62\157\162\x64\x65\162\55\x63\157\x6c\157\x72\72\164\162\141\156\x73\160\x61\x72\x65\156\164\73";
        $kA = $kA . "\x63\x6f\x6c\157\x72\72\43" . $Ms . "\x3b";
        $kA = $kA . "\x66\157\156\x74\55\163\x69\x7a\145\72" . $t0 . "\x70\x78\73";
        $kA = $kA . "\143\165\162\x73\x6f\x72\x3a\160\157\x69\x6e\164\x65\x72";
        $qC = $qC . $kA . "\42\57\x3e";
        $KP = '';
        if (!isset($_GET["\162\x65\144\151\x72\145\143\164\x5f\164\157"])) {
            goto Lw;
        }
        $KP = urlencode($_GET["\162\x65\144\x69\162\145\x63\x74\x5f\164\157"]);
        Lw:
        $TK = "\74\141\40\150\162\x65\146\x3d\x22" . $We . "\57\77\x6f\x70\164\151\x6f\156\75\163\x61\155\154\137\x75\163\145\x72\x5f\154\x6f\x67\151\x6e\x26\162\145\144\x69\x72\x65\143\x74\x5f\x74\157\75" . $KP . "\42\40\163\x74\x79\154\145\75\42\x74\145\170\164\55\144\x65\x63\x6f\162\x61\164\151\157\x6e\72\x6e\x6f\156\x65\73\42\x3e" . $qC . "\74\57\141\76";
        $TK = "\74\x64\151\166\x20\163\x74\x79\x6c\x65\x3d\42\x70\x61\144\144\x69\x6e\x67\72\61\x30\x70\x78\73\x22\x3e" . $TK . "\74\57\144\151\x76\76";
        if ($hx == "\x61\x62\157\x76\x65") {
            goto kx;
        }
        $TK = "\x3c\144\151\166\40\x69\144\75\42\x73\x73\157\x5f\x62\165\x74\x74\157\156\x22\x20\163\x74\x79\x6c\x65\x3d\42\x74\x65\170\164\55\x61\154\151\x67\156\x3a\143\x65\156\164\x65\162\42\76\74\144\151\166\x20\x73\x74\x79\154\145\x3d\x22\x70\x61\144\144\151\x6e\x67\72\x35\x70\x78\x3b\146\x6f\156\x74\55\163\x69\x7a\x65\x3a\x31\x34\160\x78\73\42\x3e\74\142\x3e\117\x52\74\x2f\142\76\74\57\144\151\166\76" . $TK . "\x3c\x2f\144\151\166\76\74\x62\x72\x2f\76";
        goto OO;
        kx:
        $TK = "\74\144\151\166\40\x69\144\75\42\x73\x73\x6f\137\x62\165\164\164\157\156\x22\x20\163\164\x79\154\x65\x3d\x22\x74\145\x78\x74\55\141\x6c\151\x67\x6e\72\143\x65\156\x74\x65\162\42\x3e" . $TK . "\x3c\x64\x69\166\x20\x73\x74\x79\154\x65\x3d\42\x70\141\x64\144\151\x6e\x67\72\x35\160\x78\x3b\146\157\x6e\164\x2d\x73\x69\172\145\72\61\64\x70\170\73\42\x3e\x3c\x62\76\117\x52\74\57\142\76\x3c\x2f\144\151\166\76\x3c\57\144\x69\x76\76\x3c\142\162\x2f\x3e";
        $TK = $TK . "\74\163\x63\x72\151\160\164\76\xa\x9\11\x9\x76\141\162\x20\x24\145\x6c\x65\155\145\156\164\40\x3d\40\x6a\121\x75\x65\x72\171\50\x22\43\165\163\145\162\137\154\157\x67\x69\x6e\42\51\x3b\xa\x9\11\11\152\121\165\x65\162\171\x28\x22\x23\163\163\157\x5f\142\165\x74\164\x6f\x6e\42\x29\56\x69\156\x73\145\x72\164\x42\x65\146\157\162\x65\x28\x6a\121\165\x65\x72\171\50\42\154\141\142\x65\x6c\133\x66\157\x72\75\47\42\53\x24\145\154\x65\155\x65\x6e\x74\56\x61\164\x74\x72\x28\47\x69\x64\47\x29\53\42\47\135\42\51\x29\x3b\xa\x9\11\11\74\57\x73\143\x72\151\x70\x74\x3e";
        OO:
        echo $TK;
        BY:
    }
    function mo_get_saml_shortcode()
    {
        if (!is_user_logged_in()) {
            goto iH;
        }
        $current_user = wp_get_current_user();
        $oN = "\110\x65\154\x6c\x6f\x2c";
        if (!get_option("\x6d\157\137\163\x61\155\154\137\143\165\163\164\157\155\x5f\x67\x72\145\x65\x74\151\x6e\x67\x5f\164\145\170\x74")) {
            goto ug;
        }
        $oN = get_option("\x6d\x6f\x5f\163\141\x6d\154\x5f\143\x75\x73\164\x6f\155\137\147\162\x65\x65\164\x69\156\x67\137\164\145\x78\164");
        ug:
        $oh = '';
        if (!get_option("\x6d\157\x5f\x73\141\x6d\x6c\137\147\x72\x65\x65\x74\151\156\x67\x5f\156\x61\x6d\x65")) {
            goto EW;
        }
        switch (get_option("\x6d\157\137\x73\x61\155\154\137\147\x72\145\145\164\151\x6e\147\137\156\x61\155\x65")) {
            case "\x55\x53\x45\122\116\101\x4d\x45":
                $oh = $current_user->user_login;
                goto y4;
            case "\x45\115\x41\111\114":
                $oh = $current_user->user_email;
                goto y4;
            case "\x46\x4e\101\x4d\x45":
                $oh = $current_user->user_firstname;
                goto y4;
            case "\114\x4e\x41\115\105":
                $oh = $current_user->user_lastname;
                goto y4;
            case "\106\116\x41\x4d\x45\x5f\x4c\116\101\x4d\x45":
                $oh = $current_user->user_firstname . "\40" . $current_user->user_lastname;
                goto y4;
            case "\x4c\x4e\101\x4d\x45\x5f\106\x4e\x41\x4d\x45":
                $oh = $current_user->user_lastname . "\40" . $current_user->user_firstname;
                goto y4;
            default:
                $oh = $current_user->user_login;
        }
        Eg:
        y4:
        EW:
        $oh = trim($oh);
        if (!empty($oh)) {
            goto VH;
        }
        $oh = $current_user->user_login;
        VH:
        $Ux = $oN . "\40" . $oh;
        $on = "\114\x6f\147\x6f\165\164";
        if (!get_option("\x6d\157\137\x73\x61\155\154\x5f\143\x75\163\164\x6f\155\x5f\x6c\157\147\x6f\165\x74\x5f\x74\x65\x78\x74")) {
            goto Nn;
        }
        $on = get_option("\x6d\157\137\163\141\155\154\137\x63\165\163\x74\157\155\x5f\154\157\147\157\x75\x74\137\x74\145\x78\164");
        Nn:
        $TK = $Ux . "\x20\174\40\x3c\141\x20\150\x72\145\x66\75\42" . wp_logout_url(home_url()) . "\42\40\164\x69\x74\154\145\x3d\x22\x6c\x6f\x67\157\165\x74\42\40\x3e" . $on . "\74\x2f\x61\x3e\x3c\57\154\151\x3e";
        goto b4;
        iH:
        $We = get_option("\155\157\137\x73\141\x6d\154\137\163\x70\137\142\x61\x73\145\137\x75\162\154");
        if (!empty($We)) {
            goto f2;
        }
        $We = home_url();
        f2:
        if (mo_saml_is_sp_configured() && mo_saml_is_customer_license_key_verified()) {
            goto fJ;
        }
        $TK = "\x53\x50\x20\x69\x73\40\x6e\157\164\x20\143\157\156\146\151\x67\165\x72\145\144\56";
        goto NB;
        fJ:
        $CM = "\114\x6f\147\151\156\x20\x77\151\164\x68\x20" . get_option("\163\141\x6d\x6c\x5f\x69\144\145\156\x74\x69\164\x79\x5f\156\141\155\145");
        if (!get_option("\155\x6f\x5f\163\x61\x6d\154\137\x63\x75\x73\164\x6f\155\137\154\157\x67\151\156\137\x74\x65\x78\x74")) {
            goto FG;
        }
        $CM = get_option("\155\x6f\x5f\163\x61\x6d\154\137\x63\x75\x73\x74\x6f\x6d\x5f\x6c\x6f\x67\x69\x6e\x5f\x74\x65\170\164");
        FG:
        $qb = get_option("\163\x61\155\x6c\x5f\151\144\145\x6e\x74\151\x74\x79\137\x6e\x61\x6d\145");
        $CM = str_replace("\43\x23\x49\104\120\x23\x23", $qb, $CM);
        $E1 = false;
        if (!get_option("\x6d\x6f\137\163\141\x6d\154\x5f\x75\163\x65\137\x62\x75\x74\x74\157\156\x5f\x61\x73\x5f\x73\x68\x6f\x72\164\x63\x6f\x64\x65")) {
            goto dv;
        }
        if (!(get_option("\x6d\157\x5f\163\141\x6d\154\137\x75\163\145\137\x62\165\164\x74\x6f\156\x5f\x61\x73\x5f\163\150\x6f\x72\x74\143\157\144\x65") == "\164\162\x75\145")) {
            goto gS;
        }
        $E1 = true;
        gS:
        dv:
        if (!$E1) {
            goto Ah;
        }
        $F0 = get_option("\155\x6f\x5f\163\x61\x6d\154\137\142\165\164\164\157\156\x5f\x77\151\x64\164\x68") ? get_option("\x6d\x6f\137\163\x61\x6d\x6c\x5f\142\x75\x74\x74\157\156\x5f\x77\151\x64\x74\x68") : "\x31\60\60";
        $sk = get_option("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x62\x75\164\x74\157\x6e\x5f\150\x65\151\147\150\x74") ? get_option("\x6d\157\137\163\141\x6d\x6c\137\x62\x75\164\164\157\156\x5f\150\145\151\147\150\164") : "\x35\60";
        $RT = get_option("\155\x6f\137\163\141\155\x6c\137\142\x75\x74\164\x6f\156\137\x73\151\x7a\x65") ? get_option("\155\157\x5f\x73\x61\155\154\137\x62\x75\164\x74\157\x6e\x5f\x73\151\172\x65") : "\65\60";
        $Si = get_option("\155\157\137\x73\x61\x6d\x6c\x5f\142\165\x74\164\157\x6e\x5f\x63\165\162\x76\145") ? get_option("\x6d\x6f\137\163\x61\155\154\x5f\142\165\164\164\x6f\x6e\x5f\x63\x75\162\166\145") : "\65";
        $dm = get_option("\x6d\x6f\137\x73\x61\155\x6c\x5f\142\165\164\x74\x6f\156\x5f\x63\x6f\154\157\x72") ? get_option("\x6d\157\137\x73\x61\155\x6c\137\142\x75\x74\x74\157\x6e\x5f\x63\157\154\x6f\x72") : "\60\60\70\65\142\141";
        $xh = get_option("\x6d\157\x5f\163\x61\155\154\137\142\165\x74\x74\157\156\x5f\164\150\x65\155\x65") ? get_option("\155\157\137\163\x61\155\x6c\x5f\142\x75\164\164\x6f\x6e\x5f\164\x68\145\155\x65") : "\x6c\157\x6e\x67\142\x75\164\164\157\156";
        $Y1 = get_option("\155\x6f\137\x73\141\x6d\x6c\137\x62\165\x74\164\x6f\x6e\x5f\164\x65\170\164") ? get_option("\155\157\x5f\x73\x61\155\x6c\137\142\x75\x74\x74\x6f\x6e\137\x74\145\170\x74") : (get_option("\163\141\x6d\154\137\x69\144\145\x6e\164\x69\x74\171\x5f\x6e\x61\x6d\x65") ? get_option("\163\x61\155\154\x5f\151\144\x65\156\x74\x69\164\x79\x5f\x6e\x61\155\145") : "\x4c\157\147\x69\156");
        $Ms = get_option("\155\157\x5f\163\141\155\154\137\146\x6f\156\164\x5f\143\x6f\x6c\157\x72") ? get_option("\x6d\157\x5f\x73\141\155\x6c\x5f\146\x6f\x6e\x74\x5f\143\x6f\154\157\x72") : "\146\146\x66\146\146\x66";
        $t0 = get_option("\155\157\x5f\x73\141\155\x6c\x5f\x66\x6f\x6e\x74\x5f\x73\151\x7a\145") ? get_option("\x6d\157\137\163\141\x6d\154\x5f\146\x6f\x6e\x74\137\x73\151\x7a\x65") : "\x32\x30";
        $CM = "\x3c\151\156\160\x75\x74\x20\164\171\x70\x65\x3d\42\x62\x75\164\x74\x6f\156\42\x20\x6e\141\155\x65\75\x22\x6d\x6f\x5f\x73\x61\155\154\137\x77\160\137\x73\163\157\x5f\142\165\164\x74\x6f\x6e\x22\x20\x76\141\x6c\x75\145\x3d\42" . $Y1 . "\x22\40\163\x74\x79\154\145\75\x22";
        $kA = '';
        if ($xh == "\154\x6f\156\147\142\x75\x74\164\x6f\156") {
            goto DM;
        }
        if ($xh == "\x63\x69\x72\143\x6c\x65") {
            goto BM;
        }
        if ($xh == "\x6f\166\x61\x6c") {
            goto Uk;
        }
        if ($xh == "\163\161\165\141\x72\145") {
            goto Xs;
        }
        goto Vq;
        BM:
        $kA = $kA . "\167\151\x64\164\150\72" . $RT . "\160\x78\x3b";
        $kA = $kA . "\150\x65\151\147\x68\164\x3a" . $RT . "\x70\x78\73";
        $kA = $kA . "\x62\x6f\x72\x64\145\162\55\162\141\144\151\165\x73\72\71\71\x39\160\x78\x3b";
        goto Vq;
        Uk:
        $kA = $kA . "\167\151\x64\164\x68\x3a" . $RT . "\x70\x78\x3b";
        $kA = $kA . "\150\145\x69\x67\x68\x74\x3a" . $RT . "\x70\x78\73";
        $kA = $kA . "\142\x6f\x72\144\x65\x72\55\x72\x61\144\151\165\163\72\65\160\x78\x3b";
        goto Vq;
        Xs:
        $kA = $kA . "\x77\151\144\x74\x68\72" . $RT . "\x70\x78\73";
        $kA = $kA . "\150\x65\151\x67\150\164\x3a" . $RT . "\160\x78\73";
        $kA = $kA . "\x62\157\x72\x64\x65\162\x2d\162\141\x64\151\x75\x73\72\60\160\x78\x3b";
        Vq:
        goto Ja;
        DM:
        $kA = $kA . "\x77\x69\144\x74\150\72" . $F0 . "\160\x78\73";
        $kA = $kA . "\x68\x65\151\x67\150\164\72" . $sk . "\x70\170\73";
        $kA = $kA . "\x62\157\162\144\x65\162\x2d\162\141\x64\151\x75\163\72" . $Si . "\160\170\73";
        Ja:
        $kA = $kA . "\x62\141\143\153\147\162\x6f\165\156\144\x2d\143\157\154\x6f\x72\x3a\43" . $dm . "\x3b";
        $kA = $kA . "\x62\x6f\162\144\x65\x72\x2d\x63\157\x6c\x6f\162\x3a\x74\x72\141\156\163\x70\x61\x72\145\x6e\164\73";
        $kA = $kA . "\x63\157\x6c\157\162\72\43" . $Ms . "\73";
        $kA = $kA . "\146\x6f\156\164\55\x73\151\x7a\x65\72" . $t0 . "\160\x78\73";
        $kA = $kA . "\x70\141\144\144\x69\156\147\72\60\160\170\73";
        $CM = $CM . $kA . "\42\x2f\76";
        Ah:
        $KP = urlencode(saml_get_current_page_url());
        $TK = "\x3c\x61\40\150\162\145\146\x3d\42" . $We . "\x2f\77\x6f\160\164\151\157\156\75\x73\x61\x6d\x6c\x5f\x75\x73\x65\162\137\x6c\x6f\147\151\x6e\46\x72\145\144\151\162\x65\143\x74\x5f\164\x6f\x3d" . $KP . "\x22";
        if (!$E1) {
            goto cK;
        }
        $TK = $TK . "\x73\164\171\x6c\145\75\42\x74\x65\x78\x74\x2d\144\145\x63\x6f\162\141\x74\x69\157\156\72\x6e\x6f\156\145\x3b\x22";
        cK:
        $TK = $TK . "\76" . $CM . "\x3c\x2f\141\76";
        NB:
        b4:
        return $TK;
    }
    function _handle_upload_metadata()
    {
        if (!(isset($_FILES["\155\x65\x74\x61\144\141\x74\x61\x5f\146\151\154\x65"]) || isset($_POST["\x6d\145\164\141\x64\141\x74\x61\x5f\x75\x72\154"]))) {
            goto IU;
        }
        if (!empty($_FILES["\155\145\x74\x61\144\x61\164\x61\x5f\x66\151\x6c\145"]["\x74\x6d\x70\137\x6e\x61\155\145"])) {
            goto yA;
        }
        if (mo_saml_is_extension_installed("\x63\x75\x72\x6c")) {
            goto vY;
        }
        update_option("\155\x6f\x5f\163\x61\x6d\154\x5f\x6d\145\163\163\x61\x67\x65", "\120\110\x50\x20\143\x55\x52\114\40\145\170\x74\145\156\x73\x69\x6f\x6e\x20\151\x73\40\156\157\164\x20\x69\156\x73\164\141\x6c\x6c\x65\144\x20\x6f\x72\40\144\151\163\x61\x62\x6c\x65\x64\x2e\x20\x43\141\x6e\x6e\157\164\40\x66\x65\x74\143\150\x20\x6d\145\x74\x61\144\x61\x74\141\40\146\x72\157\155\40\x55\x52\x4c\x2e");
        $this->mo_saml_show_error_message();
        return;
        vY:
        $AP = filter_var(htmlspecialchars($_POST["\x6d\x65\x74\141\x64\141\164\141\x5f\x75\x72\x6c"]), FILTER_SANITIZE_URL);
        $hG = SAMLSPUtilities::mo_saml_wp_remote_call($AP, array("\x73\163\x6c\166\145\162\x69\146\171" => false), true);
        if (!is_null($hG)) {
            goto KT;
        }
        $Mp = null;
        goto mR;
        KT:
        $Mp = $hG;
        mR:
        if (isset($_POST["\x73\171\156\x63\137\155\145\164\141\144\x61\x74\x61"])) {
            goto JR;
        }
        delete_option("\163\141\x6d\154\x5f\x6d\145\x74\x61\x64\141\164\141\x5f\x75\162\x6c\x5f\x66\x6f\x72\x5f\163\x79\156\x63");
        delete_option("\163\x61\x6d\154\x5f\x6d\145\x74\141\144\141\164\x61\x5f\x73\171\156\x63\137\x69\156\164\x65\162\166\141\154");
        wp_unschedule_event(wp_next_scheduled("\155\145\x74\x61\144\141\164\141\x5f\x73\x79\x6e\143\x5f\x63\162\x6f\156\137\x61\x63\x74\151\x6f\156"), "\155\x65\x74\x61\144\x61\164\x61\137\163\x79\156\x63\137\x63\162\157\x6e\x5f\x61\143\164\x69\x6f\156");
        goto qE;
        JR:
        update_option("\163\x61\x6d\x6c\137\x6d\145\x74\x61\x64\141\x74\x61\x5f\165\x72\x6c\137\146\157\162\x5f\x73\x79\156\x63", htmlspecialchars($_POST["\155\x65\x74\141\x64\141\164\141\137\x75\162\x6c"]));
        update_option("\x73\141\155\x6c\x5f\155\145\164\141\144\141\x74\x61\x5f\163\x79\x6e\143\137\x69\156\164\145\162\x76\141\x6c", htmlspecialchars($_POST["\163\x79\156\x63\137\x69\x6e\x74\145\162\166\141\154"]));
        if (wp_next_scheduled("\x6d\145\x74\x61\x64\x61\x74\x61\x5f\163\171\x6e\x63\137\143\162\x6f\156\x5f\x61\x63\x74\x69\x6f\x6e")) {
            goto Dp;
        }
        wp_schedule_event(time(), htmlspecialchars($_POST["\163\x79\x6e\143\137\151\156\x74\145\x72\x76\x61\154"]), "\155\145\x74\141\144\141\x74\141\137\163\171\x6e\x63\x5f\143\162\157\156\137\141\x63\x74\x69\x6f\156");
        Dp:
        qE:
        goto WG;
        yA:
        $Mp = @file_get_contents($_FILES["\x6d\x65\164\x61\x64\141\x74\141\x5f\146\x69\x6c\x65"]["\x74\155\x70\137\x6e\141\x6d\x65"]);
        WG:
        $this->upload_metadata($Mp);
        IU:
    }
    function upload_metadata($Mp)
    {
        $bc = set_error_handler(array($this, "\x68\141\x6e\144\x6c\145\130\x6d\x6c\x45\162\x72\x6f\x72"));
        $vq = new DOMDocument();
        $vq->loadXML($Mp);
        restore_error_handler();
        $kD = $vq->firstChild;
        if (!empty($kD)) {
            goto nY;
        }
        if (!empty($_FILES["\155\x65\x74\x61\144\x61\164\x61\137\x66\151\154\145"]["\x74\x6d\160\137\156\141\x6d\145"])) {
            goto Rn;
        }
        if (!empty($_POST["\x6d\x65\164\x61\144\x61\x74\141\137\x75\x72\154"])) {
            goto E9;
        }
        update_option("\x6d\157\137\163\x61\x6d\x6c\137\155\x65\163\x73\141\x67\x65", "\120\154\145\x61\x73\145\40\160\162\x6f\x76\x69\144\145\x20\x61\40\x76\x61\154\151\x64\x20\155\x65\164\141\x64\141\164\141\x20\146\x69\x6c\145\40\157\x72\40\141\40\166\141\x6c\x69\x64\x20\x55\122\114\x2e");
        $this->mo_saml_show_error_message();
        return;
        goto IE;
        E9:
        update_option("\x6d\157\137\163\x61\155\154\x5f\x6d\x65\163\x73\x61\x67\145", "\x50\x6c\x65\141\x73\145\40\160\162\157\166\x69\x64\145\40\141\x20\x76\141\x6c\151\x64\x20\x6d\145\x74\141\x64\141\164\x61\40\x55\x52\114\x2e");
        $this->mo_saml_show_error_message();
        IE:
        goto sw;
        Rn:
        update_option("\155\157\137\163\x61\x6d\x6c\137\x6d\145\163\x73\x61\147\145", "\x50\154\145\x61\163\x65\40\x70\162\x6f\166\151\x64\x65\x20\141\40\166\x61\x6c\x69\144\x20\x6d\145\164\141\144\x61\x74\x61\x20\146\151\x6c\145\x2e");
        $this->mo_saml_show_error_message();
        sw:
        goto KJ;
        nY:
        $cf = new IDPMetadataReader($vq);
        $YT = $cf->getIdentityProviders();
        if (!empty($YT)) {
            goto JS;
        }
        update_option("\x6d\x6f\137\x73\141\x6d\x6c\137\x6d\x65\163\x73\x61\147\x65", "\120\154\145\141\163\x65\x20\160\162\x6f\166\x69\144\145\x20\x61\40\x76\141\x6c\x69\x64\x20\155\x65\x74\141\x64\x61\164\141\40\x66\151\x6c\x65\56");
        $this->mo_saml_show_error_message();
        return;
        JS:
        foreach ($YT as $Kn => $G4) {
            $qi = get_option("\163\x61\155\154\137\x69\144\145\156\164\151\164\171\x5f\x6e\x61\155\x65");
            if (!isset($_POST["\x73\141\x6d\x6c\x5f\151\x64\145\x6e\x74\x69\164\x79\x5f\155\145\x74\141\x64\x61\164\141\137\x70\x72\x6f\x76\x69\144\x65\162"])) {
                goto uI;
            }
            $qi = htmlspecialchars($_POST["\x73\141\155\154\x5f\151\144\145\x6e\x74\x69\x74\171\137\155\x65\164\141\x64\141\164\x61\137\160\x72\157\166\151\144\145\162"]);
            uI:
            $pI = "\x48\164\x74\x70\x52\x65\144\151\162\145\x63\164";
            $qM = '';
            if (array_key_exists("\110\x54\124\120\x2d\x52\145\x64\x69\x72\x65\143\x74", $G4->getLoginDetails())) {
                goto UP;
            }
            if (!array_key_exists("\x48\124\x54\x50\55\120\117\x53\x54", $G4->getLoginDetails())) {
                goto eo;
            }
            $pI = "\x48\x74\x74\160\x50\x6f\x73\x74";
            $qM = $G4->getLoginURL("\110\124\x54\120\55\120\x4f\123\x54");
            eo:
            goto yc;
            UP:
            $qM = $G4->getLoginURL("\110\124\x54\x50\55\122\x65\x64\x69\x72\x65\143\164");
            yc:
            $m9 = "\x48\164\164\x70\122\145\x64\x69\162\145\x63\164";
            $Vc = '';
            if (array_key_exists("\x48\124\124\x50\x2d\122\145\144\151\162\145\143\164", $G4->getLogoutDetails())) {
                goto g4;
            }
            if (!array_key_exists("\x48\124\x54\120\55\120\117\x53\x54", $G4->getLogoutDetails())) {
                goto EP;
            }
            $m9 = "\110\164\x74\x70\x50\157\x73\x74";
            $Vc = $G4->getLogoutURL("\110\x54\124\x50\x2d\x50\117\x53\124");
            EP:
            goto qa;
            g4:
            $Vc = $G4->getLogoutURL("\110\124\x54\120\55\122\x65\144\151\162\x65\143\164");
            qa:
            $GV = $G4->getEntityID();
            $wY = $G4->getSigningCertificate();
            update_option("\163\141\155\154\x5f\151\x64\145\156\164\151\164\x79\137\x6e\x61\x6d\x65", $qi);
            update_option("\163\x61\155\154\137\x6c\157\x67\151\x6e\x5f\x62\x69\156\144\151\x6e\x67\137\x74\171\160\x65", $pI);
            update_option("\x73\141\155\x6c\137\x6c\x6f\147\x69\156\x5f\165\x72\154", $qM);
            update_option("\x73\x61\x6d\154\137\x6c\x6f\147\x6f\x75\164\137\142\151\156\x64\151\x6e\147\x5f\164\171\x70\x65", $m9);
            update_option("\163\141\x6d\x6c\137\154\157\147\x6f\165\x74\137\165\162\x6c", $Vc);
            update_option("\163\x61\155\x6c\x5f\151\163\163\165\145\x72", $GV);
            update_option("\163\141\155\154\x5f\x6e\x61\155\x65\x69\x64\x5f\146\157\x72\x6d\141\164", "\61\56\61\72\156\141\x6d\145\x69\144\55\146\157\x72\x6d\x61\164\72\165\156\x73\160\145\x63\151\146\x69\145\144");
            update_option("\x73\x61\x6d\154\137\170\65\60\71\x5f\x63\x65\x72\x74\151\146\x69\x63\141\164\145", maybe_serialize($wY));
            goto qq;
            oR1:
        }
        qq:
        update_option("\x6d\157\137\163\141\x6d\154\137\x6d\x65\163\163\141\147\145", "\111\x64\145\x6e\164\x69\164\x79\x20\x50\162\157\166\x69\x64\145\x72\x20\144\145\164\x61\151\154\x73\40\163\x61\166\x65\144\x20\x73\x75\143\x63\145\163\x73\146\x75\154\154\171\x2e");
        $this->mo_saml_show_success_message();
        KJ:
    }
    function handleXmlError($yk, $zH, $uR, $z0)
    {
        if ($yk == E_WARNING && substr_count($zH, "\104\117\115\x44\157\143\x75\x6d\145\156\164\x3a\x3a\x6c\x6f\x61\x64\130\115\x4c\x28\x29") > 0) {
            goto xN;
        }
        return false;
        goto Yb;
        xN:
        return;
        Yb:
    }
    function mo_saml_plugin_action_links($OB)
    {
        $OB = array_merge(array("\x3c\141\40\x68\162\145\x66\x3d\x22" . esc_url(admin_url("\141\144\x6d\x69\156\x2e\x70\150\x70\77\160\x61\x67\145\x3d\x6d\157\x5f\163\x61\x6d\154\137\x73\145\164\x74\x69\x6e\x67\163")) . "\42\76" . __("\x53\x65\164\164\151\x6e\147\163", "\x74\x65\170\164\x64\157\155\141\151\156") . "\x3c\x2f\141\76"), $OB);
        return $OB;
    }
    function checkPasswordPattern($U1)
    {
        $I0 = "\57\136\x5b\x28\x5c\167\51\x2a\50\134\x21\x5c\100\134\43\134\44\x5c\45\x5c\x5e\x5c\x26\x5c\x2a\134\x2e\134\55\134\x5f\x29\x2a\x5d\53\44\x2f";
        return !preg_match($I0, $U1);
    }
}
new saml_mo_login();
